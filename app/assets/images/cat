<!DOCTYPE html>
<html lang='ja' xml:lang='ja' xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Ruby on Rails チュートリアル：実例を使って Rails を学ぼう</title>
    <meta name="apple-mobile-web-app-title" content="Rails Tutorial" />
    <meta name="application-name"           content="Rails Tutorial" />

    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"344f7aca68","applicationID":"3870367","transactionName":"dQxXQBFaDwpTF0sAW1cTTVERRkwVXgoT","queueTime":14,"applicationTime":196,"agent":""}</script>
<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var o=t[n]={exports:{}};e[n][0].call(o.exports,function(t){var o=e[n][1][t];return r(o||t)},o,o.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){function r(){}function o(e,t,n){return function(){return i(e,[f.now()].concat(u(arguments)),t?null:this,n),t?void 0:this}}var i=e("handle"),a=e(2),u=e(3),c=e("ee").get("tracer"),f=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,t){s[t]=o(d+t,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),t.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,t){var n={},r=this,o="function"==typeof t;return i(l+"tracer",[f.now(),e,n],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],n),o)try{return t.apply(this,arguments)}catch(e){throw c.emit("fn-err",[arguments,this,e],n),e}finally{c.emit("fn-end",[f.now()],n)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,t){m[t]=o(l+t)}),newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),i("err",[e,f.now()])}},{}],2:[function(e,t,n){function r(e,t){var n=[],r="",i=0;for(r in e)o.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],3:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(o<0?0:o);++r<o;)i[r]=e[t+r];return i}t.exports=r},{}],4:[function(e,t,n){t.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,t,n){function r(){}function o(e){function t(e){return e&&e instanceof r?e:e?c(e,u,i):i()}function n(n,r,o,i){if(!d.aborted||i){e&&e(n,r,o);for(var a=t(o),u=m(n),c=u.length,f=0;f<c;f++)u[f].apply(a,r);var p=s[y[n]];return p&&p.push([b,n,r,a]),a}}function l(e,t){v[e]=m(e).concat(t)}function m(e){return v[e]||[]}function w(e){return p[e]=p[e]||o(n)}function g(e,t){f(e,function(e,n){t=t||"feature",y[n]=t,t in s||(s[t]=[])})}var v={},y={},b={on:l,emit:n,get:w,listeners:m,context:t,buffer:g,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",c=e("gos"),f=e(2),s={},p={},d=t.exports=o();d.backlog=s},{}],gos:[function(e,t,n){function r(e,t,n){if(o.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){o.buffer([e],r),o.emit(e,t,n)}var o=e("ee").get("handle");t.exports=r,r.ee=o},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!x++){var e=h.info=NREUM.info,t=d.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&t))return s.abort();f(y,function(t,n){e[t]||(e[t]=n)}),c("mark",["onload",a()+h.offset],null,"api");var n=d.createElement("script");n.src="https://"+e.agent,t.parentNode.insertBefore(n,t)}}function o(){"complete"===d.readyState&&i()}function i(){c("mark",["domContent",a()+h.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-h.offset}var u=(new Date).getTime(),c=e("handle"),f=e(2),s=e("ee"),p=window,d=p.document,l="addEventListener",m="attachEvent",w=p.XMLHttpRequest,g=w&&w.prototype;NREUM.o={ST:setTimeout,SI:p.setImmediate,CT:clearTimeout,XHR:w,REQ:p.Request,EV:p.Event,PR:p.Promise,MO:p.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1071.min.js"},b=w&&g&&g[l]&&!/CriOS/.test(navigator.userAgent),h=t.exports={offset:u,now:a,origin:v,features:{},xhrWrappable:b};e(1),d[l]?(d[l]("DOMContentLoaded",i,!1),p[l]("load",r,!1)):(d[m]("onreadystatechange",o),p[m]("onload",r)),c("mark",["firstbyte",u],null,"api");var x=0,E=e(4)},{}]},{},["loader"]);</script>
    <meta name="robots" content="all" />
    <meta name="MSSmartTagsPreventParsing" content="true" />
    <meta name="title"       content="Ruby on Rails チュートリアル：実例を使って Rails を学ぼう" />
    <meta name="description" content="SNSの開発を題材にした無料の大型チュートリアルで、ウェブサービスの開発から公開までの流れを実例を通して学べます。解説動画や質問対応サービスも提供しています。" />
    <meta name="keywords"    content="Ruby Rails チュートリアル ウェブ Rails開発 入門" />
    <meta name="author"      content="Michael Hartl" />
    <link rel="author" type="text/plain" href="/humans.txt" />
    <meta name="viewport" content="width=device-width,initial-scale1=1">

    <meta property="fb:admins"      content="715330868" />
    <meta property="fb:app_id"      content="144878509039953" />
    <meta property="og:title"       content="Ruby on Rails チュートリアル：実例を使って Rails を学ぼう"/>
    <meta property="og:site_name"   content="Ruby on Rails チュートリアル：実例を使って Rails を学ぼう"/>
    <meta property="og:image"       content="http://railstutorial.jp/images/layout/logo.png"/>
    <meta property="og:url"         content="http://railstutorial.jp/">
    <meta property="og:type"        content="article" />
    <meta property="og:description" content="SNSの開発を題材にした無料の大型チュートリアルで、ウェブサービスの開発から公開までの流れを実例を通して学べます。解説動画や質問対応サービスも提供しています。" />

    <meta name="twitter:card"  content="summary" />
    <meta name="twitter:site"  content="@RailsTutorialJP" />
    <meta name="twitter:title" content="Ruby on Rails チュートリアル：実例を使って Rails を学ぼう" />
    <meta name="twitter:description" content="SNSの開発を題材にした無料の大型チュートリアルで、ウェブサービスの開発から公開までの流れを実例を通して学べます。解説動画や質問対応サービスも提供しています。" />
    <meta name="twitter:image" content="http://railstutorial.jp/images/layout/logo.png" />
    <meta name="twitter:url"   content="http://railstutorial.jp/" />

    <link rel="apple-touch-icon" sizes="57x57"   href="/images/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60"   href="/images/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72"   href="/images/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76"   href="/images/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/images/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/images/favicons/favicon-96x96.png">

    <link rel="manifest"  href="/manifest.json">
    <link rel="mask-icon" href="/images/favicons/safari-pinned-tab.svg" color="#6e0421">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/images/favicons/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <script src="/assets/application-fdc297d5fe789cf50d44d4b5b6ee3b1f4ea9e54f4e86ca89650a3d3ba7b4ab1f.js"></script>

      <link rel="stylesheet" media="all" href="/assets/5.1/application-5f212495099c7e2a544abd41c63e88d66dead0fab2804887e1ebbb7eeba66f50.css" />

    <link rel="stylesheet" media="screen, projection" href="/assets/screen-37073bd85e9a0572ab09daa19972e2bce7636f360ed415dee497ccb801a2c0d6.css" />
    <link rel="stylesheet" media="print" href="/assets/print-4c2a06b9d892cf06cd0c15e4c22e9351289583b1166c4d317d8cd592e78866c2.css" />
    <link rel="stylesheet" media="screen, projection" href="/assets/social-e552f1f8160f4e73a01bfe2d868d9f91957968b24ac2a598de42abdad49de7ec.css" />
    <!--[if lte IE 7]>
      <link rel="stylesheet" media="screen" href="/assets/ie-1232fac3f4dcdce0b4cb1e7f792b26045f5e46119d622033b077d5c62d212ff0.css" />
    <![endif]-->
    <!--[if lt IE 7]>  <div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>    <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>    <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>      <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>      <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>        <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>You are using an outdated browser</div>        <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>For a better experience using this site, please upgrade to a modern web browser.</div>      </div>      <div style='width: 75px; float: left;'><a href='http://www.firefox.com' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox 3.5'/></a></div>      <div style='width: 75px; float: left;'><a href='http://www.browserforthebetter.com/download.html' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-ie8.jpg' style='border: none;' alt='Get Internet Explorer 8'/></a></div>      <div style='width: 73px; float: left;'><a href='http://www.apple.com/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari 4'/></a></div>      <div style='float: left;'><a href='http://www.google.com/chrome' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>    </div>  </div>  <![endif]-->
    <link href='http://feeds.feedburner.com/railstutorial' rel='alternate' title='Rails Tutorial News' type='application/rss+xml' />

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-42117937-1', 'railstutorial.jp');
      ga('send', 'pageview');
    </script>

    <!-- start Mixpanel -->
    <script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f);b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==
      typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(g=0;g<i.length;g++)f(c,i[g]);
        b._i.push([a,e,d])};b.__SV=1.2}})(document,window.mixpanel||[]);
  mixpanel.init("b978862108ac23f0b2ef9decccaea395");</script>
    <!-- end Mixpanel -->
    <script type="text/javascript" async
	    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
    </script>
  </head>
  
<body class="book">
  <div id="container">
    <div id="header" class="clearfix">
  <div id='title'>
    <div id='logo'><a href="http://railstutorial.jp/"><img alt="Logo" src="/images/layout/logo.png?1304201481" /></a></div>
    <h1 id='name'>
      <a href="http://railstutorial.jp/">Ruby on Rails チュートリアル</a>
    </h1>
    <br />
    <h2 id='authors'>
      <a href="http://railstutorial.jp/">by Michael Hartl (マイケル・ハートル)</a>
    </h2>
    <div class="hamburger-button">
  <div class="menu-trigger">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<div class="drawr">
  <h1>MENU</h1>
  <div id="announcement"></div>

    <div class="arrows-section">

        <a class="arrows" href="rails_flavored_ruby?version=5.1#cha-rails_flavored_ruby">
          <div>
            <svg style="margin:0 auto;" width="35" height="35" viewBox="0 0 208.79 135.47"><defs xmlns="http://www.w3.org/2000/svg"><style>.a{fill:#fff;}.b{fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;}</style></defs><polygon class="a" points="1.62 67.53 207.59 0.5 169.41 66.56 208.29 133.77 208.29 134.78 1.62 67.53"/><polyline class="b" points="208.29 133.77 208.29 134.78 1.62 67.53 207.59 0.5"/><polyline class="b" points="207.59 0.5 169.41 66.56 208.29 133.77"/></svg>
          </div>
          PREV
        </a>

      <a class="arrows disable-drawr" href="#book_menu">
        <div>
          <svg style="margin:0 auto;" width="35" height="35" viewBox="0 0 232.14 136.56"><path fill="#fff" stroke="#fff" d="M262.64,216.23,377.46,351.14H376.2C351.14,343.79,309.3,339,261.91,339s-89,4.79-114,12.11Z" transform="translate(-146.4 -215.46)"/><path fill="#fff" stroke="#fff" d="M376.2,351.14C351.14,343.79,309.3,339,261.91,339s-89,4.79-114,12.11L262.64,216.23,377.46,351.14Z" transform="translate(-146.4 -215.46)"/></svg>
        </div>
        UP
      </a>

        <a class="arrows" href="modeling_users?version=5.1#cha-modeling_users">
          <div>
            <svg style="margin:0 auto;" width="35" height="35" viewBox="0 0 208.79 135.47"><defs xmlns="http://www.w3.org/2000/svg"><style>.a{fill:#fff;}.b{fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;}</style></defs><polygon class="a" points="207.17 67.94 1.2 134.97 39.38 68.92 0.5 1.7 0.5 0.69 207.17 67.94"/><polyline class="b" points="0.5 1.7 0.5 0.69 207.17 67.94 1.2 134.97"/><polyline class="b" points="1.2 134.97 39.38 68.92 0.5 1.7"/></svg>
          </div>
          NEXT
        </a>
      </div>

  <hr>

  <ul id="menu">
    <li><a href="/">ホーム</a></li>
    <li><a href="/seminars">解説セミナー</a></li>
    <li><a class="disable-drawr" href="/#screencast">解説動画 (質問対応付き)</a></li>
    <li><a href="/help">ヘルプ</a></li>
    <li><a href="/contact">お問い合わせ</a></li>
  </ul>

  <div id="chapters"></div>

  <div class="drawr-share">
    <div class="drawr-links">
      <div class="mobile-link-share hatebu">
        <a class="hatena-bookmark-button" data-hatena-bookmark-lang="ja" data-hatena-bookmark-layout="vertical-large" data-hatena-bookmark-title="Rails チュートリアル" href="http://b.hatena.ne.jp/entry/railstutorial.jp/" title="このエントリーをはてなブックマークに追加"><img alt="このエントリーをはてなブックマークに追加" height="20" src="https://b.st-hatena.com/images/entry-button/button-only@2x.png" style="border: none;" width="20"></a>
        <script async="async" charset="utf-8" src="https://b.st-hatena.com/js/bookmark_button.js" type="text/javascript"></script>
      </div>
      <div class="fb-like mobile-link-share" data-action="like" data-href="https://railstutorial.jp/" data-layout="box_count" data-share="false" data-show-faces="true" data-size="large" style="height: 85; width:80; margin-left: 15px; margin-right: 15px; margin-top: -5px; display: inline-flex;"></div>
      <div class="mobile-link-share custom-mobile-link">
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Frailstutorial.jp%2F&amp;src=sdkpreparse" target="_blank">
        <div class="share-description-top">
          <p>シェアする</p>
        </div>

        <div class="share-description-bottom" style="background-color: #3b5998; border-color: #3b5998;">
          <svg stroke="#fff" fill="#fff" height="33" viewbox="0 0 1792 1792" width="33" xmlns="http://www.w3.org/2000/svg">
          <path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z">
          </path></svg>
          <p style="color: #fff; float:right; margin-right:15px;">Share!</p>
        </div></a>
      </div>

      <div class="mobile-link-share custom-mobile-link">
        <a href="https://twitter.com/intent/tweet?hashtags=Rails%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB&original_referer=http%3A%2F%2Flocalhost%3A3000%2F&ref_src=twsrc%5Etfw&text=Rails%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%EF%BC%9A%E5%AE%9F%E4%BE%8B%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6Rails%E3%82%92%E5%AD%A6%E3%81%BC%E3%81%86&tw_p=tweetbutton&url=https%3A%2F%2Frailstutorial.jp%2F&via=RailsTutorialJP">
          <div class="share-description-top">
            <p>ツイートする</p>
          </div>

          <div class="share-description-bottom" style="background-color: #1da1f2; border-color: #1da1f2;">
            <svg stroke="#fff" fill="#fff" height="33" viewbox="0 0 1792 1792" width="33" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path></svg>
            <p style="color: #fff; float:right; margin-right:15px;">Tweet!</p>
          </div>
        </a>
      </div>

      <div class="mobile-link-share custom-mobile-link">
        <a href="https://twitter.com/intent/tweet?user_id=2218766892&lang=ja&text=%E3%81%93%E3%81%AE%E7%AB%A0%E3%81%AEooo%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%A7%E3%81%99%E3%81%8C%E3%80%81%E6%AD%A3%E3%81%97%E3%81%8F%E3%81%AFxxx%E3%81%A0%E3%81%A8%E6%80%9D%E3%81%84%E3%81%BE%E3%81%99%E3%80%82&url=http%3A%2F%2Frailstutorial.jp/chapters/filling_in_the_layout?version=5.1&hashtags=Railsチュートリアル">
            <div class="share-description-top">
            <p>誤訳を報告する</p>
          </div>

          <div class="share-description-bottom" style="background-color: #1da1f2; border-color: #1da1f2;">
            <svg stroke="#fff" fill="#fff" height="33" viewbox="0 0 1792 1792" width="33" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"></path></svg>
            <p style="color: #fff; float:right; margin-right:15px;">Tweet!</p>
          </div>
        </a>
      </div>
    </div>

    <div style="padding-top: 1em; margin-bottom: 70px; overflow:hidden;">
      <a href="http://railsguides.jp"><img alt="Railsガイド" src="/images/banners/railsguides-large-size_600_200.png" width="300px"></a>
    </div>
  </div>
</div>

  </div>
</div>

<div class="menu">
  <div class='links'>
    <div class='box' style="padding-left: 60px;">
      <span>
	<a href="/">ホーム</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/help">ヘルプ</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/contact">お問い合わせ</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/seminars">解説セミナー</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/#screencast">解説動画 (質問対応付き)</a>
      </span>
      <span class='division'>|</span>
      <span style="padding-top:8px">
	<a href="http://b.hatena.ne.jp/entry/railstutorial.jp/" class="hatena-bookmark-button"
	   data-hatena-bookmark-title="Rails チュートリアル" data-hatena-bookmark-layout="simple-balloon"
	   data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
	  <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png"
	       alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
	</a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
      </span>
      <span class='division'>|</span>
      <div class="fb-like" data-href="https://railstutorial.jp/" data-send="false"
	   data-layout="button_count" data-show-faces="false" data-size="small"
	   data-font="arial" style="margin-top: -5px;"></div>
    </div>
  </div>
</div>



    <div id="content">
      <div id='sidebar'>
  <div class='content'>
    <div id='navtool'>

      <table class='layout'>
        <tr>
          <td colspan='2'><a href="#book_menu"><img alt="Up A Level" src="/images/buttons/sb_button_up.png?1304201480" /></a></td>
        </tr>
        <tr>
          <td><a href="rails_flavored_ruby?version=5.1#cha-rails_flavored_ruby"><img alt="Previous Chapter" src="/assets/buttons/sb_button_prev-ba223c8d9bceb768c3e503906bd5876e.png" /></a></td>
          <td><a href="modeling_users?version=5.1#cha-modeling_users"><img alt="Next Chapter" src="/assets/buttons/sb_button_next-2018f09b6d56ec04ec43bfb0cf53741a.png" /></a></td>
        </tr>
      </table>

      <a id="sidebar_ebook" href="https://gumroad.com/l/railstutorialjp_ebook">
        <img alt="電子書籍を購入" src="/images/buttons/sb_btn_ebook.png" />
      </a>
      <br />
      <a id="sidebar_screencast" href="/#screencast">
        <img alt="実演動画を購入" src="/images/buttons/sb_btn_screencasts.png" />
      </a>
      <div id="announcement-origin">
	<div class='section'>
          <div><b>Railsチュートリアルの<a href="/#screencast">質問対応サービス</a>が開始!</b> ガッツリと学びたい個人, 法人にオススメです 🎓
	  </div>
        </div>

	<a target="_blank" href="https://docs.google.com/forms/d/e/1FAIpQLSdy6w2lFSORNHc5WBKZ6H2XHOOIj_4yniy3Zy9TZw9khI1rkA/viewform?usp=sf_link"><img alt="[PR] 就業相談受付中 - DIVE INTO CODE" width="151px" src="/assets/DIVE_INTO_CODE-fd20b166ede52fd8f4e1c883dcdb9fe5c275ba5fe2c28737bbcdd0fd952e3a4e.jpg" /></a>
      </div>

      <div class='connect'>
        <table class='center'>
          <tr>
            <td><a id="sidebar_help" href="/help"><img alt="railstutorialjp-icon24x24" src="/images/icons/help-icon24x24.png?1304201481" title="困った時のヘルプページ" /></a></td>
            <td><a href="/contact"><img alt="mail-icon24x24" src="/images/icons/email-icon24x24.png?1304201481" title="翻訳に関する問い合わせ" /></a></td>
            <td><a href="https://twitter.com/RailsTutorialJP" target="_blank"><img alt="twitter-icon24x24" src="/images/icons/twitter-icon24x24.png?1304201481" title="公式Twitterアカウント" /></a></td>
            <td><a href="https://github.com/yasslab/sample_apps" target="_blank"><img alt="github-icon24x24" src="/images/icons/github-icon24x24.png?1304201481" title="サンプルコード集" /></a></td>
          </tr>
        </table>
      </div>

      <div class="section">
        <div class="switcher">
            <span class="title round">Rails 5.1 (第4版)</span>
            <span class="switcher_link">
              <a href="https://railstutorial.jp/?version=5.0#walk-through">Rails 5.0 (第4版)</a>
            </span>
            <span class="switcher_link">
              <a href="https://railstutorial.jp/?version=4.2#walk-through">Rails 4.2 (第3版)</a>
            </span>
            <span class="switcher_link">
              <a href="https://railstutorial.jp/?version=4.0#walk-through">Rails 4.0 (第2版)</a>
            </span>
        </div>

        <div class="share">
    <div class="fb-share-button" data-href="https://railstutorial.jp/" data-layout="button"
	 data-size="small" data-mobile-iframe="true" style="padding-bottom: 5px">
      <a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Frailstutorial.jp%2F&amp;src=sdkpreparse">シェア</a></div>
          <a href="https://twitter.com/share"
             class="twitter-share-button"
             data-url="https://railstutorial.jp/"
             data-text="Railsチュートリアル：実例を使ってRailsを学ぼう"
             data-lang="ja" data-hashtags="Railsチュートリアル" data-via="RailsTutorialJP">ツイート</a>
          <a href="https://twitter.com/intent/tweet?user_id=2218766892&lang=ja&text=%E3%81%93%E3%81%AE%E7%AB%A0%E3%81%AEooo%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%A7%E3%81%99%E3%81%8C%E3%80%81%E6%AD%A3%E3%81%97%E3%81%8F%E3%81%AFxxx%E3%81%A0%E3%81%A8%E6%80%9D%E3%81%84%E3%81%BE%E3%81%99%E3%80%82&url=http%3A%2F%2Frailstutorial.jp/chapters/filling_in_the_layout?version=5.1&hashtags=Railsチュートリアル">
            <img src="/images/buttons/report_button.png"
                 onmouseover="this.src='/images/buttons/report_button_hover.png'"
                  onmouseout="this.src='/images/buttons/report_button.png'"
                       width="100px" height="20px" />
          </a>
        </div>
      </div>

<!--
<div>
  <a id="sidebar_screencast" target="_blank" href="https://diveintocode.recruitment.jp/">
          <img alt="[PR] Dive into Code 採用情報" width="150px"
	 src="/images/banners/dive_into_code.png" />
        </a>
</div>
-->

      <div style="color: white; padding-top: 5px;">
        <a href="http://railsguides.jp"><img alt="Railsガイド" width="150px"
                                             src="/images/banners/railsguides.png" /></a>
      </div>
<!--
      <div style="color: white;">
        <a href="/seminars"><img alt="Rails解説セミナー" width="150px"
                                 src="/images/banners/railsseminar.jpg" /></a>
      </div>
-->
      <!--
      <div class='section' style="color: #990000; font-weight: bold;">
        <div>テキスト広告例</div>
        <div style="font-size: 130%;"><span style="text-decoration: line-through;">2,980円</span> → 1,980円</div>
        <div>１行は全角１１文字まで</div>
      </div>
      -->
    </div>
  </div>

</div>
<script type="text/javascript">
  mixpanel.track_links("#sidebar_ebook", "click ebook link@sidebar", {
  referrer: document.referrer
  });
  mixpanel.track_links("#sidebar_help", "click help link@sidebar", {
  referrer: document.referrer
  });
</script>


      <div id="main" class="withsidebar">
        <div id="book_menu">
</div>


        <div id="book_wrap">
          <div id="book_top"></div>
          <div id="book">
            <h1 class="title">Ruby on Rails チュートリアル</h1>
<h1 class="subtitle">実例を使ってRailsを学ぼう</h1>
<h2 class="author">Michael Hartl (マイケル・ハートル)</h2>


            <h1 class="contents">第4版 目次</h1><div id="table_of_contents"><ul><li class="chapter-star"><a href="/chapters/beginning?version=5.1#推薦の言葉" class="heading hyperref">推薦の言葉</a></li><li class="chapter-star"><a href="/chapters/beginning?version=5.1#謝辞" class="heading hyperref">謝辞</a></li><li class="chapter-star"><a href="/chapters/beginning?version=5.1#author" class="heading hyperref">著者</a></li><li class="chapter-star"><a href="/chapters/beginning?version=5.1#copyright" class="heading hyperref">著作権とライセンス</a></li><li class="chapter"><a href="/chapters/beginning?version=5.1#cha-beginning" class="heading hyperref"><span class="number">第1章</span>ゼロからデプロイまで</a></li><li><ul><li class="section"><a href="/chapters/beginning?version=5.1#sec-introduction" class="heading hyperref"><span class="number">1.1 </span>はじめに</a></li><li><ul><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-prerequisites" class="heading hyperref"><span class="number">1.1.1 </span>前提知識</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-conventions" class="heading hyperref"><span class="number">1.1.2 </span>この本における取り決め</a></li></ul></li><li class="section"><a href="/chapters/beginning?version=5.1#sec-up_and_running" class="heading hyperref"><span class="number">1.2 </span>さっそく動かす</a></li><li><ul><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-development_environment" class="heading hyperref"><span class="number">1.2.1 </span>開発環境</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-installing_rails" class="heading hyperref"><span class="number">1.2.2 </span>Railsをインストールする</a></li></ul></li><li class="section"><a href="/chapters/beginning?version=5.1#sec-the_hello_application" class="heading hyperref"><span class="number">1.3 </span>最初のアプリケーション</a></li><li><ul><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-bundler" class="heading hyperref"><span class="number">1.3.1 </span>Bundler</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-rails_server" class="heading hyperref">
  <span class="number">1.3.2 </span>
  <code class="tt">rails server</code>
</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-mvc" class="heading hyperref"><span class="number">1.3.3 </span>Model-View-Controller (MVC)</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-hello_world" class="heading hyperref"><span class="number">1.3.4 </span>Hello, world!</a></li></ul></li><li class="section"><a href="/chapters/beginning?version=5.1#sec-version_control" class="heading hyperref"><span class="number">1.4 </span>Gitによるバージョン管理</a></li><li><ul><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-git_setup" class="heading hyperref"><span class="number">1.4.1 </span>インストールとセットアップ</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-what_good_does_git_do_you" class="heading hyperref"><span class="number">1.4.2 </span>Gitのメリット</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-bitbucket" class="heading hyperref"><span class="number">1.4.3 </span>Bitbucket</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-git_commands" class="heading hyperref"><span class="number">1.4.4 </span>ブランチ、編集、コミット、マージ</a></li></ul></li><li class="section"><a href="/chapters/beginning?version=5.1#sec-deploying" class="heading hyperref"><span class="number">1.5 </span>デプロイする</a></li><li><ul><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-heroku_setup" class="heading hyperref"><span class="number">1.5.1 </span>Herokuのセットアップ</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-heroku_step_one" class="heading hyperref"><span class="number">1.5.2 </span>Herokuにデプロイする (1)</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-heroku_step_two" class="heading hyperref"><span class="number">1.5.3 </span>Herokuにデプロイする (2)</a></li><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-heroku_commands" class="heading hyperref"><span class="number">1.5.4 </span>Herokuコマンド</a></li></ul></li><li class="section"><a href="/chapters/beginning?version=5.1#sec-beginning_conclusion" class="heading hyperref"><span class="number">1.6 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/beginning?version=5.1#sec-beginning_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">1.6.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/toy_app?version=5.1#cha-a_toy_app" class="heading hyperref"><span class="number">第2章</span>Toyアプリケーション</a></li><li><ul><li class="section"><a href="/chapters/toy_app?version=5.1#sec-planning_the_application" class="heading hyperref"><span class="number">2.1 </span>アプリケーションの計画</a></li><li><ul><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-modeling_demo_users" class="heading hyperref"><span class="number">2.1.1 </span>ユーザーのモデル設計</a></li><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-modeling_demo_microposts" class="heading hyperref"><span class="number">2.1.2 </span>マイクロポストのモデル設計</a></li></ul></li><li class="section"><a href="/chapters/toy_app?version=5.1#sec-demo_users_resource" class="heading hyperref"><span class="number">2.2 </span>Usersリソース</a></li><li><ul><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-a_user_tour" class="heading hyperref"><span class="number">2.2.1 </span>ユーザーページを探検する</a></li><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-mvc_in_action" class="heading hyperref"><span class="number">2.2.2 </span>MVCの挙動</a></li><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-weaknesses_of_this_users_resource" class="heading hyperref"><span class="number">2.2.3 </span>Usersリソースの欠点</a></li></ul></li><li class="section"><a href="/chapters/toy_app?version=5.1#sec-microposts_resource" class="heading hyperref"><span class="number">2.3 </span>Micropostsリソース</a></li><li><ul><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-a_micropost_microtour" class="heading hyperref"><span class="number">2.3.1 </span>マイクロポストを探検する</a></li><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-putting_the_micro_in_microposts" class="heading hyperref"><span class="number">2.3.2 </span>マイクロポストを<em>マイクロ</em>にする</a></li><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-demo_user_has_many_microposts" class="heading hyperref"><span class="number">2.3.3 </span>ユーザーは<code class="tt">たくさん</code>マイクロポストを持っている</a></li><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-inheritance_hierarchies" class="heading hyperref"><span class="number">2.3.4 </span>継承の階層</a></li><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-deploying_the_toy_app" class="heading hyperref"><span class="number">2.3.5 </span>アプリケーションをデプロイする</a></li></ul></li><li class="section"><a href="/chapters/toy_app?version=5.1#sec-toy_app_conclusion" class="heading hyperref"><span class="number">2.4 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/toy_app?version=5.1#sec-toy_app_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">2.4.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/static_pages?version=5.1#cha-static_pages" class="heading hyperref"><span class="number">第3章</span>ほぼ静的なページの作成</a></li><li><ul><li class="section"><a href="/chapters/static_pages?version=5.1#sec-sample_app_setup" class="heading hyperref"><span class="number">3.1 </span>セットアップ</a></li><li class="section"><a href="/chapters/static_pages?version=5.1#sec-static_pages" class="heading hyperref"><span class="number">3.2 </span>静的ページ</a></li><li><ul><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-generated_static_pages" class="heading hyperref"><span class="number">3.2.1 </span>静的なページの生成</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-custom_static_pages" class="heading hyperref"><span class="number">3.2.2 </span>静的なページの調整</a></li></ul></li><li class="section"><a href="/chapters/static_pages?version=5.1#sec-getting_started_with_testing" class="heading hyperref"><span class="number">3.3 </span>テストから始める</a></li><li><ul><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-our_first_test" class="heading hyperref"><span class="number">3.3.1 </span>最初のテスト</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-red" class="heading hyperref"><span class="number">3.3.2 </span>Red</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-green" class="heading hyperref"><span class="number">3.3.3 </span>Green</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-refactor" class="heading hyperref"><span class="number">3.3.4 </span>Refactor</a></li></ul></li><li class="section"><a href="/chapters/static_pages?version=5.1#sec-slightly_dynamic_pages" class="heading hyperref"><span class="number">3.4 </span>少しだけ動的なページ</a></li><li><ul><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-testing_titles" class="heading hyperref"><span class="number">3.4.1 </span>タイトルをテストする (Red)</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-adding_page_titles" class="heading hyperref"><span class="number">3.4.2 </span>タイトルを追加する (Green)</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-layouts_and_embedded_ruby" class="heading hyperref"><span class="number">3.4.3 </span>レイアウトと埋め込みRuby (Refactor)</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-setting_the_root_route" class="heading hyperref"><span class="number">3.4.4 </span>ルーティングの設定</a></li></ul></li><li class="section"><a href="/chapters/static_pages?version=5.1#sec-static_pages_conclusion" class="heading hyperref"><span class="number">3.5 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-static_pages_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">3.5.1 </span>本章のまとめ</a></li></ul></li><li class="section"><a href="/chapters/static_pages?version=5.1#sec-advanced_testing_setup" class="heading hyperref"><span class="number">3.6 </span>高度なセットアップ</a></li><li><ul><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-minitest_reporters" class="heading hyperref"><span class="number">3.6.1 </span>minitest reporters</a></li><li class="subsection"><a href="/chapters/static_pages?version=5.1#sec-guard" class="heading hyperref"><span class="number">3.6.2 </span>Guardによるテストの自動化</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/rails_flavored_ruby?version=5.1#cha-rails_flavored_ruby" class="heading hyperref"><span class="number">第4章</span>Rails風味のRuby</a></li><li><ul><li class="section"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-motivation" class="heading hyperref"><span class="number">4.1 </span>動機</a></li><li><ul><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-built_in_helpers" class="heading hyperref"><span class="number">4.1.1 </span>組み込みヘルパー</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-custom_helpers" class="heading hyperref"><span class="number">4.1.2 </span>カスタムヘルパー</a></li></ul></li><li class="section"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-strings_and_methods" class="heading hyperref"><span class="number">4.2 </span>文字列とメソッド</a></li><li><ul><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-comments" class="heading hyperref"><span class="number">4.2.1 </span>コメント</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-strings" class="heading hyperref"><span class="number">4.2.2 </span>文字列</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-objects_and_message_passing" class="heading hyperref"><span class="number">4.2.3 </span>オブジェクトとメッセージ受け渡し</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-method_definitions" class="heading hyperref"><span class="number">4.2.4 </span>メソッドの定義</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-back_to_the_title_helper" class="heading hyperref"><span class="number">4.2.5 </span>titleヘルパー、再び</a></li></ul></li><li class="section"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-other_data_structures" class="heading hyperref"><span class="number">4.3 </span>他のデータ構造</a></li><li><ul><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-arrays_and_ranges" class="heading hyperref"><span class="number">4.3.1 </span>配列と範囲演算子</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-blocks" class="heading hyperref"><span class="number">4.3.2 </span>ブロック</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-hashes_and_symbols" class="heading hyperref"><span class="number">4.3.3 </span>ハッシュとシンボル</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-css_revisited" class="heading hyperref"><span class="number">4.3.4 </span>CSS、再び</a></li></ul></li><li class="section"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-ruby_classes" class="heading hyperref"><span class="number">4.4 </span>Rubyにおけるクラス</a></li><li><ul><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-constructors" class="heading hyperref"><span class="number">4.4.1 </span>コンストラクタ</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-a_class_of_our_own" class="heading hyperref"><span class="number">4.4.2 </span>クラス継承</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-modifying_built_in_classes" class="heading hyperref"><span class="number">4.4.3 </span>組み込みクラスの変更</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-a_controller_class" class="heading hyperref"><span class="number">4.4.4 </span>コントローラクラス</a></li><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-a_user_class" class="heading hyperref"><span class="number">4.4.5 </span>ユーザークラス</a></li></ul></li><li class="section"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-conclusion" class="heading hyperref"><span class="number">4.5 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/rails_flavored_ruby?version=5.1#sec-rails_flavored_ruby_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">4.5.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/filling_in_the_layout?version=5.1#cha-filling_in_the_layout" class="heading hyperref"><span class="number">第5章</span>レイアウトを作成する</a></li><li><ul><li class="section"><a href="/chapters/filling_in_the_layout?version=5.1#sec-structure" class="heading hyperref"><span class="number">5.1 </span>構造を追加する</a></li><li><ul><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-adding_to_the_layout" class="heading hyperref"><span class="number">5.1.1 </span>ナビゲーション</a></li><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-custom_css" class="heading hyperref"><span class="number">5.1.2 </span>BootstrapとカスタムCSS</a></li><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-partials" class="heading hyperref"><span class="number">5.1.3 </span>パーシャル (partial)</a></li></ul></li><li class="section"><a href="/chapters/filling_in_the_layout?version=5.1#sec-sass_and_the_asset_pipeline" class="heading hyperref"><span class="number">5.2 </span>Sassとアセットパイプライン</a></li><li><ul><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-the_asset_pipeline" class="heading hyperref"><span class="number">5.2.1 </span>アセットパイプライン</a></li><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-sass" class="heading hyperref"><span class="number">5.2.2 </span>素晴らしい構文を備えたスタイルシート</a></li></ul></li><li class="section"><a href="/chapters/filling_in_the_layout?version=5.1#sec-layout_links" class="heading hyperref"><span class="number">5.3 </span>レイアウトのリンク</a></li><li><ul><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-contact_page" class="heading hyperref"><span class="number">5.3.1 </span>Contactページ</a></li><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-rails_routes" class="heading hyperref"><span class="number">5.3.2 </span>RailsのルートURL</a></li><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-named_routes" class="heading hyperref"><span class="number">5.3.3 </span>名前付きルート</a></li><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-layout_link_tests" class="heading hyperref"><span class="number">5.3.4 </span>リンクのテスト</a></li></ul></li><li class="section"><a href="/chapters/filling_in_the_layout?version=5.1#sec-user_signup" class="heading hyperref"><span class="number">5.4 </span>ユーザー登録: 最初のステップ</a></li><li><ul><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-users_controller" class="heading hyperref"><span class="number">5.4.1 </span>Usersコントローラ</a></li><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-signup_url" class="heading hyperref"><span class="number">5.4.2 </span>ユーザー登録用URL</a></li></ul></li><li class="section"><a href="/chapters/filling_in_the_layout?version=5.1#sec-layout_conclusion" class="heading hyperref"><span class="number">5.5 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/filling_in_the_layout?version=5.1#sec-filling_in_the_layout_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">5.5.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/modeling_users?version=5.1#cha-modeling_users" class="heading hyperref"><span class="number">第6章</span>ユーザーのモデルを作成する</a></li><li><ul><li class="section"><a href="/chapters/modeling_users?version=5.1#sec-user_model" class="heading hyperref"><span class="number">6.1 </span>Userモデル</a></li><li><ul><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-database_migrations" class="heading hyperref"><span class="number">6.1.1 </span>データベースの移行</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-the_model_file" class="heading hyperref"><span class="number">6.1.2 </span>modelファイル</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-creating_user_objects" class="heading hyperref"><span class="number">6.1.3 </span>ユーザーオブジェクトを作成する</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-finding_user_objects" class="heading hyperref"><span class="number">6.1.4 </span>ユーザーオブジェクトを検索する</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-updating_user_objects" class="heading hyperref"><span class="number">6.1.5 </span>ユーザーオブジェクトを更新する</a></li></ul></li><li class="section"><a href="/chapters/modeling_users?version=5.1#sec-user_validations" class="heading hyperref"><span class="number">6.2 </span>ユーザーを検証する</a></li><li><ul><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-a_validity_test" class="heading hyperref"><span class="number">6.2.1 </span>有効性を検証する</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-presence_validation" class="heading hyperref"><span class="number">6.2.2 </span>存在性を検証する</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-length_validation" class="heading hyperref"><span class="number">6.2.3 </span>長さを検証する</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-format_validation" class="heading hyperref"><span class="number">6.2.4 </span>フォーマットを検証する</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-uniqueness_validation" class="heading hyperref"><span class="number">6.2.5 </span>一意性を検証する</a></li></ul></li><li class="section"><a href="/chapters/modeling_users?version=5.1#sec-adding_a_secure_password" class="heading hyperref"><span class="number">6.3 </span>セキュアなパスワードを追加する</a></li><li><ul><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-a_hashed_password" class="heading hyperref"><span class="number">6.3.1 </span>ハッシュ化されたパスワード</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-has_secure_password" class="heading hyperref"><span class="number">6.3.2 </span>ユーザーがセキュアなパスワードを持っている</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-minimum_password_standards" class="heading hyperref"><span class="number">6.3.3 </span>パスワードの最小文字数</a></li><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-creating_and_authenticating_a_user" class="heading hyperref"><span class="number">6.3.4 </span>ユーザーの作成と認証</a></li></ul></li><li class="section"><a href="/chapters/modeling_users?version=5.1#sec-modeling_users_conclusion" class="heading hyperref"><span class="number">6.4 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/modeling_users?version=5.1#sec-modeling_users_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">6.4.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/sign_up?version=5.1#cha-sign_up" class="heading hyperref"><span class="number">第7章</span>ユーザー登録</a></li><li><ul><li class="section"><a href="/chapters/sign_up?version=5.1#sec-showing_users" class="heading hyperref"><span class="number">7.1 </span>ユーザーを表示する</a></li><li><ul><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-rails_environments" class="heading hyperref"><span class="number">7.1.1 </span>デバッグとRails環境</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-a_users_resource" class="heading hyperref"><span class="number">7.1.2 </span>Usersリソース</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-debugger" class="heading hyperref"><span class="number">7.1.3 </span>debuggerメソッド</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-a_gravatar_image" class="heading hyperref"><span class="number">7.1.4 </span>Gravatar画像とサイドバー</a></li></ul></li><li class="section"><a href="/chapters/sign_up?version=5.1#sec-signup_form" class="heading hyperref"><span class="number">7.2 </span>ユーザー登録フォーム</a></li><li><ul><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-using_form_for" class="heading hyperref"><span class="number">7.2.1 </span><code class="tt">form_for</code>を使用する</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-the_form_html" class="heading hyperref"><span class="number">7.2.2 </span>フォームHTML</a></li></ul></li><li class="section"><a href="/chapters/sign_up?version=5.1#sec-unsuccessful_signups" class="heading hyperref"><span class="number">7.3 </span>ユーザー登録失敗</a></li><li><ul><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-a_working_form" class="heading hyperref"><span class="number">7.3.1 </span>正しいフォーム</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-strong_parameters" class="heading hyperref"><span class="number">7.3.2 </span>Strong Parameters</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-signup_error_messages" class="heading hyperref"><span class="number">7.3.3 </span>エラーメッセージ</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-a_test_for_invalid_submission" class="heading hyperref"><span class="number">7.3.4 </span>失敗時のテスト</a></li></ul></li><li class="section"><a href="/chapters/sign_up?version=5.1#sec-successful_signups" class="heading hyperref"><span class="number">7.4 </span>ユーザー登録成功</a></li><li><ul><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-the_finished_signup_form" class="heading hyperref"><span class="number">7.4.1 </span>登録フォームの完成</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-the_flash" class="heading hyperref"><span class="number">7.4.2 </span>flash</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-the_first_signup" class="heading hyperref"><span class="number">7.4.3 </span>実際のユーザー登録</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-a_test_for_valid_submission" class="heading hyperref"><span class="number">7.4.4 </span>成功時のテスト</a></li></ul></li><li class="section"><a href="/chapters/sign_up?version=5.1#sec-professional_grade_deployment" class="heading hyperref"><span class="number">7.5 </span>プロのデプロイ</a></li><li><ul><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-ssl_in_production" class="heading hyperref"><span class="number">7.5.1 </span>本番環境でのSSL</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-production_webserver" class="heading hyperref"><span class="number">7.5.2 </span>本番環境用のWebサーバー</a></li><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-production_deployment" class="heading hyperref"><span class="number">7.5.3 </span>本番環境へのデプロイ</a></li></ul></li><li class="section"><a href="/chapters/sign_up?version=5.1#sec-sign_up_conclusion" class="heading hyperref"><span class="number">7.6 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/sign_up?version=5.1#sec-sign_up_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">7.6.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/basic_login?version=5.1#cha-basic_login" class="heading hyperref"><span class="number">第8章</span>基本的なログイン機構</a></li><li><ul><li class="section"><a href="/chapters/basic_login?version=5.1#sec-sessions_and_failed_login" class="heading hyperref"><span class="number">8.1 </span>セッション</a></li><li><ul><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-sessions_controller" class="heading hyperref"><span class="number">8.1.1 </span>Sessionsコントローラ</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-login_form" class="heading hyperref"><span class="number">8.1.2 </span>ログインフォーム</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-finding_and_authenticating_a_user" class="heading hyperref"><span class="number">8.1.3 </span>ユーザーの検索と認証</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-rendering_with_a_flash_message" class="heading hyperref"><span class="number">8.1.4 </span>フラッシュメッセージを表示する</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-a_flash_test" class="heading hyperref"><span class="number">8.1.5 </span>フラッシュのテスト</a></li></ul></li><li class="section"><a href="/chapters/basic_login?version=5.1#sec-logging_in" class="heading hyperref"><span class="number">8.2 </span>ログイン</a></li><li><ul><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-a_working_log_in_method" class="heading hyperref"><span class="number">8.2.1 </span><code class="tt">log_in</code>メソッド</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-current_user" class="heading hyperref"><span class="number">8.2.2 </span>現在のユーザー</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-changing_the_layout_links" class="heading hyperref"><span class="number">8.2.3 </span>レイアウトリンクを変更する</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-testing_layout_changes" class="heading hyperref"><span class="number">8.2.4 </span>レイアウトの変更をテストする</a></li><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-login_upon_signup" class="heading hyperref"><span class="number">8.2.5 </span>ユーザー登録時にログイン</a></li></ul></li><li class="section"><a href="/chapters/basic_login?version=5.1#sec-logging_out" class="heading hyperref"><span class="number">8.3 </span>ログアウト</a></li><li class="section"><a href="/chapters/basic_login?version=5.1#sec-basic_login_conclusion" class="heading hyperref"><span class="number">8.4 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/basic_login?version=5.1#sec-basic_login_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">8.4.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/advanced_login?version=5.1#cha-advanced_login" class="heading hyperref"><span class="number">第9章</span>発展的なログイン機構</a></li><li><ul><li class="section"><a href="/chapters/advanced_login?version=5.1#sec-remember_me" class="heading hyperref"><span class="number">9.1 </span>Remember me 機能</a></li><li><ul><li class="subsection"><a href="/chapters/advanced_login?version=5.1#sec-remember_token" class="heading hyperref"><span class="number">9.1.1 </span>記憶トークンと暗号化</a></li><li class="subsection"><a href="/chapters/advanced_login?version=5.1#sec-login_with_remembering" class="heading hyperref"><span class="number">9.1.2 </span>ログイン状態の保持</a></li><li class="subsection"><a href="/chapters/advanced_login?version=5.1#sec-forgetting_users" class="heading hyperref"><span class="number">9.1.3 </span>ユーザーを忘れる</a></li><li class="subsection"><a href="/chapters/advanced_login?version=5.1#sec-two_subtle_bugs" class="heading hyperref"><span class="number">9.1.4 </span>２つの目立たないバグ</a></li></ul></li><li class="section"><a href="/chapters/advanced_login?version=5.1#sec-remember_me_checkbox" class="heading hyperref"><span class="number">9.2 </span>[Remember me] チェックボックス</a></li><li class="section"><a href="/chapters/advanced_login?version=5.1#sec-remember_tests" class="heading hyperref"><span class="number">9.3 </span>[Remember me] のテスト</a></li><li><ul><li class="subsection"><a href="/chapters/advanced_login?version=5.1#sec-testing_the_remember_me_box" class="heading hyperref"><span class="number">9.3.1 </span>[Remember me] ボックスをテストする</a></li><li class="subsection"><a href="/chapters/advanced_login?version=5.1#sec-testing_the_remember_branch" class="heading hyperref"><span class="number">9.3.2 </span>[Remember me] をテストする</a></li></ul></li><li class="section"><a href="/chapters/advanced_login?version=5.1#sec-advanced_login_conclusion" class="heading hyperref"><span class="number">9.4 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/advanced_login?version=5.1#sec-advanced_login_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">9.4.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/updating_and_deleting_users?version=5.1#cha-updating_showing_and_deleting_users" class="heading hyperref"><span class="number">第10章</span>ユーザーの更新・表示・削除</a></li><li><ul><li class="section"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-updating_users" class="heading hyperref"><span class="number">10.1 </span>ユーザーを更新する</a></li><li><ul><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-edit_form" class="heading hyperref"><span class="number">10.1.1 </span>編集フォーム</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-unsuccessful_edits" class="heading hyperref"><span class="number">10.1.2 </span>編集の失敗</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-testing_unsuccessful_edits" class="heading hyperref"><span class="number">10.1.3 </span>編集失敗時のテスト</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-successful_edits" class="heading hyperref"><span class="number">10.1.4 </span>TDDで編集を成功させる</a></li></ul></li><li class="section"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-authorization" class="heading hyperref"><span class="number">10.2 </span>認可</a></li><li><ul><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-requiring_logged_in_users" class="heading hyperref"><span class="number">10.2.1 </span>ユーザーにログインを要求する</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-requiring_the_right_user" class="heading hyperref"><span class="number">10.2.2 </span>正しいユーザーを要求する</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-friendly_forwarding" class="heading hyperref"><span class="number">10.2.3 </span>フレンドリーフォワーディング</a></li></ul></li><li class="section"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-showing_all_users" class="heading hyperref"><span class="number">10.3 </span>すべてのユーザーを表示する</a></li><li><ul><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-users_index" class="heading hyperref"><span class="number">10.3.1 </span>ユーザーの一覧ページ</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-sample_users" class="heading hyperref"><span class="number">10.3.2 </span>サンプルのユーザー</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-pagination" class="heading hyperref"><span class="number">10.3.3 </span>ページネーション</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-users_index_test" class="heading hyperref"><span class="number">10.3.4 </span>ユーザー一覧のテスト</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-partial_refactoring" class="heading hyperref"><span class="number">10.3.5 </span>パーシャルのリファクタリング</a></li></ul></li><li class="section"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-deleting_users" class="heading hyperref"><span class="number">10.4 </span>ユーザーを削除する</a></li><li><ul><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-administrative_users" class="heading hyperref"><span class="number">10.4.1 </span>管理ユーザー</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-the_destroy_action" class="heading hyperref"><span class="number">10.4.2 </span><code class="tt">destroy</code>アクション</a></li><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-user_destroy_tests" class="heading hyperref"><span class="number">10.4.3 </span>ユーザー削除のテスト</a></li></ul></li><li class="section"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-updating_and_deleting_users_conclusion" class="heading hyperref"><span class="number">10.5 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/updating_and_deleting_users?version=5.1#sec-updating_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">10.5.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/account_activation?version=5.1#cha-account_activation" class="heading hyperref"><span class="number">第11章</span>アカウントの有効化</a></li><li><ul><li class="section"><a href="/chapters/account_activation?version=5.1#sec-account_activations_resource" class="heading hyperref"><span class="number">11.1 </span>AccountActivationsリソース</a></li><li><ul><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-account_activations_controller" class="heading hyperref"><span class="number">11.1.1 </span>AccountActivationsコントローラ</a></li><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-account_activation_data_model" class="heading hyperref"><span class="number">11.1.2 </span>AccountActivationのデータモデル</a></li></ul></li><li class="section"><a href="/chapters/account_activation?version=5.1#sec-account_activation_emails" class="heading hyperref"><span class="number">11.2 </span>アカウント有効化のメール送信</a></li><li><ul><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-mailer_templates" class="heading hyperref"><span class="number">11.2.1 </span>送信メールのテンプレート</a></li><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-email_previews" class="heading hyperref"><span class="number">11.2.2 </span>送信メールのプレビュー</a></li><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-email_tests" class="heading hyperref"><span class="number">11.2.3 </span>送信メールのテスト</a></li><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-updating_create" class="heading hyperref"><span class="number">11.2.4 </span>ユーザーの<code class="tt">create</code>アクションを更新</a></li></ul></li><li class="section"><a href="/chapters/account_activation?version=5.1#sec-activating_the_account" class="heading hyperref"><span class="number">11.3 </span>アカウントを有効化する</a></li><li><ul><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-generalizing_the_authenticated_method" class="heading hyperref"><span class="number">11.3.1 </span><code class="tt">authenticated?</code>メソッドの抽象化</a></li><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-activation_edit_action" class="heading hyperref"><span class="number">11.3.2 </span><code class="tt">edit</code>アクションで有効化</a></li><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-activation_test_and_refactoring" class="heading hyperref"><span class="number">11.3.3 </span>有効化のテストとリファクタリング</a></li></ul></li><li class="section"><a href="/chapters/account_activation?version=5.1#sec-activation_email_in_production" class="heading hyperref"><span class="number">11.4 </span>本番環境でのメール送信</a></li><li class="section"><a href="/chapters/account_activation?version=5.1#sec-activation_conclusion" class="heading hyperref"><span class="number">11.5 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/account_activation?version=5.1#sec-activation_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">11.5.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/password_reset?version=5.1#cha-password_reset" class="heading hyperref"><span class="number">第12章</span>パスワードの再設定</a></li><li><ul><li class="section"><a href="/chapters/password_reset?version=5.1#sec-password_resets_resource" class="heading hyperref"><span class="number">12.1 </span>PasswordResetsリソース</a></li><li><ul><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-password_resets_controller" class="heading hyperref"><span class="number">12.1.1 </span>PasswordResetsコントローラ</a></li><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-new_password_resets" class="heading hyperref"><span class="number">12.1.2 </span>新しいパスワードの設定</a></li><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-password_reset_create_action" class="heading hyperref"><span class="number">12.1.3 </span><code class="tt">create</code>アクションでパスワード再設定</a></li></ul></li><li class="section"><a href="/chapters/password_reset?version=5.1#sec-password_reset_emails" class="heading hyperref"><span class="number">12.2 </span>パスワード再設定のメール送信</a></li><li><ul><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-password_reset_mailer" class="heading hyperref"><span class="number">12.2.1 </span>パスワード再設定のメールとテンプレート</a></li><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-reset_email_tests" class="heading hyperref"><span class="number">12.2.2 </span>送信メールのテスト</a></li></ul></li><li class="section"><a href="/chapters/password_reset?version=5.1#sec-resetting_the_password" class="heading hyperref"><span class="number">12.3 </span>パスワードを再設定する</a></li><li><ul><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-reset_edit_action" class="heading hyperref"><span class="number">12.3.1 </span><code class="tt">edit</code>アクションで再設定</a></li><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-updating_the_reset" class="heading hyperref"><span class="number">12.3.2 </span>パスワードを更新する</a></li><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-password_reset_test" class="heading hyperref"><span class="number">12.3.3 </span>パスワードの再設定をテストする</a></li></ul></li><li class="section"><a href="/chapters/password_reset?version=5.1#sec-reset_email_in_production" class="heading hyperref"><span class="number">12.4 </span>本番環境でのメール送信 (再掲)</a></li><li class="section"><a href="/chapters/password_reset?version=5.1#sec-resets_conclusion" class="heading hyperref"><span class="number">12.5 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/password_reset?version=5.1#sec-activation_resets_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">12.5.1 </span>本章のまとめ</a></li></ul></li><li class="section"><a href="/chapters/password_reset?version=5.1#sec-expiration_proof" class="heading hyperref"><span class="number">12.6 </span>証明: 期限切れの比較</a></li></ul></li><li class="chapter"><a href="/chapters/user_microposts?version=5.1#cha-user_microposts" class="heading hyperref"><span class="number">第13章</span>ユーザーのマイクロポスト</a></li><li><ul><li class="section"><a href="/chapters/user_microposts?version=5.1#sec-a_micropost_model" class="heading hyperref"><span class="number">13.1 </span>Micropostモデル</a></li><li><ul><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-the_basic_model" class="heading hyperref"><span class="number">13.1.1 </span>基本的なモデル</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-micropost_validations" class="heading hyperref"><span class="number">13.1.2 </span>Micropostのバリデーション</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-user_micropost_associations" class="heading hyperref"><span class="number">13.1.3 </span>User/Micropostの関連付け</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-ordering_and_dependency" class="heading hyperref"><span class="number">13.1.4 </span>マイクロポストを改良する</a></li></ul></li><li class="section"><a href="/chapters/user_microposts?version=5.1#sec-showing_microposts" class="heading hyperref"><span class="number">13.2 </span>マイクロポストを表示する</a></li><li><ul><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-rendering_microposts" class="heading hyperref"><span class="number">13.2.1 </span>マイクロポストの描画</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-sample_microposts" class="heading hyperref"><span class="number">13.2.2 </span>マイクロポストのサンプル</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-profile_micropost_tests" class="heading hyperref"><span class="number">13.2.3 </span>プロフィール画面のマイクロポストをテストする</a></li></ul></li><li class="section"><a href="/chapters/user_microposts?version=5.1#sec-manipulating_microposts" class="heading hyperref"><span class="number">13.3 </span>マイクロポストを操作する</a></li><li><ul><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-micropost_access_control" class="heading hyperref"><span class="number">13.3.1 </span>マイクロポストのアクセス制御</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-creating_microposts" class="heading hyperref"><span class="number">13.3.2 </span>マイクロポストを作成する</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-a_proto_feed" class="heading hyperref"><span class="number">13.3.3 </span>フィードの原型</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-destroying_microposts" class="heading hyperref"><span class="number">13.3.4 </span>マイクロポストを削除する</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-micropost_tests" class="heading hyperref"><span class="number">13.3.5 </span>フィード画面のマイクロポストをテストする</a></li></ul></li><li class="section"><a href="/chapters/user_microposts?version=5.1#sec-micropost_images" class="heading hyperref"><span class="number">13.4 </span>マイクロポストの画像投稿</a></li><li><ul><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-basic_image_upload" class="heading hyperref"><span class="number">13.4.1 </span>基本的な画像アップロード</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-image_validation" class="heading hyperref"><span class="number">13.4.2 </span>画像の検証</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-image_resizing" class="heading hyperref"><span class="number">13.4.3 </span>画像のリサイズ</a></li><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-image_upload_in_production" class="heading hyperref"><span class="number">13.4.4 </span>本番環境での画像アップロード</a></li></ul></li><li class="section"><a href="/chapters/user_microposts?version=5.1#sec-user_microposts_conclusion" class="heading hyperref"><span class="number">13.5 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/user_microposts?version=5.1#sec-user_microposts_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">13.5.1 </span>本章のまとめ</a></li></ul></li></ul></li><li class="chapter"><a href="/chapters/following_users?version=5.1#cha-following_users" class="heading hyperref"><span class="number">第14章</span>ユーザーをフォローする</a></li><li><ul><li class="section"><a href="/chapters/following_users?version=5.1#sec-the_relationship_model" class="heading hyperref"><span class="number">14.1 </span>Relationshipモデル</a></li><li><ul><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-a_problem_with_the_data_model" class="heading hyperref"><span class="number">14.1.1 </span>データモデルの問題 (および解決策)</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-relationship_user_associations" class="heading hyperref"><span class="number">14.1.2 </span>User/Relationshipの関連付け</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-relationship_validations" class="heading hyperref"><span class="number">14.1.3 </span>Relationshipのバリデーション</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-following" class="heading hyperref"><span class="number">14.1.4 </span>フォローしているユーザー</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-followers" class="heading hyperref"><span class="number">14.1.5 </span>フォロワー</a></li></ul></li><li class="section"><a href="/chapters/following_users?version=5.1#sec-a_web_interface_for_following_and_followers" class="heading hyperref"><span class="number">14.2 </span>[Follow] のWebインターフェイス</a></li><li><ul><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-sample_following_data" class="heading hyperref"><span class="number">14.2.1 </span>フォローのサンプルデータ</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-stats_and_a_follow_form" class="heading hyperref"><span class="number">14.2.2 </span>統計と [Follow] フォーム</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-following_and_followers_pages" class="heading hyperref"><span class="number">14.2.3 </span>[Following] と [Followers] ページ</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-a_working_follow_button_the_standard_way" class="heading hyperref"><span class="number">14.2.4 </span>[Follow] ボタン (基本編)</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-a_working_follow_button_with_ajax" class="heading hyperref"><span class="number">14.2.5 </span>[Follow] ボタン (Ajax編)</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-following_tests" class="heading hyperref"><span class="number">14.2.6 </span>フォローをテストする</a></li></ul></li><li class="section"><a href="/chapters/following_users?version=5.1#sec-the_status_feed" class="heading hyperref"><span class="number">14.3 </span>ステータスフィード</a></li><li><ul><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-motivation_and_strategy" class="heading hyperref"><span class="number">14.3.1 </span>動機と計画</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-a_first_feed_implementation" class="heading hyperref"><span class="number">14.3.2 </span>フィードを初めて実装する</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-scopes_subselects_and_a_lambda" class="heading hyperref"><span class="number">14.3.3 </span>サブセレクト</a></li></ul></li><li class="section"><a href="/chapters/following_users?version=5.1#sec-following_conclusion" class="heading hyperref"><span class="number">14.4 </span>最後に</a></li><li><ul><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-guide_to_extensions" class="heading hyperref"><span class="number">14.4.1 </span>サンプルアプリケーションの機能を拡張する</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-guide_to_further_resources" class="heading hyperref"><span class="number">14.4.2 </span>読み物ガイド</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-following_users_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">14.4.3 </span>本章のまとめ</a></li><li class="subsection"><a href="/chapters/following_users?version=5.1#sec-afterword" class="heading hyperref"><span class="number">14.4.4 </span>訳者あとがき</a></li></ul></li></ul></li></ul></div>

            <div id="main_content"></div>
  <div class="chapter-star" id="推薦の言葉">
    <h1><a href="#推薦の言葉" class="heading hyperref">推薦の言葉</a></h1>
<p>私が前にいた会社 (CD Baby) は、かなり早い段階でRuby on Railsに乗り換えたのですが、またPHPに戻ってしまいました (詳細は私の名前をGoogleで検索してみてください)。そんな私ですが、Michael Hartl 氏の本を強く勧められたので、その本を使ってもう一度試してみた結果、今度は無事に Rails に乗り換えることができました。それがこの <em>Ruby on Rails チュートリアル</em>という本です。</p>
<p>私は多くの Rails 関連の本を参考にしてきましたが、真の決定版と呼べるものは本書をおいて他にありません。本書では、あらゆる手順が「<em>Rails 流</em>」で行われています。最初のうちは慣れるまでに時間がかかりましたが、この本を終えた今、ついにこれこそが自然な方式だと感じられるまでになりました。また、本書は Rails 関連の本の中で唯一、多くのプロが推奨するテスト駆動開発 (TDD: Test Driven Development) を、全編を通して実践しています。実例を使ってここまで分かりやすく解説された本は、本書が初めてでしょう。極めつけは、Git や GitHub、Heroku の実例に含めている点です。このような、実際の開発現場で使わているツールもチュートリアルに含まれているため、読者は、まるで実際のプロジェクトの開発プロセスを体験しているかのような感覚が得られるはずです。それでいて、それぞれの実例が独立したセクションになっているのではなく、そのどれもがチュートリアルの内容と見事に一体化しています。</p>
<p>本書は、筋道だった一本道の物語のようになっています。私自身、章の終わりにある練習問題もやりながら、この <em>Rails チュートリアル</em>を3日間かけて一気に読破しました<sup id="cha-0_footnote-ref-1" class="footnote"><a href="#cha-0_footnote-1">1</a></sup>。最初から最後まで、途中を飛ばさずにやるのが一番効果的で有益な読み方です。ぜひやってみてください。</p>
<p>それでは、楽しんでお読みください！</p>
<p style="margin-top: 6.0pt" class="noindent"><a href="http://sivers.org/" target="_blank" rel="noopener">Derek Sivers</a> (<a href="http://sivers.org/" target="_blank" rel="noopener">sivers.org</a>) <span class="break"></span>
<em>CD Baby 創業者</em></p>
<p>(訳注: たった3分のTEDの動画「<a href="https://www.ted.com/talks/derek_sivers_how_to_start_a_movement?language=ja" target="_blank" rel="noopener">社会運動をどうやって起こすか</a>」を観たことがある方もいるのではないでしょうか。その方からの推薦の言葉です。)</p>
</div>
  
<div class="chapter-star" id="謝辞"><h1><a href="#謝辞" class="heading hyperref">謝辞</a></h1>
<p>Ruby on Rails チュートリアルは、私の以前の著書「<em>RailsSpace</em>」と、その時の共著者 <a href="http://aure.com/" target="_blank" rel="noopener">Aurelius Prochazka</a> から多くを参考にさせてもらっています。Aure には、協力と本書への支援も含め、感謝したいと思います。また、<em>RailsSpace</em> と <em>Rails チュートリアル</em>の編集を担当した Debra Williams Cauley 氏にも謝意を表したく思います。彼女が野球の試合に連れて行ってくれる限り、私は本を書き続けるでしょう。</p>
<p>私にインスピレーションと知識を与えてくれた Rubyist の方々にも感謝したいと思います：
David Heinemeier Hansson, Yehuda Katz, Carl Lerche, Jeremy Kemper, Xavier Noria, Ryan Bates, Geoffrey Grosenbach, Peter Cooper, Matt Aimonetti, Mark Bates, Gregg Pollack, Wayne E. Seguin, Amy Hoy, Dave Chelimsky, Pat Maddox, Tom Preston-Werner, Chris Wanstrath, Chad Fowler, Josh Susser, Obie Fernandez, Ian McFarland, Steven Bristol, Pratik Naik, Sarah Mei, Sarah Allen, Wolfram Arnold, Alex Chaffee, Giles Bowkett, Evan Dorn, Long Nguyen, James Lindenbaum, Adam Wiggins, Tikhon Bernstam, Ron Evans, Wyatt Greene, Miles Forrest, Sandi Metz, Ryan Davis, Aaron Patterson, Pivotal Labs の方々、Heroku の方々、thoughtbot の方々、そして GitHub の方々、ありがとうございました。最後に、ここに書ききれないほど多くの読者からバグ報告や提案を頂きました。ご協力いただいた皆様のおかげで、本書の完成度をとことんまで高めることができました。</p>
<p>丁寧なレビュー、技術的なフィードバック、そして役立つ提案をしてくれた Andrew Thai に感謝します。また、<a href="http://learnenough.com/" target="_blank" rel="noopener">Learn Enough to Be Dangerous</a> の共同創業者である Nick Merwin と Lee Donahoe、日々のチュートリアルの制作をサポートしてくれてありがとう。</p>
<p>最後に、たくさんの読者の皆さん、そして、ここに挙げきれないほど多いコントリビューターのみんな、バグ報告や提案をしてくれてありがとう。彼ら/彼女らの多くの手助けに、最高の感謝を。</p>
</div>


<div class="chapter-star" id="author"><h1><a href="#author" class="heading hyperref">著者</a></h1>
<p><a href="http://www.michaelhartl.com/" target="_blank" rel="noopener">マイケル・ハートル (Michael Hartl)</a> は<a href="http://www.railstutorial.org/" target="_blank" rel="noopener"><em>Ruby on Rails Tutorial</em></a> という、Web 開発を学ぶときによく参考にされる本の著者です。
また、<a href="http://learnenough.com/" target="_blank" rel="noopener">Learn Enough to Be Dangerous</a> (<a href="http://learnenough.com/" target="_blank" rel="noopener">learnenough.com</a>) 教育系ウェブサイトの創業者でもあります。
以前は、(今ではすっかり古くなってしまいましたが)「<em>RailsSpace</em>」という本の執筆および開発に携わったり、また、 一時人気を博した Ruby on Rails ベースのSNSプラットフォーム「Insoshi」の開発にも携わっていました。
2011年には、Rails コミュニティへの高い貢献が認められて、<a href="https://rubyheroes.com/heroes/2011" target="_blank" rel="noopener">Ruby Hero Award</a> を受賞しました。</p>
<p><a href="http://college.harvard.edu/" target="_blank" rel="noopener">ハーバード大学</a>卒業後、<a href="http://www.caltech.edu/" target="_blank" rel="noopener">カリフォルニア工科大学</a>で<a href="http://resolver.caltech.edu/CaltechETD:etd-05222003-161626" target="_blank" rel="noopener">物理学博士号</a>を取得。シリコンバレーの有名な起業プログラム <a href="http://ycombinator.com/" target="_blank" rel="noopener">Y Combinator</a> の卒業生でもあります。</p>
</div>
<div class="chapter-star" id="copyright"><h1><a href="#copyright" class="heading hyperref">著作権とライセンス</a></h1>
<p><em>Ruby on Rails チュートリアル: 実例を使って Rails を学ぼう</em> Copyright © 2016 by Michael Hartl (最終更新日: 2016/10/24 23:37:56 PT)</p>
<p><em>Ruby on Rails チュートリアル</em>で掲載しているすべてのソースコードは、<a href="http://opensource.org/licenses/MIT" target="_blank" rel="noopener">MIT ライセンス</a>および<a href="http://people.freebsd.org/~phk/" target="_blank" rel="noopener">Beerware ライセンス</a>の元で提供されています。</p>
<p>(訳注: 「すべてのソースコード」とは、Railsチュートリアル内で題材としている「Railsアプリケーションのソースコード」を指します。「Railsチュートリアル」という教材は上記ライセンスで提供されていないのでご注意ください。商用でRailsチュートリアルをご利用する場合は<a href="http://railstutorial.jp/contact" target="_blank" rel="noopener">お問い合わせページ</a>からご連絡ください。)</p>
<div class="code"><div class="highlight"><pre>The MIT License

Copyright (c) 2016 Michael Hartl

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without restriction,
including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software,
and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF
ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED
TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR
A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT
SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
OR OTHER DEALINGS IN THE SOFTWARE.
</pre></div></div>
<div class="code"><div class="highlight"><pre>THE BEERWARE LICENSE (Revision 42)

Michael Hartl wrote this code. As long as you retain
this notice you can do whatever you want with this stuff.
If we meet some day, and you think this stuff is worth it,
you can buy me a beer in return.
</pre></div></div>
</div>

<div id="cha-0_footnotes">
  <ol class="footnotes">
    <li id="cha-0_footnote-1">3日間で読破できる人は例外です!<span class="intersentencespace"></span> 実際には数週間〜数ヶ月をかけて読むのが一般的です。 <a class="arrow" href="#cha-0_footnote-ref-1">↑</a></li>
  </ol>
</div>

            <div id="cha-filling_in_the_layout" data-tralics-id="cid26" class="chapter" data-number="5" data-chapter="filling_in_the_layout"><h1><a href="/chapters/filling_in_the_layout?version=5.1#cha-filling_in_the_layout" class="heading hyperref"><span class="number">第5章</span>レイアウトを作成する</a></h1>
<p><a href="/chapters/rails_flavored_ruby?version=5.1#cha-rails_flavored_ruby" class="hyperref">第<span class="ref">4</span>章</a>の簡単なRubyツアーでは、サンプルアプリケーションにアプリケーションスタイルシートを含める方法を学びました (<a href="/chapters/rails_flavored_ruby?version=5.1#sec-motivation" class="hyperref"><span class="ref">4.1</span></a>)。しかし<a href="/chapters/rails_flavored_ruby?version=5.1#sec-css_revisited" class="hyperref"><span class="ref">4.3.4</span></a>で指摘したとおり、このスタイルシートはまだ空のままです。この章では、アプリケーションにBootstrapフレームワークを組み込み、そして、カスタムスタイルを追加します<sup id="cha-5_footnote-ref-1" class="footnote"><a href="#cha-5_footnote-1">1</a></sup>。また、これまで作成したページ (HomeやAboutなど) へのリンクをレイアウトに追加します (<a href="/chapters/filling_in_the_layout?version=5.1#sec-structure" class="hyperref"><span class="ref">5.1</span></a>)。その途中で、パーシャル、Railsのルーティング、Asset Pipelineについて学び、さらにSassについても紹介します(<a href="/chapters/filling_in_the_layout?version=5.1#sec-sass_and_the_asset_pipeline" class="hyperref"><span class="ref">5.2</span></a>)。章の最後に、ユーザーをサイトにログインさせるための重要な一歩を踏み出します (<a href="/chapters/filling_in_the_layout?version=5.1#sec-user_signup" class="hyperref"><span class="ref">5.4</span></a>)。</p>
<p>本章では、サンプルアプリケーションにレイアウトを追加したり、修正したりといった部分に注力していきます。また、レイアウトについてはテスト駆動開発で進めたり、全くテストを書かない箇所もあります (テストを書くときと書かないときのガイドラインについては<a href="/chapters/static_pages?version=5.1#aside-when_to_test" class="hyperref">コラム <span class="ref">3.3</span></a>で解説します)。このため、本章ではテキストエディタによる修正とブラウザによる確認がほとんどになります。テスト駆動開発で進める唯一の箇所は、<a href="/chapters/filling_in_the_layout?version=5.1#sec-contact_page" class="hyperref"><span class="ref">5.3.1</span></a>のContactページを追加する箇所のみです。最後に、新しいテスト手法「 統合テスト (<em>Integration Test</em>)」について紹介します (<a href="/chapters/filling_in_the_layout?version=5.1#sec-layout_link_tests" class="hyperref"><span class="ref">5.3.4</span></a>)。統合テストを使って、最終的なレイアウトやリンクが正しいかどうかをチェックします。</p>
</div><div id="sec-structure" data-tralics-id="cid27" class="section" data-number="5.1"><h2><a href="/chapters/filling_in_the_layout?version=5.1#sec-structure" class="heading hyperref"><span class="number">5.1 </span>構造を追加する</a></h2>
<p><em>Railsチュートリアル</em>はWeb開発のための本であり、Webデザインの本ではありませんが、だからといって<em>何のスタイルもない</em>寒々しい外観のアプリケーションでいつまでも作業を続けていると憂鬱になってしまいます。そこでこの章では、レイアウトにいくつかの構造とCSSを与えて、最小限のスタイルを追加します。カスタムCSSルールの他に、Twitter社によるオープンソースのWebデザインフレームワークとして公開している<a href="http://getbootstrap.com/" target="_blank" rel="noopener"><em>Bootstrap</em></a>も利用します。また、<em>コード</em>そのものにもスタイルを与えます。つまり、散らかり始めたレイアウトのコードを、<em>パーシャル (Partial) </em>機能を使って整えていくということです。</p>
<p>Webアプリケーションを作成するときに、ユーザーインターフェイスの概要をできるだけ早いうちに把握しておくことがしばしば有用です。そこで本書では、<em>モックアップ</em> (Webの文脈ではよく<em>ワイヤーフレーム</em>と呼ばれます) という、実装後のアプリケーションの外観をスケッチして使っていきます<sup id="cha-5_footnote-ref-2" class="footnote"><a href="#cha-5_footnote-2">2</a></sup>。また本章では、主に<a href="/chapters/static_pages?version=5.1#sec-static_pages" class="hyperref"><span class="ref">3.2</span></a>で紹介したサイトロゴ、ナビゲーションヘッダー、サイトフッターを含む静的ページを開発します。これらのページの中で最も重要な、Homeページのモックアップを<a href="/chapters/filling_in_the_layout?version=5.1#fig-home_page_mockup" class="hyperref">図 <span class="ref">5.1</span></a>に示します。モックアップに基いて作成した最終結果は<a href="/chapters/filling_in_the_layout?version=5.1#fig-site_with_footer" class="hyperref">図 <span class="ref">5.9</span></a>で確認することができます。両者を見比べると、細部が若干異なることに気が付くでしょう (例えば、実際には最後にRailsのロゴをページに追加します)。しかしモックアップは正確である必要はありませんので、これで十分です。</p>
<div class="center figure" id="fig-home_page_mockup" data-tralics-id="uid537" data-number="5.1">
<div class="graphics image box"><img src="images/figures/home_page_mockup_3rd_edition.png" alt="images/figures/home_page_mockup_3rd_edition" /></div><div class="caption"><span class="header">図 5.1: </span><span class="description">サンプルアプリケーションのHomeページのモックアップ
</span></div></div>
<p>Gitでバージョン管理をしているのであれば、これまでと同様、この時点で新しいブランチを作成するのがよいでしょう。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> git checkout -b filling-in-layout
</pre></div></div>
<div id="sec-adding_to_the_layout" data-tralics-id="uid538" class="subsection" data-number="5.1.1"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-adding_to_the_layout" class="heading hyperref"><span class="number">5.1.1 </span>ナビゲーション</a></h3>
<p>第一段階として、サンプルアプリケーションにリンクとスタイルを追加するために、サイトのレイアウトファイル<code>application.html.erb</code> (<a href="/chapters/rails_flavored_ruby?version=5.1#code-application_layout_full_title" class="hyperref">リスト <span class="ref">4.3</span></a>) にHTML構造を追加し、レイアウトファイルを更新します。この更新には、領域 (divタグ) の追加、CSSクラスの追加、サイトナビゲーションの起点となる領域の追加も含まれます。完全なファイルを<a href="/chapters/filling_in_the_layout?version=5.1#code-layout_new_structure" class="hyperref">リスト <span class="ref">5.1</span></a>に示します。続いて、これを構成している多くの部品について解説します。表示結果を今すぐ確認したいのであれば、<a href="/chapters/filling_in_the_layout?version=5.1#fig-layout_no_logo_or_custom_css" class="hyperref">図 <span class="ref">5.2</span></a>で確認できます (<em>注:</em>この時点ではわざわざ見に行くほどの仕上がりではありませんが)。</p>
<div class="codelisting" id="code-layout_new_structure" data-tralics-id="uid539" data-number="5.1"><div class="heading"><span class="number">リスト 5.1:</span> 

<span class="description">構造を追加したWebサイトのレイアウト <span class="break"></span> <span class="filepath">app/views/layouts/application.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="n">full_title</span><span class="p">(</span><span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">))</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">csrf_meta_tags</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span>    <span class="s1">'application'</span><span class="p">,</span> <span class="ss">media</span><span class="p">:</span> <span class="s1">'all'</span><span class="p">,</span>
                               <span class="s1">'data-turbolinks-track'</span><span class="p">:</span> <span class="s1">'reload'</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s1">'application'</span><span class="p">,</span>
                               <span class="s1">'data-turbolinks-track'</span><span class="p">:</span> <span class="s1">'reload'</span> <span class="cp">%&gt;</span>
    <span class="c">&lt;!--[if lt IE 9]&gt;</span>
<span class="c">      &lt;script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js"&gt;</span>
<span class="c">      &lt;/script&gt;</span>
<span class="c">    &lt;![endif]--&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"navbar navbar-fixed-top navbar-inverse"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"sample app"</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">"logo"</span> <span class="cp">%&gt;</span>
        <span class="nt">&lt;nav&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Home"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Help"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Log in"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
          <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/nav&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/header&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div></div></div><p>それでは、<a href="/chapters/filling_in_the_layout?version=5.1#code-layout_new_structure" class="hyperref">リスト <span class="ref">5.1</span></a>の新しい要素を上から順に見ていきましょう。<a href="/chapters/static_pages?version=5.1#sec-testing_titles" class="hyperref"><span class="ref">3.4.1</span></a>でも簡単に説明しましたが、RailsはデフォルトでHTML5を使います (<code>&lt;!DOCTYPE html&gt;</code>と書いてHTML5であることを宣言します)。ただHTML5は比較的新しく、一部のブラウザ (特に旧式のInternet Explorer) ではHTML5のサポートが不完全である場合があります。そのため、次のようなJavaScriptのコード (通称: <a href="https://github.com/aFarkas/html5shiv" target="_blank" rel="noopener">HTML5 shim (or shiv)</a>)<sup id="cha-5_footnote-ref-3" class="footnote"><a href="#cha-5_footnote-3">3</a></sup>を使ってこの問題を回避します。</p>
<div class="code"><div class="highlight"><pre><span class="c">&lt;!--[if lt IE 9]&gt;</span>
<span class="c">  &lt;script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js"&gt;</span>
<span class="c">  &lt;/script&gt;</span>
<span class="c">&lt;![endif]--&gt;</span>
</pre></div></div>
<p class="noindent">上のコードには、次のような奇妙な構文が含まれています。</p>
<div class="code"><div class="highlight"><pre><span class="c">&lt;!--[if lt IE 9]&gt;</span>
</pre></div></div>
<p class="noindent">これは、Microsoft Internet Explorer (IE) のバージョンが9より小さい場合 (<code>if lt IE 9</code>) にのみ、囲まれている行を実行します。この風変わりな文法<code> [if lt IE 9]</code> は、Railsの一部<em>ではありません</em>。これは実は、<a href="https://ja.wikipedia.org/wiki/%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E3%82%B3%E3%83%A1%E3%83%B3%E3%83%88" target="_blank" rel="noopener">条件付きコメント</a>と呼ばれるもので、今回のような状況のためにInternet Explorerで特別にサポートされています。これにより、Firefox、Chrome、Safariなどの他のブラウザに影響を与えずに、IEのバージョンが9未満の場合に<em>のみ</em>HTML5 shimを読み込めるため、非常に好都合です。</p>
<p>それに続くセクションには、サイトのロゴを表示する<code>header</code>、(<code>div</code>タグによる) いくつかの領域、ナビゲーションリンクのリストがあります。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"navbar navbar-fixed-top navbar-inverse"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"sample app"</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">"logo"</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;nav&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Home"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Help"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Log in"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/nav&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/header&gt;</span>
</pre></div></div>
<p class="noindent"><code>header</code>タグは、ページの上部に来るべき要素を表します。この<code>header</code>タグには、<code>navbar</code>、<code>navbar-fixed-top</code>、<code>navbar-inverse</code>という３つの<em>CSSクラス</em>がスペース区切りで与えられています<sup id="cha-5_footnote-ref-4" class="footnote"><a href="#cha-5_footnote-4">4</a></sup>。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"navbar navbar-fixed-top navbar-inverse"</span><span class="nt">&gt;</span>
</pre></div></div>
<p class="noindent">すべてのHTML要素には、クラスと<em>id</em>の両方を指定することができます。これらは単なるラベルで、CSSでスタイルを指定するときに便利です (<a href="/chapters/filling_in_the_layout?version=5.1#sec-custom_css" class="hyperref"><span class="ref">5.1.2</span></a>)。クラスとidの主な違いは、クラスはページ内で何度でも使えるのに対し、idは一度しか使えない点です。今回の場合、すべてのnavbarクラスには、<a href="/chapters/filling_in_the_layout?version=5.1#sec-custom_css" class="hyperref"><span class="ref">5.1.2</span></a>でインストールするBootstrapフレームワークによって特別な意味が与えられます。</p>
<p><code>header</code>タグの内側には2つの<code>div</code>タグがあります。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
</pre></div></div>
<p class="noindent"><code>div</code>タグは一般的な表示領域を表し、要素を別々のパーツに分けるときに使われます。特に古いスタイルのHTMLでは、<code>div</code>タグはサイト内のほぼすべての領域で使われていました。しかしHTML5からはよく使われる領域ごとに細分化できるようになり、具体的には<code>header</code>要素、<code>nav</code>要素、<code>section</code>要素が新たに使えるようになりました。なお、<code>header</code>タグのクラスと同様に、<code>div</code>タグにもCSSクラス (<code>container</code>) が与えていますが、このクラスもBootstrapにおいて特別な意味を持っています。</p>
<p>divに続いて、埋め込みRubyコードが出現します。</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"sample app"</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">"logo"</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;nav&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Home"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Help"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Log in"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</pre></div></div>
<p class="noindent">ここでは、リンクを生成するために、Railsヘルパーの<code>link_to</code>を使います (<a href="/chapters/static_pages?version=5.1#sec-custom_static_pages" class="hyperref"><span class="ref">3.2.2</span></a>で見たアンカータグ<code>a</code>が最終的に生成されます)。<code>link_to</code>の第1引数はリンクテキスト、第2引数はURLです。このURLは<a href="/chapters/filling_in_the_layout?version=5.1#sec-named_routes" class="hyperref"><span class="ref">5.3.3</span></a>で<em>名前付きルート (Named Routes)</em> に置き換えますが、今はWebデザインで一般に使われるスタブ用の (とりあえずのダミーとして使われる) URL「<code>’#’</code>」を置いておきます。第3引数はオプションハッシュで、この場合はサンプルアプリのリンクでCSS id <code>logo</code>を指定しています(他の3つのリンクにはオプションハッシュが指定されていませんが、必須ではないので構いません)。Railsヘルパーは、このようにオプションのハッシュを取ることがよくあり、これによりRailsのコードから離れることなく任意のHTMLオプションを柔軟に追加することができます。</p>
<p>divの内側の2番目の要素は、<em>リストアイテム</em>タグ<code>li</code>と<em>順不同リスト</em>タグ<code>ul</code>によって作られた、ナビゲーションリンクのリストです。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;nav&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Home"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Help"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Log in"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</pre></div></div>
<p class="noindent">正確にはここでは不要なのですが、<code>nav</code>タグには「その内側がナビゲーションリンクである」という意図を明示的に伝える役割があります。さらに、<code>ul</code>タグに付与されている<code>nav</code>や<code>navbar-nav</code>、<code>navbar-right</code>クラスもBootstrapにおいて特別な意味を持ちます。したがって、<a href="/chapters/filling_in_the_layout?version=5.1#sec-custom_css" class="hyperref"><span class="ref">5.1.2</span></a>でBootstrapのCSSを追加したときに、これらのスタイルも自動的に適用されます。ブラウザからソースを見ることで確認ができますが、Railsが埋め込みRubyを評価し、レイアウトを描画すると、上のリストは次のように置き換わります<sup id="cha-5_footnote-ref-5" class="footnote"><a href="#cha-5_footnote-5">5</a></sup>。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;nav&gt;</span>
  <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Home<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Help<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"#"</span><span class="nt">&gt;</span>Log in<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
  <span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/nav&gt;</span>
</pre></div></div>
<p class="noindent">これがブラウザに返されるHTMLになります。</p>
<p>レイアウトの最後の部分は、メインコンテンツ用の<code>div</code>です。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
  <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div></div>
<p class="noindent">上と同様、<code>container</code>クラスもBootstrapにおいて特別な意味を持ちます。<a href="/chapters/static_pages?version=5.1#sec-layouts_and_embedded_ruby" class="hyperref"><span class="ref">3.4.3</span></a>で学んだように、<code>yield</code>メソッドはWebサイトのレイアウトにページごとの内容を挿入します。</p>
<p><a href="/chapters/filling_in_the_layout?version=5.1#sec-partials" class="hyperref"><span class="ref">5.1.3</span></a>で追加するサイトフッターを除いて、これでレイアウトは完成しました。Homeページへアクセスして表示結果を確認することができます。今後のスタイル要素を利用するために、<code>home.html.erb</code>ビューに特別な要素をいくつか追加します (<a href="/chapters/filling_in_the_layout?version=5.1#code-signup_button" class="hyperref">リスト <span class="ref">5.2</span></a>)。</p>
<div class="codelisting" id="code-signup_button" data-tralics-id="uid543" data-number="5.2"><div class="heading"><span class="number">リスト 5.2:</span> 

<span class="description">サインアップページへのリンクがあるHomeページ <span class="break"></span> <span class="filepath">app/views/static_pages/home.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"center jumbotron"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Welcome to the Sample App<span class="nt">&lt;/h1&gt;</span>

  <span class="nt">&lt;h2&gt;</span>
    This is the home page for the
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://railstutorial.jp/"</span><span class="nt">&gt;</span>Ruby on Rails Tutorial<span class="nt">&lt;/a&gt;</span>
    sample application.
  <span class="nt">&lt;/h2&gt;</span>

  <span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Sign up now!"</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"btn btn-lg btn-primary"</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="n">image_tag</span><span class="p">(</span><span class="s2">"rails.png"</span><span class="p">,</span> <span class="ss">alt</span><span class="p">:</span> <span class="s2">"Rails logo"</span><span class="p">),</span>
            <span class="s1">'http://rubyonrails.org/'</span> <span class="cp">%&gt;</span>
</pre></div></div></div><p class="noindent"><a href="/chapters/sign_up?version=5.1#cha-sign_up" class="hyperref">第<span class="ref">7</span>章</a>でサイトにユーザーを追加するときに備えて、最初の<code>link_to</code>で次のような仮のリンクを生成します。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="na">class=</span><span class="s">"btn btn-lg btn-primary"</span><span class="nt">&gt;</span>Sign up now!<span class="nt">&lt;/a&gt;</span>
</pre></div></div>
<p class="noindent">上で挙げた<code>div</code>タグのCSSクラス<code>jumbotron</code>や、signupボタンの<code>btn</code>クラス、<code>btn-lg</code>クラス、<code>btn-primary</code>クラスはすべて、Bootstrapにおいて特別な意味を持ちます。</p>
<p>2番目の<code>link_to</code>では、引数として画像ファイルのパスと任意のオプションハッシュをとる<code>image_tag</code>ヘルパーの能力が示されています。このヘルパーでは、シンボルを使って<code>alt</code>属性などを設定できます。一方で画像を表示するためには、<code>rails.png</code>というRailsのロゴ画像ファイルを加える必要があります。Ruby on Rails公式ページの <a href="https://railstutorial.jp/rails.png" target="_blank" rel="noopener">https://railstutorial.jp/rails.png</a> から画像をダウンロードして、<code>app/assets/images/</code>ディレクトリにおいてください<sup id="cha-5_footnote-ref-6" class="footnote"><a href="#cha-5_footnote-6">6</a></sup>。クラウドIDEやUnix系のOS (Max OS Xなど) を使っている場合は、次のように<code>curl</code>コマンドで簡単に取得することができます (<a href="/chapters/filling_in_the_layout?version=5.1#code-curl_rails_png" class="hyperref">リスト <span class="ref">5.3</span></a>)。(<code>curl</code>コマンドの詳細については<a href="https://www.learnenough.com/command-line-tutorial#sec-downloading_a_file" target="_blank" rel="noopener">Command Line Tutorial</a> (英語) をご覧ください)</p>
<div class="codelisting" id="code-curl_rails_png" data-tralics-id="uid545" data-number="5.3"><div class="heading"><span class="number">リスト 5.3:</span> 

<span class="description">画像をダウンロードする</span>
</div>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> curl -o app/assets/images/rails.png -OL railstutorial.jp/rails.png
</pre></div></div></div><p class="noindent"><a href="/chapters/filling_in_the_layout?version=5.1#code-signup_button" class="hyperref">リスト <span class="ref">5.2</span></a>で <code>image_tag</code>ヘルパーを使っているので、Railsは該当する画像ファイルを、アセットパイプラインを通して<code>app/assets/images/</code>ディレクトリの中から探してくれます (アセットパイプラインについては<a href="/chapters/filling_in_the_layout?version=5.1#sec-sass_and_the_asset_pipeline" class="hyperref"><span class="ref">5.2</span></a>で説明します)。</p>
<p>さて、これで準備は完了です。環境によっては、ここで一度Railsサーバーを再起動する必要がある場合もあるので、必要に応じて (<a href="/chapters/beginning?version=5.1#aside-technical_sophistication" class="hyperref">コラム <span class="ref">1.1</span></a>) 再起動を試してみてください。うまく行くと、次の<a href="/chapters/filling_in_the_layout?version=5.1#fig-layout_no_logo_or_custom_css" class="hyperref">図 <span class="ref">5.2</span></a>のような結果になるはずです。</p>
<div class="center figure" id="fig-layout_no_logo_or_custom_css" data-tralics-id="uid546" data-number="5.2">
<div class="graphics image"><img src="images/figures/layout_no_logo_or_custom_css_bootstrap_3rd_edition.png" alt="images/figures/layout_no_logo_or_custom_css_bootstrap_3rd_edition" /></div><div class="caption"><span class="header">図 5.2: </span><span class="description">カスタムCSSを使っていないHomeページ 
</span></div></div>
<p><code>image_tag</code>の効果を確かめるために、ブラウザから生成されたHTMLを見てみましょう<sup id="cha-5_footnote-ref-7" class="footnote"><a href="#cha-5_footnote-7">7</a></sup>。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;img</span> <span class="na">alt=</span><span class="s">"Rails logo"</span> <span class="na">src=</span><span class="s">"/assets/rails-9308b8f92fea4c19a3a0d8385b494526.png"</span> <span class="nt">/&gt;</span>
</pre></div></div>
<p class="noindent">ファイル名が重ならないようにするために、<code>9308b8f92fea4c19a3a0d8385b494526</code>という文字列 (実際の文字列はシステムごとに異なります) をRailsが追加していることがわかります。これは、例えば画像ファイルを新しい画像に更新したときに、ブラウザ内に保存されたキャッシュに意図的にヒットさせないようにするための仕組みです。また、<code>src</code>属性には "<code>images</code>" というディレクトリ名が<em>含まれていない</em>ことにも注目してください。これは<code>assets</code>ディレクトリ内の他のディレクトリ (imagesやjavascripts、stylesheetsなど) も同様です。これは高速化のための仕組みで、Railsは<code>assets</code>ディレクトリ直下の画像を<code>app/assets/images</code>ディレクトリにある画像と紐付けています。これにより、ブラウザから見るとすべてのファイルが同じディレクトリにあるように見えるようになります。そして、このようなフラットなディレクトリ構成を採っていると、ファイルをより高速にブラウザに渡すことができるようになります。最後に、<code>alt</code>属性は、画像がない場合に代わりに表示される文字列です。例えば視覚障害のあるユーザーが使うスクリーンリーダーでは、ここの属性が読み上げられて、そこに画像があることが示されます。</p>
<p>いよいよ、ここまでの苦労の成果を確認する準備ができました (<a href="/chapters/filling_in_the_layout?version=5.1#fig-layout_no_logo_or_custom_css" class="hyperref">図 <span class="ref">5.2</span></a>)。思っていたよりもみすぼらしいでしょうか。そうかもしれません。しかし、今回HTML要素に理にかなったクラスを付与したおかげで、CSSを使ってスタイルが追加できる素晴らしい状況になりました。</p>
<div id="sec-exercises_adding_to_the_layout" data-tralics-id="uid548" class="subsubsection" data-number="5.1.1.1"><h4><a href="#sec-exercises_adding_to_the_layout" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li>Webページと言ったらネコ画像、というぐらいにはWebにはネコ画像が溢れていますよね。<a href="/chapters/filling_in_the_layout?version=5.1#code-downloading_a_cat_pic" class="hyperref">リスト <span class="ref">5.4</span></a>のコマンドを使って、<a href="/chapters/filling_in_the_layout?version=5.1#fig-kitten" class="hyperref">図 <span class="ref">5.3</span></a>のネコ画像をダウンロードしてきましょう<sup id="cha-5_footnote-ref-8" class="footnote"><a href="#cha-5_footnote-8">8</a></sup>。 <span class="exercise" id="ex-7a67af"></span>
</li>
<li><code>mv</code>コマンドを使って、ダウンロードした<code>kitten.jpg</code>ファイルを適切なアセットディレクトリに移動してください (参考: <a href="/chapters/filling_in_the_layout?version=5.1#sec-the_asset_pipeline" class="hyperref"><span class="ref">5.2.1</span></a>)。 <span class="exercise" id="ex-66f85b"></span>
</li>
<li><code>image_tag</code>を使って、<code>kitten.jpg</code>画像を表示してみてください (<a href="/chapters/filling_in_the_layout?version=5.1#fig-kitten_on_home" class="hyperref">図 <span class="ref">5.4</span></a>)。 <span class="exercise" id="ex-591749"></span>
</li></ol>
<div class="center figure" id="fig-kitten" data-tralics-id="uid553" data-number="5.3">
<div class="graphics image"><img src="images/figures/kitten.jpg" alt="images/figures/kitten" /></div><div class="caption"><span class="header">図 5.3: </span><span class="description">Webで必須 (?)<span class="intersentencespace"></span> の子ネコ画像 
</span></div></div>
<div class="codelisting" id="code-downloading_a_cat_pic" data-tralics-id="uid554" data-number="5.4"><div class="heading"><span class="number">リスト 5.4:</span> 

<span class="description">ネコ画像をインターネットからダウンロードする</span>
</div>

<div class="code"><div class="highlight"><pre><span class="gp">$</span> curl -OL cdn.learnenough.com/kitten.jpg
</pre></div></div></div><div class="center figure" id="fig-kitten_on_home" data-tralics-id="uid555" data-number="5.4">
<div class="graphics image"><img src="images/figures/kitten_on_home.png" alt="images/figures/kitten_on_home" /></div><div class="caption"><span class="header">図 5.4: </span><span class="description">子ネコ画像をHomeページに表示させた結果 
</span></div></div>
</div></div>
<div id="sec-custom_css" data-tralics-id="uid556" class="subsection" data-number="5.1.2"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-custom_css" class="heading hyperref"><span class="number">5.1.2 </span>BootstrapとカスタムCSS</a></h3>
<p><a href="/chapters/filling_in_the_layout?version=5.1#sec-adding_to_the_layout" class="hyperref"><span class="ref">5.1.1</span></a>では、多くのHTML要素にCSSクラスを関連付けました。こうしておくことで、CSSベースでレイアウトを構成する際に高い柔軟性を与えてくれます。<a href="/chapters/filling_in_the_layout?version=5.1#sec-adding_to_the_layout" class="hyperref"><span class="ref">5.1.1</span></a>で述べたように、これらのクラスの多くは、Twitterが作成したフレームワークである<a href="http://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a>特有のものです。Bootstrapを使うと、洗練されたWebデザインとユーザーインターフェイス要素を簡単にHTML5アプリケーションに追加することができます。この節では、サンプルアプリケーションにスタイルを追加するために、カスタムCSSルールとBootstrapを組み合わせて使います。注目すべき点は、Bootstrapを使うことでアプリケーションを<a href="https://ja.wikipedia.org/wiki/%E3%83%AC%E3%82%B9%E3%83%9D%E3%83%B3%E3%82%B7%E3%83%96%E3%82%A6%E3%82%A7%E3%83%96%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3" target="_blank" rel="noopener"><em>レスポンシブデザイン (Responsive Design)</em></a> にできるということです。これにより、どの端末でアプリケーションを閲覧しても、ある程度見栄えをよくすることができます。</p>
<p>最初に、<a href="/chapters/filling_in_the_layout?version=5.1#code-bootstrap_sass" class="hyperref">リスト <span class="ref">5.5</span></a>で示しているようにBootstrapを追加しましょう。これは、<code class="tt">bootstrap-sass</code> gemを使ってRailsアプリケーションに導入できます<sup id="cha-5_footnote-ref-9" class="footnote"><a href="#cha-5_footnote-9">9</a></sup>。Bootstrapフレームワークでは、動的なスタイルシートを生成するために<a href="http://lesscss.org/" target="_blank" rel="noopener">LESS CSS</a>言語を使っていますが、RailsのAsset Pipelineはデフォルトでは (LESSと非常によく似た) Sass言語をサポートします (<a href="/chapters/filling_in_the_layout?version=5.1#sec-sass_and_the_asset_pipeline" class="hyperref"><span class="ref">5.2</span></a>)。そのため、<code class="tt">bootstrap-sass</code>は、LESSをSassへ変換し、必要なBootstrapファイルを現在のアプリケーションですべて利用できるようにします<sup id="cha-5_footnote-ref-10" class="footnote"><a href="#cha-5_footnote-10">10</a></sup>。</p>
<div class="codelisting" id="code-bootstrap_sass" data-tralics-id="uid559" data-number="5.5"><div class="heading"><span class="number">リスト 5.5:</span> 

<span class="description"><code>Gemfile</code>に<code class="tt">bootstrap-sass</code>を追加する</span>
</div>

<div class="code"><div class="highlight"><pre><span class="n">source</span> <span class="s1">'https://rubygems.org'</span>

<span class="n">gem</span> <span class="s1">'rails'</span><span class="p">,</span>          <span class="s1">'5.1.4'</span>
<span class="n">gem</span> <span class="s1">'bootstrap-sass'</span><span class="p">,</span> <span class="s1">'3.3.7'</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
</pre></div></div></div><p class="noindent">いつものように<code>bundle install</code>を実行して、Bootstrapをインストールします。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> bundle install
</pre></div></div>
<p>ちなみに、<code>rails generate</code>コマンドを実行することでコントローラーごとに分けられたCSSファイルが自動的に生成されますが、これらのファイルを正しい順序で読み込ませるのは至難の技なので、本チュートリアルでは (簡潔のために) すべてのCSSを1つにまとめる方針を採っています。カスタムCSSを動かすための最初の一歩は、カスタムCSSファイルを作ることです。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> touch app/assets/stylesheets/custom.scss
</pre></div></div>
<p class="noindent">(ここでは<a href="/chapters/static_pages?version=5.1#sec-green" class="hyperref"><span class="ref">3.3.3</span></a> の途中で紹介した <code>touch</code> コマンドを使っていますが、ファイルが作成できるなら [新規ファイル作成] や他のコマンドでも問題ありません。) このディレクトリ名とファイル名は、どちらも重要です。次のディレクトリは、</p>
<div class="code"><div class="highlight"><pre><span class="go">app/assets/stylesheets/</span>
</pre></div></div>
<p class="noindent">Asset Pipeline (<a href="/chapters/filling_in_the_layout?version=5.1#sec-sass_and_the_asset_pipeline" class="hyperref"><span class="ref">5.2</span></a>)の一部であり、このディレクトリに置かれたスタイルシートは<code>application.css</code>の一部としてWebサイトのレイアウトに読み込まれます。さらに、ファイル名の<code>custom.scss</code>には<code>.scss</code>という拡張子も含まれています。この拡張子は「Sass (Sassy CSS)」と呼ばれるCSSを拡張した言語で、アセットパイプラインはこのファイルの拡張子を見て、Sassを処理できるようにしています (Sassは<a href="/chapters/filling_in_the_layout?version=5.1#sec-sass" class="hyperref"><span class="ref">5.2.2</span></a>まで登場しませんが、<code class="tt">bootstrap-sass</code> gemが動作するためのおまじないとして必要です)。</p>
<p>カスタムCSS用のファイルを作成したら、<a href="/chapters/filling_in_the_layout?version=5.1#code-bootstrap_css" class="hyperref">リスト <span class="ref">5.6</span></a>のように<code>@import</code>を使って、Bootstrap (とそれに関連するSprockets) を読み込みます<sup id="cha-5_footnote-ref-11" class="footnote"><a href="#cha-5_footnote-11">11</a></sup>。</p>
<div class="codelisting" id="code-bootstrap_css" data-tralics-id="uid561" data-number="5.6"><div class="heading"><span class="number">リスト 5.6:</span> 

<span class="description">Bootstrap CSSを追加する <span class="break"></span> <span class="filepath">app/assets/stylesheets/custom.scss</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">@import</span> <span class="s2">"bootstrap-sprockets"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>
</pre></div></div></div><p class="noindent"><a href="/chapters/filling_in_the_layout?version=5.1#code-bootstrap_css" class="hyperref">リスト <span class="ref">5.6</span></a>の2行では、Bootstrap CSSのフレームワークを導入しています。導入後、Webサーバを再起動させると、アプリケーションに反映させることができます。(<a href="/chapters/beginning?version=5.1#sec-rails_server" class="hyperref"><span class="ref">1.3.2</span></a>で紹介したように、Ctrl-Cを押してWebサーバを停止させた後、<code>rails server</code>コマンドを打ってWebサーバを起動してください)。うまくいけば<a href="/chapters/filling_in_the_layout?version=5.1#fig-sample_app_only_bootstrap" class="hyperref">図 <span class="ref">5.5</span></a>のような結果になります。さて、テキストの配置は今ひとつで、ロゴにはスタイルもありませんが、色使いとsignupボタンはなかなかよい感じになってきました。</p>
<div class="center figure" id="fig-sample_app_only_bootstrap" data-tralics-id="uid562" data-number="5.5">
<div class="graphics image"><img src="images/figures/sample_app_only_bootstrap_3rd_edition.png" alt="images/figures/sample_app_only_bootstrap_3rd_edition" /></div><div class="caption"><span class="header">図 5.5: </span><span class="description">Bootstrap CSSとサンプルアプリケーション 
</span></div></div>
<p>次に、<a href="/chapters/filling_in_the_layout?version=5.1#code-universal_css" class="hyperref">リスト <span class="ref">5.7</span></a>に示したように、Webサイト全体にわたってレイアウトと個別のページにスタイルを与えるためのCSSを追加します。テストの結果を<a href="/chapters/filling_in_the_layout?version=5.1#fig-sample_app_universal" class="hyperref">図 <span class="ref">5.6</span></a>に示します。<a href="/chapters/filling_in_the_layout?version=5.1#code-universal_css" class="hyperref">リスト <span class="ref">5.7</span></a>には多数の記述ルールがあります。CSSの記述ルールを把握するためには、関心のある箇所をコメントアウトして表示を確認することをお勧めします。CSSでは <code>/* … */</code> でコメントアウトできるので、調べてみたいコードをこれで囲い、表示がどのように変わるかを確認してみてください。</p>
<div class="codelisting" id="code-universal_css" data-tralics-id="uid563" data-number="5.7"><div class="heading"><span class="number">リスト 5.7:</span> 

<span class="description">すべてのページに適用される共通のスタイルをCSSに追加する <span class="break"></span> <span class="filepath">app/assets/stylesheets/custom.scss</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">@import</span> <span class="s2">"bootstrap-sprockets"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>

<span class="cm">/* universal */</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">60</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">section</span> <span class="p">{</span>
  <span class="na">overflow</span><span class="o">:</span> <span class="no">auto</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">textarea</span> <span class="p">{</span>
  <span class="na">resize</span><span class="o">:</span> <span class="n">vertical</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.center</span> <span class="p">{</span>
  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.center</span> <span class="nt">h1</span> <span class="p">{</span>
  <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div></div><div class="center figure" id="fig-sample_app_universal" data-tralics-id="uid564" data-number="5.6">
<div class="graphics image"><img src="images/figures/sample_app_universal_3rd_edition.png" alt="images/figures/sample_app_universal_3rd_edition" /></div><div class="caption"><span class="header">図 5.6: </span><span class="description">スペースや共通スタイルを追加した結果
</span></div></div>
<p><a href="/chapters/filling_in_the_layout?version=5.1#code-universal_css" class="hyperref">リスト <span class="ref">5.7</span></a>のCSSの形式は一貫しています。CSSルールでは一般に、クラス、id、HTMLタグ、またはそれらの組み合わせ、のいずれかを指定します。そしてその後ろにスタイリングコマンドのリストを記述します。例えば次のコードでは、</p>
<div class="code"><div class="highlight"><pre><span class="nt">body</span> <span class="p">{</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">60</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
<p class="noindent">ページ上部に60ピクセルの余白を追加します。<code>header</code>タグに<code>navbar-fixed-top</code>クラスが与えられているので、これに従ってBootstrapはナビゲーションバーをページ上部に固定し、ナビゲーションバーの下に余白を置いて主要部分から分離します (デフォルトのnavbarの色がBootstrap 2.0から変更されたため、現在の淡色の代わりにダークな色調にしたい場合は<code>navbar-inverse</code>クラスを使う必要があります)。また、このルールにある次のCSSは、</p>
<div class="code"><div class="highlight"><pre><span class="nc">.center</span> <span class="p">{</span>
  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
<p class="noindent"><code>center</code>クラスに<code>text-align: center</code>プロパティを関連付けています。言い換えると、<code>.center</code>冒頭のドット<code>.</code>は、このルールがクラスに対してスタイルを適用することを示しています。なお、<a href="/chapters/filling_in_the_layout?version=5.1#code-logo_css" class="hyperref">リスト <span class="ref">5.9</span></a>に示したように、冒頭がポンド記号<code>#</code>で始まる場合は、そのルールがCSSの<em>id</em>に対してスタイルを適用することを示します。今回の場合、<code>center</code>クラスに属している (<code>div</code>などの) タグの内側にある要素が、すべて中央揃えになることを意味しています (<a href="/chapters/filling_in_the_layout?version=5.1#code-signup_button" class="hyperref">リスト <span class="ref">5.2</span></a>が実際の使用例です)。</p>
<p>Bootstrapには洗練されたタイポグラフィーを利用できるCSSルールがありますが、ここではさらに、<a href="/chapters/filling_in_the_layout?version=5.1#code-typography_css" class="hyperref">リスト <span class="ref">5.8</span></a>のようにカスタムCSSルールを追加し、テキストの見栄えを変えてみましょう。なお、今回追加するルールはHomeページのすべてで適用されるとは限りませんが、サンプルアプリケーションの他の場所でも使われます。<a href="/chapters/filling_in_the_layout?version=5.1#code-typography_css" class="hyperref">リスト <span class="ref">5.8</span></a>を反映した結果を、<a href="/chapters/filling_in_the_layout?version=5.1#fig-sample_app_typography" class="hyperref">図 <span class="ref">5.7</span></a>で確認することができます。</p>
<div class="codelisting" id="code-typography_css" data-tralics-id="uid565" data-number="5.8"><div class="heading"><span class="number">リスト 5.8:</span> 

<span class="description">洗練されたタイポグラフィーを利用するためのCSSを追加する <span class="break"></span> <span class="filepath">app/assets/stylesheets/custom.scss</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">@import</span> <span class="s2">"bootstrap-sprockets"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="o">/*</span> <span class="nt">typography</span> <span class="o">*/</span>

<span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span><span class="o">,</span> <span class="nt">h3</span><span class="o">,</span> <span class="nt">h4</span><span class="o">,</span> <span class="nt">h5</span><span class="o">,</span> <span class="nt">h6</span> <span class="p">{</span>
  <span class="na">line-height</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h1</span> <span class="p">{</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">3</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-2</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h2</span> <span class="p">{</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.2</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
  <span class="na">font-weight</span><span class="o">:</span> <span class="no">normal</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#777</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">p</span> <span class="p">{</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.1</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">line-height</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.7</span><span class="kt">em</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div></div><div class="center figure" id="fig-sample_app_typography" data-tralics-id="uid566" data-number="5.7">
<div class="graphics image"><img src="images/figures/sample_app_typography_3rd_edition.png" alt="images/figures/sample_app_typography_3rd_edition" /></div><div class="caption"><span class="header">図 5.7: </span><span class="description">タイポグラフィースタイルを追加する
</span></div></div>
<p>最後に、いくつかのルールをサイトロゴに追加します。このサイトロゴは「sample app」だけが表示されているシンプルなものです。<a href="/chapters/filling_in_the_layout?version=5.1#code-logo_css" class="hyperref">リスト <span class="ref">5.9</span></a>のCSSは、テキストを大文字に変換し、サイズ、色、配置を変更します (サイトロゴがページ内で一度しか使われないことを前提としてCSS idを使っていますが、代わりにクラスを使うこともできます)。</p>
<div class="codelisting" id="code-logo_css" data-tralics-id="uid567" data-number="5.9"><div class="heading"><span class="number">リスト 5.9:</span> 

<span class="description">サイトロゴにCSSを追加する <span class="break"></span> <span class="filepath">app/assets/stylesheets/custom.scss</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">@import</span> <span class="s2">"bootstrap-sprockets"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="o">/*</span> <span class="nt">header</span> <span class="o">*/</span>

<span class="nn">#logo</span> <span class="p">{</span>
  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="na">margin-right</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.7</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#fff</span><span class="p">;</span>
  <span class="na">text-transform</span><span class="o">:</span> <span class="no">uppercase</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">9</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-weight</span><span class="o">:</span> <span class="no">bold</span><span class="p">;</span>
<span class="p">}</span>

<span class="nn">#logo</span><span class="nd">:hover</span> <span class="p">{</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#fff</span><span class="p">;</span>
  <span class="na">text-decoration</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div></div><p class="noindent">上のコードの<code>color: #fff</code>は、ロゴの色を白に変更します。HTMLの色は、16進数 (基数が16) の3つの数値の組み合わせで表現され、赤、緑、青の三原色に (この順序で) コード化することができます。本来は<code>#ffffff</code>と書いて3色すべてを最大にする必要がありますが、上のコードでは<code>#fff</code>という<code>#ffffff</code>の短縮形を使っています。ちなみにCSS標準では、<a href="https://www.w3schools.com/colors/colors_names.asp" target="_blank" rel="noopener">HTMLの色には別名</a>も多数定義されています。例えば先ほどの<code>#fff</code>は、<code>white</code>と書くこともできます。話を戻して、<a href="/chapters/filling_in_the_layout?version=5.1#code-logo_css" class="hyperref">リスト <span class="ref">5.9</span></a>のCSSが反映されると、<a href="/chapters/filling_in_the_layout?version=5.1#fig-sample_app_logo" class="hyperref">図 <span class="ref">5.8</span></a>のようになっていれば成功です。</p>
<div class="center figure" id="fig-sample_app_logo" data-tralics-id="uid568" data-number="5.8">
<div class="graphics image"><img src="images/figures/sample_app_logo_3rd_edition.png" alt="images/figures/sample_app_logo_3rd_edition" /></div><div class="caption"><span class="header">図 5.8: </span><span class="description">デザインされたロゴとサンプルアプリ
</span></div></div>
<div id="sec-exercises_custom_css" data-tralics-id="uid569" class="subsubsection" data-number="5.1.2.1"><h4><a href="#sec-exercises_custom_css" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li><a href="/chapters/filling_in_the_layout?version=5.1#code-comment_out_image" class="hyperref">リスト <span class="ref">5.10</span></a>を参考にして、<a href="/chapters/filling_in_the_layout?version=5.1#sec-exercises_adding_to_the_layout" class="hyperref"><span class="ref">5.1.1.1</span></a>で使ったネコ画像をコメントアウトしてみてください。また、ブラウザのHTMLインスペクタ機能を使って、コメントアウトするとHTMLのソースからも消えていることを確認してみてください。 <span class="exercise" id="ex-d7f8e1"></span>
</li>
<li><a href="/chapters/filling_in_the_layout?version=5.1#code-css_hide_image" class="hyperref">リスト <span class="ref">5.11</span></a>のコードを<code>custom.scss</code>に追加し、すべての画像を非表示にしてみてください。うまくいけば、Railsのロゴ画像がHomeページから消えるはずです。先ほどと同様にインスペクタ機能を使って、今度はHTMLのソースコードは残ったままで、画像だけが表示されなくなっていることを確認してみてください。 <span class="exercise" id="ex-b39c95"></span>
</li></ol>
<div class="codelisting" id="code-comment_out_image" data-tralics-id="uid572" data-number="5.10"><div class="heading"><span class="number">リスト 5.10:</span> 

<span class="description">埋め込みRubyのコードをコメントアウトする</span>
</div>

<div class="code"><div class="highlight"><pre><span class="o">&lt;%</span><span class="c1">#= image_tag("kitten.jpg", alt: "Kitten") %&gt;</span>
</pre></div></div></div><div class="codelisting" id="code-css_hide_image" data-tralics-id="uid573" data-number="5.11"><div class="heading"><span class="number">リスト 5.11:</span> 

<span class="description">すべての画像を非表示にするCSS</span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">img</span> <span class="p">{</span>
  <span class="k">display</span><span class="o">:</span> <span class="k">none</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div></div></div></div>
<div id="sec-partials" data-tralics-id="uid574" class="subsection" data-number="5.1.3"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-partials" class="heading hyperref"><span class="number">5.1.3 </span>パーシャル (partial)</a></h3>
<p><a href="/chapters/filling_in_the_layout?version=5.1#code-layout_new_structure" class="hyperref">リスト <span class="ref">5.1</span></a>のレイアウトはその目的を果たしていますが、少々散らかっています。HTML shimは、それだけで3行も占有し、風変わりなIE特有の文法を使っているので、これをうまく隠すことができたらどんなによいでしょう。また、HTMLヘッダーは論理的な単位を形成するため、一箇所にまとめる必要もあります。Railsでは、<em>パーシャル (partial)</em> と呼ばれる機能を使ってこれを実現できます。最初に、パーシャルを定義するとレイアウトがどのように変わるかを見てみましょう (<a href="/chapters/filling_in_the_layout?version=5.1#code-layout_with_partials" class="hyperref">リスト <span class="ref">5.12</span></a>)。</p>
<div class="codelisting" id="code-layout_with_partials" data-tralics-id="uid575" data-number="5.12"><div class="heading"><span class="number">リスト 5.12:</span> 

<span class="description">レイアウトにshimとheaderのパーシャルを追加する <span class="break"></span> <span class="filepath">app/views/layouts/application.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="n">full_title</span><span class="p">(</span><span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">))</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">csrf_meta_tags</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span>    <span class="s1">'application'</span><span class="p">,</span> <span class="ss">media</span><span class="p">:</span> <span class="s1">'all'</span><span class="p">,</span>
                               <span class="s1">'data-turbolinks-track'</span><span class="p">:</span> <span class="s1">'reload'</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s1">'application'</span><span class="p">,</span>
                               <span class="s1">'data-turbolinks-track'</span><span class="p">:</span> <span class="s1">'reload'</span> <span class="cp">%&gt;</span>
<span class="hll">    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/shim'</span> <span class="cp">%&gt;</span>
</span>  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
<span class="hll">    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/header'</span> <span class="cp">%&gt;</span>
</span>    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div></div></div><p><a href="/chapters/filling_in_the_layout?version=5.1#code-layout_with_partials" class="hyperref">リスト <span class="ref">5.12</span></a>では、次のように<code>render</code>と呼ばれるRailsヘルパー呼び出しだけを使って、HTML shimのスタイルシート行を置換しています。</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/shim'</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p class="noindent">この行では、<code>app/views/layouts/_shim.html.erb</code>というファイルを探してその内容を評価し、結果をビューに挿入しています<sup id="cha-5_footnote-ref-12" class="footnote"><a href="#cha-5_footnote-12">12</a></sup> (<span class="inline_verbatim">&lt;%= ... %&gt;</span> は、テンプレート内でRubyの式を評価するための埋め込みRuby記法であることを思い出してください。評価した結果がテンプレートに挿入されます)。ファイル名 <code>_shim.html.erb</code> の先頭にあるアンダースコアに注目してください。このアンダースコアは、パーシャルで使う普遍的な命名規約であり、また、一目見ただけでディレクトリ中のすべてのパーシャルを識別することが可能になります。</p>
<p>もちろん、パーシャルが動作するためには、それに対応するファイルとコンテンツを記述しなければなりません。このshimパーシャルの場合は、<a href="/chapters/filling_in_the_layout?version=5.1#code-layout_new_structure" class="hyperref">リスト <span class="ref">5.1</span></a>のわずか3行のshimコードだけです。作成したコードを<a href="/chapters/filling_in_the_layout?version=5.1#code-stylesheets_partial" class="hyperref">リスト <span class="ref">5.13</span></a>に示します。</p>
<div class="codelisting" id="code-stylesheets_partial" data-tralics-id="uid577" data-number="5.13"><div class="heading"><span class="number">リスト 5.13:</span> 

<span class="description">HTML shim用のパーシャル <span class="break"></span> <span class="filepath">app/views/layouts/_shim.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="c">&lt;!--[if lt IE 9]&gt;</span>
<span class="c">  &lt;script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js"&gt;</span>
<span class="c">  &lt;/script&gt;</span>
<span class="c">&lt;![endif]--&gt;</span>
</pre></div></div></div><p>同様に、ヘッダーの情報も<a href="/chapters/filling_in_the_layout?version=5.1#code-header_partial" class="hyperref">リスト <span class="ref">5.14</span></a>のパーシャルに移動し、<code>render</code>を呼び出してレイアウトに挿入することができます。(パーシャルでは、自動生成せずに、テキストエディタを使って手動で作成するのが一般的です。)</p>
<div class="codelisting" id="code-header_partial" data-tralics-id="uid578" data-number="5.14"><div class="heading"><span class="number">リスト 5.14:</span> 

<span class="description">header用のパーシャル <span class="break"></span> <span class="filepath">app/views/layouts/_header.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"navbar navbar-fixed-top navbar-inverse"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"sample app"</span><span class="p">,</span> <span class="s1">'#'</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">"logo"</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;nav&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Home"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Help"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Log in"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/nav&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/header&gt;</span>
</pre></div></div></div><p>これでパーシャルの作成方法がわかりましたので、今度はヘッダーに対応するフッタを同じ方法で追加しましょう。ここまでくれば、ファイル名は <code>_footer.html.erb</code> で、layoutsディレクトリ (<a href="/chapters/filling_in_the_layout?version=5.1#code-footer_partial" class="hyperref">リスト <span class="ref">5.15</span></a>) に置けばよいということが分かると思います<sup id="cha-5_footnote-ref-13" class="footnote"><a href="#cha-5_footnote-13">13</a></sup>。</p>
<div class="codelisting" id="code-footer_partial" data-tralics-id="uid580" data-number="5.15"><div class="heading"><span class="number">リスト 5.15:</span> 

<span class="description">footer用のパーシャル <span class="break"></span> <span class="filepath">app/views/layouts/_footer.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;footer</span> <span class="na">class=</span><span class="s">"footer"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;small&gt;</span>
    The <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://railstutorial.jp/"</span><span class="nt">&gt;</span>Ruby on Rails Tutorial<span class="nt">&lt;/a&gt;</span>
    by <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://www.michaelhartl.com/"</span><span class="nt">&gt;</span>Michael Hartl<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/small&gt;</span>
  <span class="nt">&lt;nav&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
      <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"About"</span><span class="p">,</span>   <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Contact"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://news.railstutorial.org/"</span><span class="nt">&gt;</span>News<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/nav&gt;</span>
<span class="nt">&lt;/footer&gt;</span>
</pre></div></div></div><p class="noindent">ヘッダーの場合と同様に、フッターの中でも<code>link_to</code>メソッドを使って、AboutページとContactページへの内部リンクを追加してあります。ひとまず、リンク先のURLは<code>’#’</code>としておきます (<code>header</code>タグと同様、<code>footer</code>タグもHTML5で新たに追加された要素です)。</p>
<p>footerパーシャルは、スタイルシートやheaderパーシャルのときと同じ方法でレイアウト中に追加できます (<a href="/chapters/filling_in_the_layout?version=5.1#code-layout_with_footer" class="hyperref">リスト <span class="ref">5.16</span></a>)。</p>
<div class="codelisting" id="code-layout_with_footer" data-tralics-id="uid581" data-number="5.16"><div class="heading"><span class="number">リスト 5.16:</span> 

<span class="description">レイアウトにfooterパーシャルを追加する <span class="break"></span> <span class="filepath">app/views/layouts/application.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="n">full_title</span><span class="p">(</span><span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">))</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">csrf_meta_tags</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">stylesheet_link_tag</span>    <span class="s1">'application'</span><span class="p">,</span> <span class="ss">media</span><span class="p">:</span> <span class="s1">'all'</span><span class="p">,</span>
                               <span class="s1">'data-turbolinks-track'</span><span class="p">:</span> <span class="s1">'reload'</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">javascript_include_tag</span> <span class="s1">'application'</span><span class="p">,</span>
                               <span class="s1">'data-turbolinks-track'</span><span class="p">:</span> <span class="s1">'reload'</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/shim'</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/header'</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
<span class="hll">      <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/footer'</span> <span class="cp">%&gt;</span>
</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div></div></div><p>そのまま実際にfooterを表示してみるとどうにも見苦しいので、<a href="/chapters/filling_in_the_layout?version=5.1#code-footer_css" class="hyperref">リスト <span class="ref">5.17</span></a>でスタイルを若干追加しましょう。スタイルを追加した結果を<a href="/chapters/filling_in_the_layout?version=5.1#fig-site_with_footer" class="hyperref">図 <span class="ref">5.9</span></a>に示します。</p>
<div class="codelisting" id="code-footer_css" data-tralics-id="uid582" data-number="5.17"><div class="heading"><span class="number">リスト 5.17:</span> 

<span class="description">サイトにfooter用CSSを追加する <span class="break"></span> <span class="filepath">app/assets/stylesheets/custom.scss</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="o">/*</span> <span class="nt">footer</span> <span class="o">*/</span>

<span class="nt">footer</span> <span class="p">{</span>
  <span class="na">margin-top</span><span class="o">:</span> <span class="mi">45</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">border-top</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#eaeaea</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#777</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">footer</span> <span class="nt">a</span> <span class="p">{</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#555</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">footer</span> <span class="nt">a</span><span class="nd">:hover</span> <span class="p">{</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#222</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">footer</span> <span class="nt">small</span> <span class="p">{</span>
  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">footer</span> <span class="nt">ul</span> <span class="p">{</span>
  <span class="na">float</span><span class="o">:</span> <span class="no">right</span><span class="p">;</span>
  <span class="na">list-style</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">footer</span> <span class="nt">ul</span> <span class="nt">li</span> <span class="p">{</span>
  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="na">margin-left</span><span class="o">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div></div><div class="center figure" id="fig-site_with_footer" data-tralics-id="uid583" data-number="5.9">
<div class="graphics image"><img src="images/figures/site_with_footer_bootstrap_3rd_edition.png" alt="images/figures/site_with_footer_bootstrap_3rd_edition" /></div><div class="caption"><span class="header">図 5.9: </span><span class="description">Homeページにfooterを追加する
</span></div></div>
<div id="sec-exercises_partials" data-tralics-id="uid584" class="subsubsection" data-number="5.1.3.1"><h4><a href="#sec-exercises_partials" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li>Railsがデフォルトで生成する<code>head</code>タグの部分を、<a href="/chapters/filling_in_the_layout?version=5.1#code-rails_default_head" class="hyperref">リスト <span class="ref">5.18</span></a>のように<code>render</code>に置き換えてみてください。<em>ヒント</em>: 単純に削除してしまうと後でパーシャルを１から書き直す必要が出てくるので、削除する前にどこかに退避しておきましょう。 <span class="exercise" id="ex-eecfad"></span>
</li>
<li><a href="/chapters/filling_in_the_layout?version=5.1#code-rails_default_head" class="hyperref">リスト <span class="ref">5.18</span></a>のようなパーシャルはまだ作っていないので、現時点ではテストは <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>になっているはずです。実際にテストを実行して確認してみましょう。 <span class="exercise" id="ex-d6d37e"></span>
</li>
<li><code>layouts</code>ディレクトリに<code>head</code>タグ用のパーシャルを作成し、先ほど退避しておいたコードを書き込み、最後にテストが <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span> に戻ることを確認しましょう。 <span class="exercise" id="ex-e89622"></span>
</li></ol>
<div class="codelisting" id="code-rails_default_head" data-tralics-id="uid588" data-number="5.18"><div class="heading"><span class="number">リスト 5.18:</span> 

<span class="description">Railsのデフォルトのheadタグを<code>render</code>に置き換える <span class="break"></span> <span class="filepath">app/views/layouts/application.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span><span class="cp">&lt;%=</span> <span class="n">full_title</span><span class="p">(</span><span class="k">yield</span><span class="p">(</span><span class="ss">:title</span><span class="p">))</span> <span class="cp">%&gt;</span><span class="nt">&lt;/title&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/rails_default'</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/shim'</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/head&gt;</span>
  <span class="nt">&lt;body&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/header'</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/footer'</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div></div></div></div></div></div><div id="sec-sass_and_the_asset_pipeline" data-tralics-id="cid28" class="section" data-number="5.2"><h2><a href="/chapters/filling_in_the_layout?version=5.1#sec-sass_and_the_asset_pipeline" class="heading hyperref"><span class="number">5.2 </span>Sassとアセットパイプライン</a></h2>
<p>最近のRailsに追加された機能の中で最も特筆すべき機能の１つは、CSS、JavaScript、画像などの静的コンテンツの生産性と管理を大幅に強化する「<em>アセットパイプライン (Asset Pipeline)</em>」です。このセクションでは、アセットパイプラインの概要と、素晴らしいCSS生成ツールである「<em>Sass</em>」の使い方について説明します。</p>
<div id="sec-the_asset_pipeline" data-tralics-id="uid589" class="subsection" data-number="5.2.1"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-the_asset_pipeline" class="heading hyperref"><span class="number">5.2.1 </span>アセットパイプライン</a></h3>
<p>Rails開発者の視点からは、アセットディレクトリ、マニフェストファイル、プリプロセッサエンジンという、3つの主要な機能が理解の対象となります<sup id="cha-5_footnote-ref-14" class="footnote"><a href="#cha-5_footnote-14">14</a></sup>。では、それぞれを順に見ていきましょう。</p>
<div id="uid591" data-tralics-id="uid591" class="subsubsection" data-number="5.2.1.1"><h4><a href="#uid591" class="heading">アセットディレクトリ</a></h4>
<p>Railsのアセットパイプラインでは、静的ファイルを目的別に分類する、標準的な３つのディレクトリが使われています。</p>
<ul>
<li><code>app/assets</code>: 現在のアプリケーション固有のアセット
</li>
<li><code>lib/assets</code>: あなたの開発チームによって作成されたライブラリ用のアセット
</li>
<li><code>vendor/assets</code>: サードパーティのアセット
</li></ul>
<p class="noindent">これらのディレクトリには、それぞれのアセットクラス用のサブディレクトリがあります。例えばapp/assetsの場合、次のような画像用、JavaScript用、CSS用のサブディレクトリがあります。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> ls app/assets/
<span class="go">images/  javascripts/  stylesheets/</span>
</pre></div></div>
<p>上記の説明から、<a href="/chapters/filling_in_the_layout?version=5.1#sec-custom_css" class="hyperref"><span class="ref">5.1.2</span></a>で取り上げたカスタムCSSが配置された場所と、その理由について理解することができると思います。つまり、<code>custom.scss</code>はサンプルアプリケーション固有のアセットなので、<code>app/assets/stylesheets</code>に配置されていたのです。</p>
</div>
<div id="uid595" data-tralics-id="uid595" class="subsubsection" data-number="5.2.1.2"><h4><a href="#uid595" class="heading">マニフェストファイル</a></h4>
<p>静的ファイル (アセット) を上記の場所へそれぞれ配置すれば、<em>マニフェストファイル</em>を使って、それらをどのように1つのファイルにまとめるのかをRailsに指示することができます。なお、実際にアセットをまとめる処理を行うのは<a href="https://github.com/rails/sprockets" target="_blank" rel="noopener">Sprockets</a>というgemです。また、マニフェストファイルはCSSとJavaScriptには適用されますが、画像ファイルには適用されません。1つの具体例として、アプリケーションのCSS用マニフェストファイルを見てみましょう (<a href="/chapters/filling_in_the_layout?version=5.1#code-app_css_manifest" class="hyperref">リスト <span class="ref">5.19</span></a>)。</p>
<div class="codelisting" id="code-app_css_manifest" data-tralics-id="uid596" data-number="5.19"><div class="heading"><span class="number">リスト 5.19:</span> 

<span class="description">アプリケーション固有のCSS用マニフェストファイル <span class="break"></span> <span class="filepath">app/assets/stylesheets/application.css</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * This is a manifest file that'll be compiled into application.css, which</span>
<span class="cm"> * will include all the files listed below.</span>
<span class="cm"> *</span>
<span class="cm"> * Any CSS and SCSS file within this directory, lib/assets/stylesheets,</span>
<span class="cm"> * vendor/assets/stylesheets, or vendor/assets/stylesheets of plugins, if any,</span>
<span class="cm"> * can be referenced here using a relative path.</span>
<span class="cm"> *</span>
<span class="cm"> * You're free to add application-wide styles to this file and they'll appear</span>
<span class="cm"> * at the bottom of the compiled file so the styles you add here take</span>
<span class="cm"> * precedence over styles defined in any styles defined in the other CSS/SCSS</span>
<span class="cm"> * files in this directory. It is generally better to create a new file per</span>
<span class="cm"> * style scope.</span>
<span class="cm"> *</span>
<span class="hll"><span class="cm"> *= require_tree .</span>
</span><span class="hll"><span class="cm"> *= require_self</span>
</span><span class="cm"> */</span>
</pre></div></div></div><p class="noindent">上の行で重要な部分は、実はCSSコメントの中にあります。コメント内の次の部分は、Sprocketsが適切なファイルを読み込むために使われます。</p>
<div class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> .</span>
<span class="cm"> .</span>
<span class="cm"> .</span>
<span class="cm"> *= require_tree .</span>
<span class="cm"> *= require_self</span>
<span class="cm">*/</span>
</pre></div></div>
<p class="noindent">例えばこの行は、</p>
<div class="code"><div class="highlight"><pre><span class="go"> *= require_tree .</span>
</pre></div></div>
<p class="noindent"><code>app/assets/stylesheets</code>ディレクトリ (サブディレクトリを含む) 中のすべてのCSSファイルが、アプリケーションCSSに含まれるようにしています。また、次の行は、</p>
<div class="code"><div class="highlight"><pre><span class="go"> *= require_self</span>
</pre></div></div>
<p class="noindent">CSSの読み込みシーケンスの中で、<code>application.css</code>自身もその対象に含めています。</p>
<p>Railsには実用的なデフォルトのマニフェストファイルが付属しているので、<em>Railsチュートリアル</em>では変更を加える必要がありませんが、もし必要な場合は、Railsガイドの「<a href="http://railsguides.jp/asset_pipeline.html" target="_blank" rel="noopener">アセットパイプライン</a>」で詳細な情報を参照できます。</p>
</div>
<div id="uid597" data-tralics-id="uid597" class="subsubsection" data-number="5.2.1.3"><h4><a href="#uid597" class="heading">プリプロセッサエンジン</a></h4>
<p>必要なアセットをディレクトリに配置してまとめた後、Railsはさまざまなプリプロセッサエンジンを介してそれらを実行し、ブラウザに配信できるようにそれらをマニフェストファイルを用いて結合し、サイトテンプレート用に準備します。Railsはどのプリプロセッサを使うのかを、ファイル名の拡張子を使って判断します。最も一般的な拡張子は、Sass用の<code>.scss</code>、CoffeeScript用の<code>.coffee</code>、埋め込みRuby (ERb) 用の<code>.erb</code>です。<a href="/chapters/static_pages?version=5.1#sec-layouts_and_embedded_ruby" class="hyperref"><span class="ref">3.4.3</span></a>では最初にERbを、<a href="/chapters/filling_in_the_layout?version=5.1#sec-sass" class="hyperref"><span class="ref">5.2.2</span></a>ではSassをそれぞれ扱いました (なお本書では詳しく説明しませんが、CoffeeScriptはエレガントかつ簡潔な言語で、JavaScriptにコンパイルしてくれるJavaScriptの拡張言語です)。</p>
<p>プリプロセッサエンジンは、繋げて実行する (chain) ことができます。</p>
<p class="noindent"><code>foobar.js.coffee</code></p>
<p class="noindent">上の拡張子の場合、CoffeeScriptプロセッサ経由で実行されます。</p>
<p class="noindent"><code>foobar.js.erb.coffee</code></p>
<p class="noindent">上の拡張子の場合は、CoffeeScriptとERbの両方で実行されます (コードは右から左へと実行されますので、この例ではCoffeeScriptが最初に実行されます)。</p>
</div>
<div id="uid598" data-tralics-id="uid598" class="subsubsection" data-number="5.2.1.4"><h4><a href="#uid598" class="heading">本番環境での効率性</a></h4>
<p>Asset Pipelineの最大のメリットの1つは、本番のアプリケーションで効率的になるように最適化されたアセットも自動的に生成されることです。従来は、CSSとJavaScriptを整理するために、機能を個別のファイルに分割し、(インデントを多用して) 読みやすいフォーマットに整えていました。これは、プログラマにとっては便利な方法ですが、本番環境にとっては非効率です。それというのも、最小化されていないCSSやJavaScriptファイルを多数に分割すると、ページの読み込み時間が著しく遅くなるからです (読み込み時間は、ユーザー体験の質に影響を与える重要な指標の1つです)。Asset Pipelineを使うと、この「開発効率と読み込み時間のどちらを重視するか」という問題について悩む必要がなくなります。開発環境ではプログラマにとって読みやすいように整理しておき、本番環境ではAsset Pipelineを使ってファイルを最小化すればよいのです。具体的には、Asset Pipelineがすべてのスタイルシートを1つのCSSファイル (<code>application.css</code>) にまとめ、すべてのJavaScriptファイルを1つのJSファイル (<code>javascripts.js</code>) にまとめてくれます。さらに、それらのファイルすべてに対して 不要な空白やインデントを取り除く処理を行い、ファイルサイズを<em>最小化</em>してくれます。結果として、開発環境と本番環境という、2つの異なった状況に対してそれぞれ最高の環境を提供してくれます。</p>
</div></div>
<div id="sec-sass" data-tralics-id="uid599" class="subsection" data-number="5.2.2"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-sass" class="heading hyperref"><span class="number">5.2.2 </span>素晴らしい構文を備えたスタイルシート</a></h3>
<p><em>Sass</em> は、スタイルシートを記述するための言語であり、CSSに比べて多くの点が強化されています。この節では、Sassが提供する2つの重要な機能、<em>ネスト</em>と<em>変数</em>について説明します。(3つ目の重要な機能である<em>ミックスイン</em>については、<a href="/chapters/sign_up?version=5.1#sec-rails_environments" class="hyperref"><span class="ref">7.1.1</span></a>で紹介します。)</p>
<p><a href="/chapters/filling_in_the_layout?version=5.1#sec-custom_css" class="hyperref"><span class="ref">5.1.2</span></a>でも簡単に説明しましたが、SassはSCSSというフォーマットに対応しています (<code>.scss</code>という拡張子はSCSSであることを表します)。SCSSは厳密な意味で、CSS本体を抽象化したフォーマットです。つまり、SCSSはCSSに<em>新しい機能を追加した</em>だけで、全く新しい構文を定義したようなものではないということです<sup id="cha-5_footnote-ref-15" class="footnote"><a href="#cha-5_footnote-15">15</a></sup>。このため、有効なCSSファイルは、すべてSCSSファイルとしても扱うことができ、既存の記法ルールを使っているプロジェクトにとっても互換性のある便利なフォーマットになっています。本書の例では、Bootstrapの恩恵を得るために、私達は最初からSCSSを使っています。Railsのアセットパイプラインは、<code>.scss</code>という拡張子を持つファイルをSassを使って自動的に処理してくれます。このため、<code>custom.scss</code>ファイルはSassプリプロセッサによって前処理され、その後ブラウザへの配信に備えてパッケージ化されます。</p>
<div id="uid601" data-tralics-id="uid601" class="subsubsection" data-number="5.2.2.1"><h4><a href="#uid601" class="heading">ネスト</a></h4>
<p>スタイルシート内に共通のパターンがある場合は、要素をネストさせることができます。例えば<a href="/chapters/filling_in_the_layout?version=5.1#code-universal_css" class="hyperref">リスト <span class="ref">5.7</span></a>では、次のように<code>.center</code>と<code>.center h1</code>の両方に対してルールがあります。</p>
<div class="code"><div class="highlight"><pre><span class="hll"><span class="nc">.center</span> <span class="p">{</span>
</span>  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="hll"><span class="nc">.center</span> <span class="nt">h1</span> <span class="p">{</span>
</span>  <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
<p class="noindent">上のルールは、Sassを使って次のように書き換えることができます。</p>
<div class="code"><div class="highlight"><pre><span class="hll"><span class="nc">.center</span> <span class="p">{</span>
</span>  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
<span class="hll">  <span class="nt">h1</span> <span class="p">{</span>
</span>    <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>
<p class="noindent">上の例では、ネストの内側にある<code>h1</code>というルールは、<code>.center</code>のルールを継承しています。</p>
<p>今度は、もう少し異なるルールに対してネスト機能を使う例を見てみましょう。<a href="/chapters/filling_in_the_layout?version=5.1#code-logo_css" class="hyperref">リスト <span class="ref">5.9</span></a>には次のコードがあります。</p>
<div class="code"><div class="highlight"><pre><span class="hll"><span class="nn">#logo</span> <span class="p">{</span>
</span>  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="na">margin-right</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.7</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#fff</span><span class="p">;</span>
  <span class="na">text-transform</span><span class="o">:</span> <span class="no">uppercase</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">9</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-weight</span><span class="o">:</span> <span class="no">bold</span><span class="p">;</span>
<span class="p">}</span>

<span class="hll"><span class="nn">#logo</span><span class="nd">:hover</span> <span class="p">{</span>
</span>  <span class="na">color</span><span class="o">:</span> <span class="mh">#fff</span><span class="p">;</span>
  <span class="na">text-decoration</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
<p class="noindent">上のコードでは<code>#logo</code>というidが2回使われています。1回目はロゴ自身を定義するために、2回目は<code>hover</code>属性を定義するために使われています (なお<code>hover</code>属性は、該当する要素の上にマウスポインタをかざしたときの表示を定義します)。2つ目のルールをネストするためには、親属性である<code>#logo</code>を参照する必要があります。このような場合、SCSSでは次のようにアンパーサンド<code>&amp;</code>を使って実現できます。</p>
<div class="code"><div class="highlight"><pre><span class="hll"><span class="nn">#logo</span> <span class="p">{</span>
</span>  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="na">margin-right</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.7</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#fff</span><span class="p">;</span>
  <span class="na">text-transform</span><span class="o">:</span> <span class="no">uppercase</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">9</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-weight</span><span class="o">:</span> <span class="no">bold</span><span class="p">;</span>
<span class="hll">  <span class="k">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
</span>    <span class="na">color</span><span class="o">:</span> <span class="mh">#fff</span><span class="p">;</span>
    <span class="na">text-decoration</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>
<p class="noindent">Sassは、SCSSをCSSに変換する際に、<code>&amp;:hover</code>を<code>#logo:hover</code>に置き換えています。</p>
<p>これらのネスト機能は、フッターのCSSでも使えます。<a href="/chapters/filling_in_the_layout?version=5.1#code-footer_css" class="hyperref">リスト <span class="ref">5.17</span></a>のコードは、SCSSを使って次のように書き換えることができます。</p>
<div class="code"><div class="highlight"><pre><span class="nt">footer</span> <span class="p">{</span>
  <span class="na">margin-top</span><span class="o">:</span> <span class="mi">45</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">border-top</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#eaeaea</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="mh">#777</span><span class="p">;</span>
  <span class="nt">a</span> <span class="p">{</span>
    <span class="na">color</span><span class="o">:</span> <span class="mh">#555</span><span class="p">;</span>
    <span class="k">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
      <span class="na">color</span><span class="o">:</span> <span class="mh">#222</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nt">small</span> <span class="p">{</span>
    <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">ul</span> <span class="p">{</span>
    <span class="na">float</span><span class="o">:</span> <span class="no">right</span><span class="p">;</span>
    <span class="na">list-style</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
    <span class="nt">li</span> <span class="p">{</span>
      <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
      <span class="na">margin-left</span><span class="o">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div></div>
<p class="noindent"><a href="/chapters/filling_in_the_layout?version=5.1#code-footer_css" class="hyperref">リスト <span class="ref">5.17</span></a>を手作業で変換してみることは、良い演習になります (実際に<a href="/chapters/filling_in_the_layout?version=5.1#sec-exercises_sass" class="hyperref"><span class="ref">5.2.2.3</span></a>でも取り入れてみました)。変換後にも、CSSが適切に動作していることを確認してみましょう。</p>
</div>
<div id="uid602" data-tralics-id="uid602" class="subsubsection" data-number="5.2.2.2"><h4><a href="#uid602" class="heading">変数</a></h4>
<p>Sassでは、冗長なコードを削除し、より自由な表現を可能にするために、<em>変数</em>が定義できるようになっています。例えば<a href="/chapters/filling_in_the_layout?version=5.1#code-typography_css" class="hyperref">リスト <span class="ref">5.8</span></a>や<a href="/chapters/filling_in_the_layout?version=5.1#code-footer_css" class="hyperref">リスト <span class="ref">5.17</span></a>を見てみると、同じ色を繰り返し参照している箇所があります。</p>
<div class="code"><div class="highlight"><pre><span class="nt">h2</span> <span class="p">{</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">.</span>
<span class="hll">  <span class="na">color</span><span class="o">:</span> <span class="mh">#777</span><span class="p">;</span>
</span><span class="p">}</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nt">footer</span> <span class="p">{</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">.</span>
<span class="hll">  <span class="na">color</span><span class="o">:</span> <span class="mh">#777</span><span class="p">;</span>
</span><span class="p">}</span>
</pre></div></div>
<p class="noindent">上のコードの<code>#777</code>は薄い灰色を指しています。Sassでは、このような値を変数として定義し、次のように変数名を与えることができます。</p>
<div class="code"><div class="highlight"><pre><span class="nv">$light-gray</span><span class="o">:</span> <span class="mh">#777</span><span class="p">;</span>
</pre></div></div>
<p class="noindent">この機能を使って、SCSSを次のように書き直すことができます。</p>
<div class="code"><div class="highlight"><pre><span class="nv">$light-gray</span><span class="o">:</span> <span class="mh">#777</span><span class="p">;</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nt">h2</span> <span class="p">{</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">color</span><span class="o">:</span> <span class="nv">$light-gray</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nt">footer</span> <span class="p">{</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">color</span><span class="o">:</span> <span class="nv">$light-gray</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
<p><code>$light-gray</code>のような変数名は、<code>#777</code>のような値よりも分かりやすいので、たとえその変数が繰り返し使われないとしても、変数名を与えることは多くの場合有用です。実際、Bootstrapフレームワークでは、多くの色に対して変数名を定義しています。定義されている変数はBootstrapページの「<a href="http://getbootstrap.com/customize/#less-variables" target="_blank" rel="noopener">LESS変数一覧</a>」で参照することができます。このWebサイトでは、SassではなくLESSを使って変数が定義されていますが、<code class="tt">bootstrap-sass</code>というgemを使えば、Sassでも同様の変数が使えるようになります。例えばLESSではアットマーク<code>@</code>を使っているのに対して、Sassはドルマーク<code>$</code>を使っていることはすぐにわかります。話を戻して、Bootstrapの変数の一覧表を見ると、薄い灰色に対して次の変数名が与えられることに気が付きます。</p>
<div class="code"><div class="highlight"><pre> <span class="k">@gray-light</span><span class="nd">:</span> <span class="nn">#777</span><span class="o">;</span>
</pre></div></div>
<p class="noindent">これはつまり、<code class="tt">bootstrap-sass</code>というgemを使えば、SCSSでも同様に<code>$gray-light</code>という変数が使えることを意味しています。先ほど定義した<code>$light-gray</code>というカスタム変数の代わりに、用意された変数を使ってみましょう。</p>
<div class="code"><div class="highlight"><pre><span class="nt">h2</span> <span class="p">{</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">color</span><span class="o">:</span> <span class="nv">$gray-light</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nt">footer</span> <span class="p">{</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">color</span><span class="o">:</span> <span class="nv">$gray-light</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
<p>今回取り上げたSassのネスト機能や変数機能を使ってSCSSファイルを全面的に書き直すと、<a href="/chapters/filling_in_the_layout?version=5.1#code-refactored_scss" class="hyperref">リスト <span class="ref">5.20</span></a>のようになります。このリストでは、Sassの変数 (詳しくはBootstrap LESSの変数一覧を参照) や、組み込みの色変数 (例えば<code>#fff</code>には<code>white</code>という変数) を使っています。<code>footer</code>タグのルールが、劇的に向上していることを確認してみてください。</p>
<div class="codelisting" id="code-refactored_scss" data-tralics-id="uid603" data-number="5.20"><div class="heading"><span class="number">リスト 5.20:</span> 

<span class="description">ネストや変数を使って初期のSCSSファイルを書き直した結果 <span class="break"></span> <span class="filepath">app/assets/stylesheets/custom.scss</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">@import</span> <span class="s2">"bootstrap-sprockets"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>

<span class="cm">/* mixins, variables, etc. */</span>

<span class="nv">$gray-medium-light</span><span class="o">:</span> <span class="mh">#eaeaea</span><span class="p">;</span>

<span class="cm">/* universal */</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">60</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">section</span> <span class="p">{</span>
  <span class="na">overflow</span><span class="o">:</span> <span class="no">auto</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">textarea</span> <span class="p">{</span>
  <span class="na">resize</span><span class="o">:</span> <span class="n">vertical</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.center</span> <span class="p">{</span>
  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
  <span class="nt">h1</span> <span class="p">{</span>
    <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* typography */</span>

<span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span><span class="o">,</span> <span class="nt">h3</span><span class="o">,</span> <span class="nt">h4</span><span class="o">,</span> <span class="nt">h5</span><span class="o">,</span> <span class="nt">h6</span> <span class="p">{</span>
  <span class="na">line-height</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h1</span> <span class="p">{</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">3</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-2</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">h2</span> <span class="p">{</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.2</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">text-align</span><span class="o">:</span> <span class="no">center</span><span class="p">;</span>
  <span class="na">font-weight</span><span class="o">:</span> <span class="no">normal</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="nv">$gray-light</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">p</span> <span class="p">{</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.1</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">line-height</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.7</span><span class="kt">em</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/* header */</span>

<span class="nn">#logo</span> <span class="p">{</span>
  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="na">margin-right</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.7</span><span class="kt">em</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
  <span class="na">text-transform</span><span class="o">:</span> <span class="no">uppercase</span><span class="p">;</span>
  <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">9</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">font-weight</span><span class="o">:</span> <span class="no">bold</span><span class="p">;</span>
  <span class="k">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
    <span class="na">color</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span>
    <span class="na">text-decoration</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* footer */</span>

<span class="nt">footer</span> <span class="p">{</span>
  <span class="na">margin-top</span><span class="o">:</span> <span class="mi">45</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">padding-top</span><span class="o">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="na">border-top</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="no">solid</span> <span class="nv">$gray-medium-light</span><span class="p">;</span>
  <span class="na">color</span><span class="o">:</span> <span class="nv">$gray-light</span><span class="p">;</span>
  <span class="nt">a</span> <span class="p">{</span>
    <span class="na">color</span><span class="o">:</span> <span class="nv">$gray</span><span class="p">;</span>
    <span class="k">&amp;</span><span class="nd">:hover</span> <span class="p">{</span>
      <span class="na">color</span><span class="o">:</span> <span class="nv">$gray-darker</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="nt">small</span> <span class="p">{</span>
    <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">ul</span> <span class="p">{</span>
    <span class="na">float</span><span class="o">:</span> <span class="no">right</span><span class="p">;</span>
    <span class="na">list-style</span><span class="o">:</span> <span class="no">none</span><span class="p">;</span>
    <span class="nt">li</span> <span class="p">{</span>
      <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
      <span class="na">margin-left</span><span class="o">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><p>Sassを使ってスタイルシートをより簡単にする方法は他にもありますが、今回はその中でも最も重要な機能を使って<a href="/chapters/filling_in_the_layout?version=5.1#code-refactored_scss" class="hyperref">リスト <span class="ref">5.20</span></a>を書き直しました。Sassを使うことによって、素晴らしいスタートを切ることができました。Sassの詳細については、<a href="http://sass-lang.com/" target="_blank" rel="noopener">Sassの公式サイト</a> (英語) を参照してください。</p>
</div>
<div id="sec-exercises_sass" data-tralics-id="uid604" class="subsubsection" data-number="5.2.2.3"><h4><a href="#sec-exercises_sass" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li><a href="/chapters/filling_in_the_layout?version=5.1#sec-sass" class="hyperref"><span class="ref">5.2.2</span></a>で提案したように、footerのCSSを手作業で変換してみましょう。具体的には、<a href="/chapters/filling_in_the_layout?version=5.1#code-footer_css" class="hyperref">リスト <span class="ref">5.17</span></a>の内容を１つずつ変換していき、<a href="/chapters/filling_in_the_layout?version=5.1#code-refactored_scss" class="hyperref">リスト <span class="ref">5.20</span></a>のようにしてみてください。 <span class="exercise" id="ex-4f280d"></span>
</li></ol>
</div></div></div><div id="sec-layout_links" data-tralics-id="cid29" class="section" data-number="5.3"><h2><a href="/chapters/filling_in_the_layout?version=5.1#sec-layout_links" class="heading hyperref"><span class="number">5.3 </span>レイアウトのリンク</a></h2>
<p>サイトのレイアウトが美しく仕上がったので、今度は<code>’#’</code>で代用していたリンクを書き換えてみましょう。もちろん、次のようにリンクを直接記述することもできます。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/static_pages/about"</span><span class="nt">&gt;</span>About<span class="nt">&lt;/a&gt;</span>
</pre></div></div>
<p class="noindent">しかし、上の記法はRails流ではありません。まず、aboutページへのURLは /static_pages/about よりも /about の方がよいでしょう。さらに、Railsでは次のようなコードでは<em>名前付きルート</em>を使うのが慣例となっています。</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"About"</span><span class="p">,</span> <span class="n">about_path</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p class="noindent">上のようにすることでコードの意味がわかりやすくなり、<code>about_path</code>の定義を変えれば<code>about_path</code>が使われているすべてのURLを変更できるため、柔軟性が高まります。</p>
<p>今後使う予定のURLとルーティング (route) とのマッピングを、<a href="/chapters/filling_in_the_layout?version=5.1#table-url_mapping" class="hyperref">表 <span class="ref">5.1</span></a>に示します。<a href="/chapters/static_pages?version=5.1#sec-setting_the_root_route" class="hyperref"><span class="ref">3.4.4</span></a>で最初のルートは設定済みですが、それ以外のルートについても同様に実装していきます。なお、loginについては本章の最後で少しだけ実装します (<a href="/chapters/basic_login?version=5.1#cha-basic_login" class="hyperref">第<span class="ref">8</span>章</a>で本格的に実装します)。</p>
<div class="table" id="table-url_mapping" data-tralics-id="uid606" data-number="5.1"><table class="tabular">
<tr class="bottom_border"><td class="align_left"><strong>ページ名</strong></td>
<td class="align_left"><strong>URL</strong></td>
<td class="align_right"><strong>名前付きルート</strong></td>
</tr><tr><td class="align_left">Home</td>
<td class="align_left">/</td>
<td class="align_right"><code>root_path</code></td>
</tr><tr><td class="align_left">About</td>
<td class="align_left">/about</td>
<td class="align_right"><code>about_path</code></td>
</tr><tr><td class="align_left">Help</td>
<td class="align_left">/help</td>
<td class="align_right"><code>help_path</code></td>
</tr><tr><td class="align_left">Contact</td>
<td class="align_left">/contact</td>
<td class="align_right"><code>contact_path</code></td>
</tr><tr><td class="align_left">Sign up</td>
<td class="align_left">/signup</td>
<td class="align_right"><code>signup_path</code></td>
</tr><tr><td class="align_left">Log in</td>
<td class="align_left">/login</td>
<td class="align_right"><code>login_path</code></td>
</tr></table><div class="caption"><span class="header">表 5.1: </span><span class="description">サイトリンクのルーティングとURLのマッピング 
</span></div></div>
<div id="sec-contact_page" data-tralics-id="uid607" class="subsection" data-number="5.3.1"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-contact_page" class="heading hyperref"><span class="number">5.3.1 </span>Contactページ</a></h3>
<p>まずは、<a href="/chapters/static_pages?version=5.1#cha-static_pages" class="hyperref">第<span class="ref">3</span>章</a>の演習で取り上げたContactページについて追加しましょう。Contactページのテストを<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_page_test" class="hyperref">リスト <span class="ref">5.21</span></a>に示します。これは単に<a href="/chapters/static_pages?version=5.1#code-title_tests" class="hyperref">リスト <span class="ref">3.24</span></a>で使われているテストのパターンに従ったものです。</p>
<div class="codelisting" id="code-contact_page_test" data-tralics-id="uid608" data-number="5.21"><div class="heading"><span class="number">リスト 5.21:</span> 

<span class="description">Contactページのテスト<span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">test/controllers/static_pages_controller_test.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">StaticPagesControllerTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"should get home"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">static_pages_home_url</span>
    <span class="n">assert_response</span> <span class="ss">:success</span>
    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Ruby on Rails Tutorial Sample App"</span>
  <span class="k">end</span>

  <span class="nb">test</span> <span class="s2">"should get help"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">static_pages_help_url</span>
    <span class="n">assert_response</span> <span class="ss">:success</span>
    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Help | Ruby on Rails Tutorial Sample App"</span>
  <span class="k">end</span>

  <span class="nb">test</span> <span class="s2">"should get about"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">static_pages_about_url</span>
    <span class="n">assert_response</span> <span class="ss">:success</span>
    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"About | Ruby on Rails Tutorial Sample App"</span>
  <span class="k">end</span>

<span class="hll">  <span class="nb">test</span> <span class="s2">"should get contact"</span> <span class="k">do</span>
</span><span class="hll">    <span class="n">get</span> <span class="n">static_pages_contact_url</span>
</span><span class="hll">    <span class="n">assert_response</span> <span class="ss">:success</span>
</span><span class="hll">    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Contact | Ruby on Rails Tutorial Sample App"</span>
</span><span class="hll">  <span class="k">end</span>
</span><span class="k">end</span>
</pre></div></div></div><p class="noindent">この時点では、<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_page_test" class="hyperref">リスト <span class="ref">5.21</span></a>のテストは <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>になっているはずです。</p>
<div class="codelisting" id="uid609" data-tralics-id="uid609" data-number="5.22"><div class="heading"><span class="number">リスト 5.22:</span> <span class="description"><span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span></span>
</div>

<div class="code"><div class="highlight"><pre>$ rails test
</pre></div></div></div><p>アプリケーションコードは、<a href="/chapters/static_pages?version=5.1#sec-getting_started_with_testing" class="hyperref"><span class="ref">3.3</span></a>のAboutページへの追加と良く似ています。最初にルート (<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_route" class="hyperref">リスト <span class="ref">5.23</span></a>) を更新します。次に<code>contact</code>アクションをStaticPagesコントローラ (<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_action" class="hyperref">リスト <span class="ref">5.24</span></a>) に追加します。最後にContactビュー (<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_view" class="hyperref">リスト <span class="ref">5.25</span></a>) を作成します。</p>
<div class="codelisting" id="code-contact_route" data-tralics-id="uid610" data-number="5.23"><div class="heading"><span class="number">リスト 5.23:</span> 

<span class="description">Contactページのルートを追加する <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">config/routes.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s1">'static_pages#home'</span>
  <span class="n">get</span>  <span class="s1">'static_pages/home'</span>
  <span class="n">get</span>  <span class="s1">'static_pages/help'</span>
  <span class="n">get</span>  <span class="s1">'static_pages/about'</span>
<span class="hll">  <span class="n">get</span>  <span class="s1">'static_pages/contact'</span>
</span><span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="code-contact_action" data-tralics-id="uid611" data-number="5.24"><div class="heading"><span class="number">リスト 5.24:</span> 

<span class="description">Contactページ用のアクションを追加する <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">app/controllers/static_pages_controller.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">StaticPagesController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="k">def</span> <span class="nf">contact</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="code-contact_view" data-tralics-id="uid612" data-number="5.25"><div class="heading"><span class="number">リスト 5.25:</span> 

<span class="description">Contactページのビューを追加する <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">app/views/static_pages/contact.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="s1">'Contact'</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;h1&gt;</span>Contact<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;</span>
  Contact the Ruby on Rails Tutorial about the sample app at the
  <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://railstutorial.jp/contact"</span><span class="nt">&gt;</span>contact page<span class="nt">&lt;/a&gt;</span>.
<span class="nt">&lt;/p&gt;</span>
</pre></div></div></div><p>ここで、すべてのテストが <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>であることを確認しておいてください。</p>
<div class="codelisting" id="uid613" data-tralics-id="uid613" data-number="5.26"><div class="heading"><span class="number">リスト 5.26:</span> <span class="description"><span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span></span>
</div>

<div class="code"><div class="highlight"><pre>$ rails test
</pre></div></div></div></div>
<div id="sec-rails_routes" data-tralics-id="uid614" class="subsection" data-number="5.3.2"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-rails_routes" class="heading hyperref"><span class="number">5.3.2 </span>RailsのルートURL</a></h3>
<p>本項では、名前付きルートをサンプルアプリケーションの静的ページで使うために、ルーティング用のファイル (<code>config/routes.rb</code>) を編集していきます。まずは、<a href="/chapters/static_pages?version=5.1#sec-setting_the_root_route" class="hyperref"><span class="ref">3.4.4</span></a>で定義したHomeページのルーティングについて見直していきましょう。あのときは特別にHomeページのみ設定をしましたが、残りの静的ページについても同様にルーティングを設定していきます。</p>
<p>私たちはこれまでに、ルートURLを定義するコードを3回見てきました。1つ目は、</p>
<div class="code"><div class="highlight"><pre><span class="n">root</span> <span class="s1">'application#hello'</span>
</pre></div></div>
<p class="noindent">というHelloアプリケーションのコード (<a href="/chapters/beginning?version=5.1#code-hello_root_route" class="hyperref">リスト <span class="ref">1.9</span></a>)です。2つ目は、</p>
<div class="code"><div class="highlight"><pre><span class="n">root</span> <span class="s1">'users#index'</span>
</pre></div></div>
<p class="noindent">というToyアプリケーションのコード (<a href="/chapters/toy_app?version=5.1#code-rails_routes_root_route" class="hyperref">リスト <span class="ref">2.6</span></a>)。そして最後は、</p>
<div class="code"><div class="highlight"><pre><span class="n">root</span> <span class="s1">'static_pages#home'</span>
</pre></div></div>
<p class="noindent">というSampleアプリケーションのコードです (<a href="/chapters/static_pages?version=5.1#code-home_root_route" class="hyperref">リスト <span class="ref">3.41</span></a>)。いずれの場合においても、<code>root</code>メソッドを使ってルートURL "/" をコントローラーのアクションに紐付けていました。ルートURLのようなルーティングを定義することの効果は、ブラウザからアクセスしやすくすることだけではありません。それ以外にも、生のURLではなく、名前付きルートを使ってURLを参照することができるようになります。例えばルートURLを定義すると、<code>root_path</code>や<code>root_url</code>といったメソッドを通してURLを参照することができます。ちなみに前者はルートURL以下の文字列を、後者は完全なURLの文字列を返します。</p>
<div class="code"><div class="highlight"><pre><span class="n">root_path</span> <span class="o">-&gt;</span> <span class="s1">'/'</span>
<span class="n">root_url</span>  <span class="o">-&gt;</span> <span class="s1">'http://www.example.com/'</span>
</pre></div></div>
<p class="noindent">なお、<em>Railsチュートリアル</em>では一般的な規約に従い、基本的には<code>_path</code>書式を使い、リダイレクトの場合のみ<code>_url</code>書式を使うようにします。これはHTTPの標準としては、リダイレクトのときに完全なURLが要求されるためです。ただしほとんどのブラウザでは、どちらの方法でも動作します。</p>
<p><a href="/chapters/filling_in_the_layout?version=5.1#code-contact_page_test" class="hyperref">リスト <span class="ref">5.21</span></a>などで使われたデフォルトのルーティングはやや回りくどいので、HelpページやAboutページ、Contactページなどの名前付きルートを定義していきましょう。具体的には、<code>get</code>ルールを使って定義していきます (<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_route" class="hyperref">リスト <span class="ref">5.23</span></a>)。例えば次のようなルーティングは、</p>
<div class="code"><div class="highlight"><pre><span class="n">get</span> <span class="s1">'static_pages/help'</span>
</pre></div></div>
<p class="noindent">このように変換します。</p>
<div class="code"><div class="highlight"><pre><span class="n">get</span>  <span class="s1">'/help'</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#help'</span>
</pre></div></div>
<p class="noindent">このようにgetルールを使って変更すると、<code class="tt">GET</code>リクエストが /help に送信されたときにStaticPagesコントローラーの<code>help</code>アクションを呼び出してくれるようになります。また、ルートURLのときと同様に、<code>help_path</code>や<code>help_url</code>といった名前付きルートも使えるようになります。</p>
<div class="code"><div class="highlight"><pre><span class="n">help_path</span> <span class="o">-&gt;</span> <span class="s1">'/help'</span>
<span class="n">help_url</span>  <span class="o">-&gt;</span> <span class="s1">'http://www.example.com/help'</span>
</pre></div></div>
<p class="noindent">他の静的ページについても同様にルーティングを変更していくと、<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_route" class="hyperref">リスト <span class="ref">5.23</span></a>は<a href="/chapters/filling_in_the_layout?version=5.1#code-static_page_routes" class="hyperref">リスト <span class="ref">5.27</span></a>のようなコードになります。</p>
<div class="codelisting" id="code-static_page_routes" data-tralics-id="uid615" data-number="5.27"><div class="heading"><span class="number">リスト 5.27:</span> 

<span class="description">静的なページのルーティング一覧 <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">config/routes.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s1">'static_pages#home'</span>
  <span class="n">get</span>  <span class="s1">'/help'</span><span class="p">,</span>    <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#help'</span>
  <span class="n">get</span>  <span class="s1">'/about'</span><span class="p">,</span>   <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#about'</span>
  <span class="n">get</span>  <span class="s1">'/contact'</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#contact'</span>
<span class="k">end</span>
</pre></div></div></div><p class="noindent">なお、<a href="/chapters/filling_in_the_layout?version=5.1#code-static_page_routes" class="hyperref">リスト <span class="ref">5.27</span></a>では<code>’static_pages/home’</code>という以前のルールを削除している点に注意してください。今後は常に<code>root_path</code>または<code>root_url</code>を使っていきます。</p>
<p>さらに、<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_page_test" class="hyperref">リスト <span class="ref">5.21</span></a>のテストも古くなったので、変更する必要があります。実際、現時点のテストは <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>になっているはずです。もう一度 <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span> の状態に戻すには、次の<a href="/chapters/filling_in_the_layout?version=5.1#code-static_page_routes_test" class="hyperref">リスト <span class="ref">5.28</span></a>のように修正していく必要があります。このとき、先ほどのルーティングの変更で名前付きルート (<code>*_path</code>) が使えるようになったので、早速テストの修正で使っている点に注意してください。</p>
<div class="codelisting" id="code-static_page_routes_test" data-tralics-id="uid616" data-number="5.28"><div class="heading"><span class="number">リスト 5.28:</span> 

<span class="description">StaticPagesで扱う新しい名前付きルートに対するテスト <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">test/controllers/static_pages_controller_test.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">StaticPagesControllerTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"should get home"</span> <span class="k">do</span>
<span class="hll">    <span class="n">get</span> <span class="n">root_path</span>
</span>    <span class="n">assert_response</span> <span class="ss">:success</span>
    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Ruby on Rails Tutorial Sample App"</span>
  <span class="k">end</span>

  <span class="nb">test</span> <span class="s2">"should get help"</span> <span class="k">do</span>
<span class="hll">    <span class="n">get</span> <span class="n">help_path</span>
</span>    <span class="n">assert_response</span> <span class="ss">:success</span>
    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Help | Ruby on Rails Tutorial Sample App"</span>
  <span class="k">end</span>

  <span class="nb">test</span> <span class="s2">"should get about"</span> <span class="k">do</span>
<span class="hll">    <span class="n">get</span> <span class="n">about_path</span>
</span>    <span class="n">assert_response</span> <span class="ss">:success</span>
    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"About | Ruby on Rails Tutorial Sample App"</span>
  <span class="k">end</span>

  <span class="nb">test</span> <span class="s2">"should get contact"</span> <span class="k">do</span>
<span class="hll">    <span class="n">get</span> <span class="n">contact_path</span>
</span>    <span class="n">assert_response</span> <span class="ss">:success</span>
    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="s2">"Contact | Ruby on Rails Tutorial Sample App"</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div>
<div id="sec-exercises_rails_routes" data-tralics-id="uid617" class="subsubsection" data-number="5.3.2.1"><h4><a href="#sec-exercises_rails_routes" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li>実は名前付きルートは、<code>as:</code>オプションを使って変更することができます。<a href="https://www.google.com/search?q=far+side+helf" target="_blank" rel="noopener">有名な<em>Far Side</em>の漫画</a>に倣って、Helpページの名前付きルートを<code>helf</code>に変更してみてください (<a href="/chapters/filling_in_the_layout?version=5.1#code-helf" class="hyperref">リスト <span class="ref">5.29</span></a>)。 <span class="exercise" id="ex-f886e4"></span>
</li>
<li>先ほどの変更により、テストが <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>になっていることを確認してください。<a href="/chapters/filling_in_the_layout?version=5.1#code-static_page_routes_test" class="hyperref">リスト <span class="ref">5.28</span></a>を参考にルーティングを更新して、テストを <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>にして見てください。 <span class="exercise" id="ex-b73fff"></span>
</li>
<li>エディタのUndo機能を使って、今回の演習で行った変更を元に戻して見てください。 <span class="exercise" id="ex-57ab71"></span>
</li></ol>
<div class="codelisting" id="code-helf" data-tralics-id="uid621" data-number="5.29"><div class="heading"><span class="number">リスト 5.29:</span> 

<span class="description">helpをhelfに変更する</span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s1">'static_pages#home'</span>
<span class="hll">  <span class="n">get</span>  <span class="s1">'/help'</span><span class="p">,</span>    <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#help'</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="s1">'helf'</span>
</span>  <span class="n">get</span>  <span class="s1">'/about'</span><span class="p">,</span>   <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#about'</span>
  <span class="n">get</span>  <span class="s1">'/contact'</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#contact'</span>
<span class="k">end</span>
</pre></div></div></div></div></div>
<div id="sec-named_routes" data-tralics-id="uid622" class="subsection" data-number="5.3.3"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-named_routes" class="heading hyperref"><span class="number">5.3.3 </span>名前付きルート</a></h3>
<p><a href="/chapters/filling_in_the_layout?version=5.1#code-static_page_routes" class="hyperref">リスト <span class="ref">5.27</span></a>でルートを定義したことにより、レイアウトの中で名前付きルートが使えるようになりました。早速、<code>link_to</code>メソッドの2番目の引数で、適切な名前付きルートを使ってみましょう。例えば次のコードの場合、</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"About"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p class="noindent">このように置き換えます。</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"About"</span><span class="p">,</span> <span class="n">about_path</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p class="noindent">他も同様です。</p>
<p>最初に、HomeページとHelpページへのリンクを持つheaderパーシャル <code>_header.html.erb</code> (<a href="/chapters/filling_in_the_layout?version=5.1#code-header_partial_links" class="hyperref">リスト <span class="ref">5.30</span></a>) から取り掛かります。headerパーシャルでは、Web共通の慣習に従って、ロゴにもHomeページへのリンクを追加します。</p>
<div class="codelisting" id="code-header_partial_links" data-tralics-id="uid623" data-number="5.30"><div class="heading"><span class="number">リスト 5.30:</span> 

<span class="description">headerパーシャルにリンクを追加する <span class="break"></span> <span class="filepath">app/views/layouts/_header.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;header</span> <span class="na">class=</span><span class="s">"navbar navbar-fixed-top navbar-inverse"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
<span class="hll">    <span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"sample app"</span><span class="p">,</span> <span class="n">root_path</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="s2">"logo"</span> <span class="cp">%&gt;</span>
</span>    <span class="nt">&lt;nav&gt;</span>
      <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"nav navbar-nav navbar-right"</span><span class="nt">&gt;</span>
<span class="hll">        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Home"</span><span class="p">,</span>    <span class="n">root_path</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
</span><span class="hll">        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Help"</span><span class="p">,</span>    <span class="n">help_path</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
</span>        <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Log in"</span><span class="p">,</span> <span class="s1">'#'</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
      <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;/nav&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/header&gt;</span>
</pre></div></div></div><p class="noindent">[Log in] リンクの名前付きルートは<a href="/chapters/basic_login?version=5.1#cha-basic_login" class="hyperref">第<span class="ref">8</span>章</a>で作成するため、今の段階では<code>’#’</code>のままにしておきます。</p>
<p>footerパーシャル <code>_footer.html.erb</code> にもリンクがあります。これらはAboutページとContactページへのリンクです (<a href="/chapters/filling_in_the_layout?version=5.1#code-footer_partial_links" class="hyperref">リスト <span class="ref">5.31</span></a>)。</p>
<div class="codelisting" id="code-footer_partial_links" data-tralics-id="uid624" data-number="5.31"><div class="heading"><span class="number">リスト 5.31:</span> 

<span class="description">footerパーシャルにリンクを追加する <span class="break"></span> <span class="filepath">app/views/layouts/_footer.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;footer</span> <span class="na">class=</span><span class="s">"footer"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;small&gt;</span>
    The <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://railstutorial.jp/"</span><span class="nt">&gt;</span>Ruby on Rails Tutorial<span class="nt">&lt;/a&gt;</span>
    by <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://www.michaelhartl.com/"</span><span class="nt">&gt;</span>Michael Hartl<span class="nt">&lt;/a&gt;</span>
  <span class="nt">&lt;/small&gt;</span>
  <span class="nt">&lt;nav&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
<span class="hll">      <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"About"</span><span class="p">,</span>   <span class="n">about_path</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
</span><span class="hll">      <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Contact"</span><span class="p">,</span> <span class="n">contact_path</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
</span>      <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">"http://news.railstutorial.org/"</span><span class="nt">&gt;</span>News<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/nav&gt;</span>
<span class="nt">&lt;/footer&gt;</span>
</pre></div></div></div><p>これで、レイアウトに<a href="/chapters/static_pages?version=5.1#cha-static_pages" class="hyperref">第<span class="ref">3</span>章</a>で作成したすべての静的ページへのリンクができました。例えば /about の場合はAboutページ (<a href="/chapters/filling_in_the_layout?version=5.1#fig-about_page" class="hyperref">図 <span class="ref">5.10</span></a>) に移動します。</p>
<div class="center figure" id="fig-about_page" data-tralics-id="uid625" data-number="5.10">
<div class="graphics image"><img src="images/figures/about_page_styled_3rd_edition.png" alt="images/figures/about_page_styled_3rd_edition" /></div><div class="caption"><span class="header">図 5.10: </span><span class="description">/about で表示されるAboutページ 
</span></div></div>
<div id="sec-exercises_named_routes" data-tralics-id="uid626" class="subsubsection" data-number="5.3.3.1"><h4><a href="#sec-exercises_named_routes" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li><a href="/chapters/filling_in_the_layout?version=5.1#code-helf" class="hyperref">リスト <span class="ref">5.29</span></a>のように<code>helf</code>ルーティングを作成し、レイアウトのリンクを更新してみてください。 <span class="exercise" id="ex-86ac09"></span>
</li>
<li>前回の演習と同様に、エディタのUndo機能を使ってこの演習で行った変更を元に戻してみてください。 <span class="exercise" id="ex-98fcd3"></span>
</li></ol>
</div></div>
<div id="sec-layout_link_tests" data-tralics-id="uid629" class="subsection" data-number="5.3.4"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-layout_link_tests" class="heading hyperref"><span class="number">5.3.4 </span>リンクのテスト</a></h3>
<p>レイアウト内のいくつかのリンクを埋めることができたので、これらのリンクが正しく動いているかどうかチェックするテストを書いてみましょう。ブラウザを立ち上げてルートURLにアクセスし、それぞれのリンクをクリックして確かめることもできますが、変更する度にこの作業を毎回繰り返していくのは大きな負担です。そこで、「統合テスト <em>(Integration Test)</em>」を使って一連の作業を自動化してみましょう。統合テストを使うと、アプリケーションの動作を端から端まで (end-to-end) シミュレートしてテストすることができます。まずは、<code>site_layout</code>というテストのテンプレートを生成するところから始めてみます。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> rails generate integration_test site_layout
<span class="go">      invoke  test_unit</span>
<span class="go">      create    test/integration/site_layout_test.rb</span>
</pre></div></div>
<p class="noindent">このとき、Railsは渡されたファイル名の末尾に <code>_test</code> という文字列を追加することに注目してください。</p>
<p>今回の目的は、アプリケーションのHTML構造を調べて、レイアウトの各リンクが正しく動くかどうかチェックすることです。つまり、</p>
<ol>
<li>ルートURL (Homeページ) にGETリクエストを送る.<span class="intersentencespace"></span>
</li>
<li>正しいページテンプレートが描画されているかどうか確かめる.<span class="intersentencespace"></span>
</li>
<li>Home、Help、About、Contactの各ページへのリンクが正しく動くか確かめる.<span class="intersentencespace"></span>
</li></ol>
<p>Railsの統合テストでは、上のステップをコードに落とし込んでいくことになります (<a href="/chapters/filling_in_the_layout?version=5.1#code-layout_links_test" class="hyperref">リスト <span class="ref">5.32</span></a>)。具体的には、まず<code>assert_template</code>メソッドを使って、Homeページが正しいビューを描画しているかどうか確かめます<sup id="cha-5_footnote-ref-16" class="footnote"><a href="#cha-5_footnote-16">16</a></sup>。</p>
<div class="codelisting" id="code-layout_links_test" data-tralics-id="uid634" data-number="5.32"><div class="heading"><span class="number">リスト 5.32:</span> 

<span class="description">レイアウトのリンクに対するテスト <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">test/integration/site_layout_test.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">SiteLayoutTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"layout links"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">root_path</span>
    <span class="n">assert_template</span> <span class="s1">'static_pages/home'</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">root_path</span><span class="p">,</span> <span class="ss">count</span><span class="p">:</span> <span class="mi">2</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">help_path</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">about_path</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">contact_path</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p class="noindent"><a href="/chapters/filling_in_the_layout?version=5.1#code-layout_links_test" class="hyperref">リスト <span class="ref">5.32</span></a>では、<code>assert_select</code>メソッドの高度なオプションを使っています (このメソッド自体は<a href="/chapters/static_pages?version=5.1#code-title_tests" class="hyperref">リスト <span class="ref">3.24</span></a>や<a href="/chapters/filling_in_the_layout?version=5.1#code-contact_page_test" class="hyperref">リスト <span class="ref">5.21</span></a>でも登場しました)。今回のケースでは、特定のリンクが存在するかどうかを、<code>a</code>タグと<code>href</code>属性をオプションで指定して調べています。例えば、</p>
<div class="code"><div class="highlight"><pre><span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">about_path</span>
</pre></div></div>
<p class="noindent">上のコードでは、Railsは自動的にはてなマーク "?" を<code>about_path</code>に置換しています (このとき "about_path" 内に特殊記号があればエスケープ処理されます)。これにより、次のようなHTMLがあるかどうかをチェックすることができます。</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"/about"</span><span class="nt">&gt;</span>...<span class="nt">&lt;/a&gt;</span>
</pre></div></div>
<p class="noindent">一方で、ルートURLへのリンクは<em>2つ</em>あることを思い出してください (1つはロゴに、もう1つはナビゲーションバーにあります)。このようなとき、</p>
<div class="code"><div class="highlight"><pre><span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">root_path</span><span class="p">,</span> <span class="ss">count</span><span class="p">:</span> <span class="mi">2</span>
</pre></div></div>
<p class="noindent">といった風に書くことで、<a href="/chapters/filling_in_the_layout?version=5.1#code-header_partial_links" class="hyperref">リスト <span class="ref">5.30</span></a>で定義したHomeページのリンクの個数も調べることもできます</p>
<p><code>assert_select</code>には色々な指定の仕方があります。その代表例をいくつか<a href="/chapters/filling_in_the_layout?version=5.1#table-assert_select" class="hyperref">表 <span class="ref">5.2</span></a>で紹介します。<code>assert_select</code>は柔軟でパワフルな機能で、ここでは紹介し切れないほど他にも多くのオプションがあります。しかし経験的には、このメソッドで複雑なテストはしない方が賢明です。今回のようなレイアウト内で頻繁に変更されるHTML要素 (リンクなど) をテストするぐらいに抑えておくとよいです。</p>
<div class="table" id="table-assert_select" data-tralics-id="uid635" data-number="5.2"><table class="tabular">
<tr class="bottom_border"><td class="align_left"><strong>Code</strong></td>
<td class="align_left"><strong>マッチするHTML</strong></td>
</tr><tr><td class="align_left"><code>assert_select "div"</code></td>
<td class="align_left"><span class="inline_verbatim">&lt;div&gt;foobar&lt;/div&gt;</span></td>
</tr><tr><td class="align_left"><code>assert_select "div", "foobar"</code></td>
<td class="align_left"><span class="inline_verbatim">&lt;div&gt;foobar&lt;/div&gt;</span></td>
</tr><tr><td class="align_left"><code>assert_select "div.nav"</code></td>
<td class="align_left"><span class="inline_verbatim">&lt;div class="nav"&gt;foobar&lt;/div&gt;</span></td>
</tr><tr><td class="align_left"><code>assert_select "div#profile"</code></td>
<td class="align_left"><span class="inline_verbatim">&lt;div id="profile"&gt;foobar&lt;/div&gt;</span></td>
</tr><tr><td class="align_left"><code>assert_select "div[name=yo]"</code></td>
<td class="align_left"><span class="inline_verbatim">&lt;div name="yo"&gt;hey&lt;/div&gt;</span></td>
</tr><tr><td class="align_left"><code>assert_select "a[href=?]", ’/’, count: 1</code></td>
<td class="align_left"><span class="inline_verbatim">&lt;a href="/"&gt;foo&lt;/a&gt;</span></td>
</tr><tr><td class="align_left"><code>assert_select "a[href=?]", ’/’, text: "foo"</code></td>
<td class="align_left"><span class="inline_verbatim">&lt;a href="/"&gt;foo&lt;/a&gt;</span></td>
</tr></table><div class="caption"><span class="header">表 5.2: </span><span class="description"><code>assert_select</code>のいくつかの使用例
</span></div></div>
<p><a href="/chapters/filling_in_the_layout?version=5.1#code-layout_links_test" class="hyperref">リスト <span class="ref">5.32</span></a>で追加した統合テストが通るかどうかは、次のようにRakeタスクを実行することで試すことができます。</p>
<div class="codelisting" id="uid636" data-tralics-id="uid636" data-number="5.33"><div class="heading"><span class="number">リスト 5.33:</span> <span class="description"><span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span></span>
</div>

<div class="code"><div class="highlight"><pre>$ rails test:integration
</pre></div></div></div><p class="noindent">統合テストが成功したら、今度はすべてのテストを流して <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>するかどうか確かめてみてください。</p>
<div class="codelisting" id="uid637" data-tralics-id="uid637" data-number="5.34"><div class="heading"><span class="number">リスト 5.34:</span> <span class="description"><span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span></span>
</div>

<div class="code"><div class="highlight"><pre>$ rails test
</pre></div></div></div><p class="noindent">レイアウトのリンクをテストする統合テストが追加されたことで、リンクに間違った変更が加えられたらすぐに気付けるようになりました。</p>
<div id="sec-exercises_layout_link_tests" data-tralics-id="uid638" class="subsubsection" data-number="5.3.4.1"><h4><a href="#sec-exercises_layout_link_tests" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li>footerパーシャルの<code>about_path</code>を<code>contact_path</code>に変更してみて、テストが正しくエラーを捕まえてくれるかどうか確認してみてください。 <span class="exercise" id="ex-454224"></span>
</li>
<li><a href="/chapters/filling_in_the_layout?version=5.1#code-test_helper_application_helper" class="hyperref">リスト <span class="ref">5.35</span></a>で示すように、Applicationヘルパーで使っている<code>full_title</code>ヘルパーを、test環境でも使えるようにすると便利です。こうしておくと、<a href="/chapters/filling_in_the_layout?version=5.1#code-layout_links_test_signup_full_title_helper" class="hyperref">リスト <span class="ref">5.36</span></a>のようなコードを使って、正しいタイトルをテストすることができます。ただし、これは完璧なテストではありません。例えばベースタイトルに「Ruby on Rails Tutoial」といった誤字があったとしても、このテストでは発見することができないでしょう。この問題を解決するためには、<code>full_title</code>ヘルパーに対するテストを書く必要があります。そこで、Applicationヘルパーをテストするファイルを作成し、<a href="/chapters/filling_in_the_layout?version=5.1#code-full_title_helper_tests" class="hyperref">リスト <span class="ref">5.37</span></a>の<code>FILL_IN</code>の部分を適切なコードに置き換えてみてください。<em>ヒント</em>: <a href="/chapters/filling_in_the_layout?version=5.1#code-full_title_helper_tests" class="hyperref">リスト <span class="ref">5.37</span></a>では<code>assert_equal &lt;期待される値&gt;, &lt;実際の値&gt;</code>といった形で使っていましたが、内部では<code>==</code>演算子で期待される値と実際の値を比較し、正しいかどうかのテストをしています。 <span class="exercise" id="ex-cfa831"></span>
</li></ol>
<div class="codelisting" id="code-test_helper_application_helper" data-tralics-id="uid641" data-number="5.35"><div class="heading"><span class="number">リスト 5.35:</span> 

<span class="description">test環境でもApplicationヘルパーを使えるようにする <span class="break"></span> <span class="filepath">test/test_helper.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">ENV</span><span class="o">[</span><span class="s1">'RAILS_ENV'</span><span class="o">]</span> <span class="o">||=</span> <span class="s1">'test'</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="o">.</span>
<span class="k">class</span> <span class="nc">ActiveSupport</span><span class="o">::</span><span class="no">TestCase</span>
  <span class="n">fixtures</span> <span class="ss">:all</span>
<span class="hll">  <span class="kp">include</span> <span class="no">ApplicationHelper</span>
</span>  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="code-layout_links_test_signup_full_title_helper" data-tralics-id="uid642" data-number="5.36"><div class="heading"><span class="number">リスト 5.36:</span> 

<span class="description">test環境で<code>full_title</code>ヘルパーを使う <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">test/integration/site_layout_test.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">SiteLayoutTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"layout links"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">root_path</span>
    <span class="n">assert_template</span> <span class="s1">'static_pages/home'</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">root_path</span><span class="p">,</span> <span class="ss">count</span><span class="p">:</span> <span class="mi">2</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">help_path</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">about_path</span>
    <span class="n">assert_select</span> <span class="s2">"a[href=?]"</span><span class="p">,</span> <span class="n">contact_path</span>
<span class="hll">    <span class="n">get</span> <span class="n">contact_path</span>
</span><span class="hll">    <span class="n">assert_select</span> <span class="s2">"title"</span><span class="p">,</span> <span class="n">full_title</span><span class="p">(</span><span class="s2">"Contact"</span><span class="p">)</span>
</span>  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="code-full_title_helper_tests" data-tralics-id="uid643" data-number="5.37"><div class="heading"><span class="number">リスト 5.37:</span> 

<span class="description"><code>full_title</code>ヘルパーの単体テスト <span class="break"></span> <span class="filepath">test/helpers/application_helper_test.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">ApplicationHelperTest</span> <span class="o">&lt;</span> <span class="no">ActionView</span><span class="o">::</span><span class="no">TestCase</span>
  <span class="nb">test</span> <span class="s2">"full title helper"</span> <span class="k">do</span>
    <span class="n">assert_equal</span> <span class="n">full_title</span><span class="p">,</span>         <span class="no">FILL_IN</span>
    <span class="n">assert_equal</span> <span class="n">full_title</span><span class="p">(</span><span class="s2">"Help"</span><span class="p">),</span> <span class="no">FILL_IN</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div></div></div></div><div id="sec-user_signup" data-tralics-id="cid30" class="section" data-number="5.4"><h2><a href="/chapters/filling_in_the_layout?version=5.1#sec-user_signup" class="heading hyperref"><span class="number">5.4 </span>ユーザー登録: 最初のステップ</a></h2>
<p>この節では、レイアウトとルーティングの取り組みにおける頂点として、ユーザー登録ページへのルーティングを作成します。そのために2番目のコントローラを作成することになります。これは、Webサイトでユーザー登録を行えるようにするための最初の重要な一歩となります。次の一歩であるユーザーのモデリングは<a href="/chapters/modeling_users?version=5.1#cha-modeling_users" class="hyperref">第<span class="ref">6</span>章</a>で行い、<a href="/chapters/sign_up?version=5.1#cha-sign_up" class="hyperref">第<span class="ref">7</span>章</a>でユーザー登録が完成します。</p>
<div id="sec-users_controller" data-tralics-id="uid644" class="subsection" data-number="5.4.1"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-users_controller" class="heading hyperref"><span class="number">5.4.1 </span>Usersコントローラ</a></h3>
<p><a href="/chapters/static_pages?version=5.1#sec-static_pages" class="hyperref"><span class="ref">3.2</span></a>で、最初のコントローラであるStaticPagesコントローラを作成しました。今度は2番目のコントローラであるUsersコントローラを作成しましょう。以前のときと同様に、<code>generate</code>を実行して、現時点での要求である新規ユーザー用のユーザー登録ページ (スタブ) を持つ、最も簡単なコントローラを作成します。Railsで好まれている<a href="http://ja.wikipedia.org/wiki/Representational_State_Transfer" target="_blank" rel="noopener">RESTアーキテクチャ</a>の規約に従い、新規ユーザー用のアクションを<code>new</code>とします。したがって、<code>generate controller</code>の引数に<code>new</code>を渡して、自動的にアクションを作成してみましょう。変更の結果を<a href="/chapters/filling_in_the_layout?version=5.1#code-generate_users_controller" class="hyperref">リスト <span class="ref">5.38</span></a>に示します。</p>
<div class="codelisting" id="code-generate_users_controller" data-tralics-id="uid645" data-number="5.38"><div class="heading"><span class="number">リスト 5.38:</span> 

<span class="description">Usersコントローラの生成 (<code>new</code>アクションを追加)</span>
</div>

<div class="code"><div class="highlight"><pre><span class="hll"><span class="gp">$</span> rails generate controller Users new
</span><span class="go">      create  app/controllers/users_controller.rb</span>
<span class="go">       route  get 'users/new'</span>
<span class="go">      invoke  erb</span>
<span class="go">      create    app/views/users</span>
<span class="go">      create    app/views/users/new.html.erb</span>
<span class="go">      invoke  test_unit</span>
<span class="go">      create    test/controllers/users_controller_test.rb</span>
<span class="go">      invoke  helper</span>
<span class="go">      create    app/helpers/users_helper.rb</span>
<span class="go">      invoke    test_unit</span>
<span class="go">      invoke  assets</span>
<span class="go">      invoke    coffee</span>
<span class="go">      create      app/assets/javascripts/users.coffee</span>
<span class="go">      invoke    scss</span>
<span class="go">      create      app/assets/stylesheets/users.scss</span>
</pre></div></div></div><p class="noindent"><a href="/chapters/filling_in_the_layout?version=5.1#code-generate_users_controller" class="hyperref">リスト <span class="ref">5.38</span></a>により、<code>new</code>アクションを持つUsersコントローラ(<a href="/chapters/filling_in_the_layout?version=5.1#code-initial_users_controller" class="hyperref">リスト <span class="ref">5.39</span></a>)と、スタブのユーザービューを作成します(<a href="/chapters/filling_in_the_layout?version=5.1#code-initial_new_action" class="hyperref">リスト <span class="ref">5.40</span></a>)。このとき、新しいUserページ用の小さなテスト (<a href="/chapters/filling_in_the_layout?version=5.1#code-user_new_test" class="hyperref">リスト <span class="ref">5.41</span></a>) も生成されていて、この時点ではパスするはずです。</p>
<div class="codelisting" id="code-initial_users_controller" data-tralics-id="uid646" data-number="5.39"><div class="heading"><span class="number">リスト 5.39:</span> 

<span class="description"><code>new</code>アクションを持つ最初のUsersコントローラ <span class="break"></span> <span class="filepath">app/controllers/users_controller.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">new</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="code-initial_new_action" data-tralics-id="uid647" data-number="5.40"><div class="heading"><span class="number">リスト 5.40:</span> 

<span class="description">Users用の最初の<code>new</code>アクション <span class="break"></span> <span class="filepath">app/views/users/new.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Users#new<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;</span>Find me in app/views/users/new.html.erb<span class="nt">&lt;/p&gt;</span>
</pre></div></div></div><div class="codelisting" id="code-user_new_test" data-tralics-id="uid648" data-number="5.41"><div class="heading"><span class="number">リスト 5.41:</span> 

<span class="description">Userページ用の最初のテスト <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">test/controllers/users_controller_test.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">UsersControllerTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"should get new"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">users_new_url</span>
    <span class="n">assert_response</span> <span class="ss">:success</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>この時点では、テストは <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>になっているはずです。</p>
<div class="codelisting" id="uid649" data-tralics-id="uid649" data-number="5.42"><div class="heading"><span class="number">リスト 5.42:</span> <span class="description"><span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span></span>
</div>

<div class="code"><div class="highlight"><pre>$ rails test
</pre></div></div></div>
<div id="sec-exercises_users_controller" data-tralics-id="uid650" class="subsubsection" data-number="5.4.1.1"><h4><a href="#sec-exercises_users_controller" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li><a href="/chapters/filling_in_the_layout?version=5.1#table-url_mapping" class="hyperref">表 <span class="ref">5.1</span></a>を参考にしながら<a href="/chapters/filling_in_the_layout?version=5.1#code-user_new_test" class="hyperref">リスト <span class="ref">5.41</span></a>を変更し、<code>users_new_url</code>ではなく<code>signup_path</code>を使えるようにしてみてください。 <span class="exercise" id="ex-e30705"></span>
</li>
<li>先ほどの変更を加えたことにより、テストが <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>になったことを確認してください。なお、この演習はテスト駆動開発 (<a href="/chapters/static_pages?version=5.1#aside-when_to_test" class="hyperref">コラム <span class="ref">3.3</span></a>) で説明した <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>/<span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span> のリズムを作ることを目的としています。このテストは次の<a href="/chapters/filling_in_the_layout?version=5.1#sec-signup_url" class="hyperref"><span class="ref">5.4.2</span></a>で <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>になるよう修正します。 <span class="exercise" id="ex-b87c82"></span>
</li></ol>
</div></div>
<div id="sec-signup_url" data-tralics-id="uid653" class="subsection" data-number="5.4.2"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-signup_url" class="heading hyperref"><span class="number">5.4.2 </span>ユーザー登録用URL</a></h3>
<p><a href="/chapters/filling_in_the_layout?version=5.1#sec-users_controller" class="hyperref"><span class="ref">5.4.1</span></a>のコードにより、新規ユーザー用の動作するページが/users/new にできました。ここで<a href="/chapters/filling_in_the_layout?version=5.1#table-url_mapping" class="hyperref">表 <span class="ref">5.1</span></a>を思い出していただきたいのですが、URLは/users/newではなく表のとおりに/signupにしたいと思います。<a href="/chapters/filling_in_the_layout?version=5.1#code-static_page_routes" class="hyperref">リスト <span class="ref">5.27</span></a>の例に従い、ユーザー登録URL用に<code>get ’/signup’</code>のルートを追加します (<a href="/chapters/filling_in_the_layout?version=5.1#code-signup_route" class="hyperref">リスト <span class="ref">5.43</span></a>)。</p>
<div class="codelisting" id="code-signup_route" data-tralics-id="uid654" data-number="5.43"><div class="heading"><span class="number">リスト 5.43:</span> 

<span class="description">ユーザー登録ページのルート <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">config/routes.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s1">'static_pages#home'</span>
  <span class="n">get</span>  <span class="s1">'/help'</span><span class="p">,</span>    <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#help'</span>
  <span class="n">get</span>  <span class="s1">'/about'</span><span class="p">,</span>   <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#about'</span>
  <span class="n">get</span>  <span class="s1">'/contact'</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#contact'</span>
<span class="hll">  <span class="n">get</span>  <span class="s1">'/signup'</span><span class="p">,</span>  <span class="ss">to</span><span class="p">:</span> <span class="s1">'users#new'</span>
</span><span class="k">end</span>
</pre></div></div></div><p class="noindent"><a href="/chapters/filling_in_the_layout?version=5.1#code-signup_route" class="hyperref">リスト <span class="ref">5.43</span></a>の変更に合わせて、<a href="/chapters/filling_in_the_layout?version=5.1#code-generate_users_controller" class="hyperref">リスト <span class="ref">5.38</span></a>で生成されたテストも修正していきましょう。修正した結果を<a href="/chapters/filling_in_the_layout?version=5.1#code-users_controller_test_signup_route" class="hyperref">リスト <span class="ref">5.44</span></a>に示します。</p>
<div class="codelisting" id="code-users_controller_test_signup_route" data-tralics-id="uid655" data-number="5.44"><div class="heading"><span class="number">リスト 5.44:</span> 

<span class="description">Usersコントローラのテストで名前付きルートを使うようにする <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <span class="filepath">test/controllers/users_controller_test.rb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">UsersControllerTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"should get new"</span> <span class="k">do</span>
<span class="hll">    <span class="n">get</span> <span class="n">signup_path</span>
</span>    <span class="n">assert_response</span> <span class="ss">:success</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>次に、新しく定義された名前付きルートを使って、Homeページのボタンに適切なリンクを追加します。他のルートと同様、<code>get ’/signup’</code>と記述したことで<code>signup_path</code>という名前付きルートができ、それを<a href="/chapters/filling_in_the_layout?version=5.1#code-home_page_signup_link" class="hyperref">リスト <span class="ref">5.45</span></a>で使います。なお、signupページへのテストは演習に回すことにします (<a href="/chapters/filling_in_the_layout?version=5.1#sec-exercises_rails_routes" class="hyperref"><span class="ref">5.3.2.1</span></a>)。</p>
<div class="codelisting" id="code-home_page_signup_link" data-tralics-id="uid656" data-number="5.45"><div class="heading"><span class="number">リスト 5.45:</span> 

<span class="description">ボタンにユーザー登録ページへのリンクを追加する <span class="break"></span> <span class="filepath">app/views/static_pages/home.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"center jumbotron"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Welcome to the Sample App<span class="nt">&lt;/h1&gt;</span>

  <span class="nt">&lt;h2&gt;</span>
    This is the home page for the
    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"https://railstutorial.jp/"</span><span class="nt">&gt;</span>Ruby on Rails Tutorial<span class="nt">&lt;/a&gt;</span>
    sample application.
  <span class="nt">&lt;/h2&gt;</span>

<span class="hll">  <span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="s2">"Sign up now!"</span><span class="p">,</span> <span class="n">signup_path</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"btn btn-lg btn-primary"</span> <span class="cp">%&gt;</span>
</span><span class="nt">&lt;/div&gt;</span>

<span class="cp">&lt;%=</span> <span class="n">link_to</span> <span class="n">image_tag</span><span class="p">(</span><span class="s2">"rails.png"</span><span class="p">,</span> <span class="ss">alt</span><span class="p">:</span> <span class="s2">"Rails logo"</span><span class="p">),</span>
            <span class="s1">'http://rubyonrails.org/'</span> <span class="cp">%&gt;</span>
</pre></div></div></div><p>最後に、signupページ用のカスタムスタブ (stub) のビューを追加します (<a href="/chapters/filling_in_the_layout?version=5.1#code-initial_signup_page" class="hyperref"><span class="ref">5.46</span></a>)。</p>
<div class="codelisting" id="code-initial_signup_page" data-tralics-id="uid657" data-number="5.46"><div class="heading"><span class="number">リスト 5.46:</span> 

<span class="description">最初のユーザー登録ページ (スタブ) <span class="break"></span> <span class="filepath">app/views/users/new.html.erb</span></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="s1">'Sign up'</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;h1&gt;</span>Sign up<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;p&gt;</span>This will be a signup page for new users.<span class="nt">&lt;/p&gt;</span>
</pre></div></div></div><p class="noindent">これで、少なくともサインインのルートを追加するまでの間、リンクと名前付きルートが完成しました (<a href="/chapters/basic_login?version=5.1#cha-basic_login" class="hyperref">第<span class="ref">8</span>章</a>)。結果を<a href="/chapters/filling_in_the_layout?version=5.1#fig-new_signup_page" class="hyperref">図 <span class="ref">5.11</span></a>の新規ユーザーのページ (URI /signup) に示します。</p>
<div class="center figure" id="fig-new_signup_page" data-tralics-id="uid658" data-number="5.11">
<div class="graphics image"><img src="images/figures/new_signup_page_4th_edition.png" alt="images/figures/new_signup_page_4th_edition" /></div><div class="caption"><span class="header">図 5.11: </span><span class="description">新しいユーザー登録ページ (/signup) 
</span></div></div>
<div id="sec-exercises_signup_url" data-tralics-id="uid659" class="subsubsection" data-number="5.4.2.1"><h4><a href="#sec-exercises_signup_url" class="heading">演習</a></h4>
 <div class="society-note">
 </div>
<ol>
<li>もしまだ<a href="/chapters/filling_in_the_layout?version=5.1#sec-exercises_users_controller" class="hyperref"><span class="ref">5.4.1.1</span></a>の演習に取り掛かっていなければ、まずは<a href="/chapters/filling_in_the_layout?version=5.1#code-user_new_test" class="hyperref">リスト <span class="ref">5.41</span></a>のように変更し、名前付きルート<code>signup_path</code>を使えるようにしてください。また、<a href="/chapters/filling_in_the_layout?version=5.1#code-signup_route" class="hyperref">リスト <span class="ref">5.43</span></a>で名前付きルートが使えるようになったので、現時点でテストが <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>になっていることを確認してください。 <span class="exercise" id="ex-de47e5"></span>
</li>
<li>先ほどのテストが正しく動いていることを確認するため、<code>signup</code>ルートの部分をコメントアウトし、テスト <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>になることを確認してください。確認できたら、コメントアウトを解除して <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>の状態に戻してください。 <span class="exercise" id="ex-cba29a"></span>
</li>
<li><a href="/chapters/filling_in_the_layout?version=5.1#code-layout_links_test" class="hyperref">リスト <span class="ref">5.32</span></a>の統合テストにsignupページにアクセスするコードを追加してください (<code>get</code>メソッドを使います)。コードを追加したら実際にテストを実行し、結果が正しいことを確認してください。<em>ヒント</em>: <a href="/chapters/filling_in_the_layout?version=5.1#code-layout_links_test_signup_full_title_helper" class="hyperref">リスト <span class="ref">5.36</span></a>で紹介した<code>full_title</code>ヘルパーを使ってみてください。 <span class="exercise" id="ex-cb38fe"></span>
</li></ol>
</div></div></div><div id="sec-layout_conclusion" data-tralics-id="cid31" class="section" data-number="5.5"><h2><a href="/chapters/filling_in_the_layout?version=5.1#sec-layout_conclusion" class="heading hyperref"><span class="number">5.5 </span>最後に</a></h2>
<p>この章では、アプリケーションのレイアウトを形にし、ルーティングを洗練させました。本書では、以後サンプルアプリケーションを肉付けすることに専念します。最初に、ユーザー登録、サインイン、サインアウトできるユーザーを追加します。次に、マイクロポストを追加します。最後に、他のユーザーをフォローできるようにします。</p>
<p>Gitを使っている方は、この時点でmasterブランチに変更をマージしてください。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> git add -A
<span class="gp">$</span> git commit -m <span class="s2">"Finish layout and routes"</span>
<span class="gp">$</span> git checkout master
<span class="gp">$</span> git merge filling-in-layout
</pre></div></div>
<p class="noindent">続いて、テストスイートを実行して <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>になるか確認し、問題なければBitbucketにプッシュします。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> rails <span class="nb">test</span>
<span class="gp">$</span><span class="nb"> </span>git push
</pre></div></div>
<p class="noindent">最後に、Herokuへデプロイします。</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> git push heroku
</pre></div></div>
<p class="noindent">デプロイが無事に終わると、本番環境でサンプルアプリケーションが動いているはずです (<a href="/chapters/filling_in_the_layout?version=5.1#fig-layout_production" class="hyperref">図 <span class="ref">5.12</span></a>)。</p>
<div class="center figure" id="fig-layout_production" data-tralics-id="uid663" data-number="5.12">
<div class="graphics image"><img src="images/figures/layout_production.png" alt="images/figures/layout_production" /></div><div class="caption"><span class="header">図 5.12: </span><span class="description">本番環境で動くサンプルアプリケーション
</span></div></div>
<div id="sec-filling_in_the_layout_what_we_learned_in_this_chapter" data-tralics-id="uid664" class="subsection" data-number="5.5.1"><h3><a href="/chapters/filling_in_the_layout?version=5.1#sec-filling_in_the_layout_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">5.5.1 </span>本章のまとめ</a></h3>
<ul>
<li>HTML5を使ってheaderやfooter、logoやbodyといったコンテンツのレイアウトを定義しました
</li>
<li>Railsのパーシャルは効率化のために使われ、別ファイルにマークアップを切り出すことができます
</li>
<li>CSSは、CSSクラスとidを使ってレイアウトやデザインを調整します
</li>
<li>Bootstrapフレームワークを使うと、いい感じのデザインを素早く実装できる
</li>
<li>SassとAsset Pipelineは、(開発効率のために切り分けられた) CSSの冗長な部分を圧縮し、本番環境に最適化した結果を出力する
</li>
<li>Railsのルーティングでは自由にルールを定義することができ、また、その際に名前付きルートも使えるようになる
</li>
<li>統合テストは、ブラウザによるページ間の遷移を効率的にシミュレートする
</li></ul>
</div></div><div id="cha-5_footnotes">
  <ol class="footnotes">
    <li id="cha-5_footnote-1"><a href="https://twitter.com/colmtuite" target="_blank" rel="noopener">Colm Tuite</a>の多大な貢献により、サンプルアプリケーションをBootstrap CSSのフレームワークに変換することができました。感謝します。 <a class="arrow" href="#cha-5_footnote-ref-1">↑</a></li>
    <li id="cha-5_footnote-2"><em>Ruby on Railsチュートリアル</em>のモックアップは、「<a href="http://gomockingbird.com" target="_blank" rel="noopener">Mockingbird</a>」という素晴らしいモックアップ作成サービスで作られています。 <a class="arrow" href="#cha-5_footnote-ref-2">↑</a></li>
    <li id="cha-5_footnote-3"><em>shim</em>と<em>shiv</em>という単語は、今回の用途ではどちらでも大丈夫です。shimの意味は「洗う機械、もしくは薄い物質を整理しフィットさせるためのモノ、あるいは服を削除すること」なので、意味合いとしては前者が正しいです。ちなみに後者は「ナイフ、もしくは武器として使う剃刀」という意味なので、おそらく原著者である Sjoerd Visscherのちょっとしたイタズラ心でしょう。 <a class="arrow" href="#cha-5_footnote-ref-3">↑</a></li>
    <li id="cha-5_footnote-4">CSSクラスは、Rubyのクラスとはまったく関係がありません。 <a class="arrow" href="#cha-5_footnote-ref-4">↑</a></li>
    <li id="cha-5_footnote-5">スペースを入れると見栄えが変わるかもしれませんが、<a href="/chapters/static_pages?version=5.1#sec-testing_titles" class="hyperref"><span class="ref">3.4.1</span></a>で触れたようにHTMLは重複する空白を無視するのでどちらでも大丈夫です。 <a class="arrow" href="#cha-5_footnote-ref-5">↑</a></li>
    <li id="cha-5_footnote-6">このロゴ画像は実はちょっと古いロゴです。ただ最新のロゴは拡張可能なベクター画像 (SVG) になっていて、やや扱いには手間がかかります。今回はサッと済ませてしまいたいので古いロゴ画像を使っています。 <a class="arrow" href="#cha-5_footnote-ref-6">↑</a></li>
    <li id="cha-5_footnote-7">既にお気づきだと思いますが、<code>img</code>タグは<span class="inline_verbatim">&lt;img&gt;...&lt;/img&gt;</span>と書いても良いのですが、一般的には<span class="inline_verbatim">&lt;img ... /&gt;</span>と書きます。このような書式のタグを<em>閉じタグ</em>と呼びます。 <a class="arrow" href="#cha-5_footnote-ref-7">↑</a></li>
    <li id="cha-5_footnote-8">画像の引用元とライセンス: https://www.flickr.com/photos/deborah_s_perspective/14144861329 on 2016-01-09.<span class="intersentencespace"></span> Copyright © 2009 by <a href="https://www.flickr.com/photos/deborah_s_perspective/" target="_blank" rel="noopener">Deborah</a> (改変不可の <a href="https://creativecommons.org/licenses/by/2.0/" target="_blank" rel="noopener">Creative Commons Attribution 2.0 Generic</a> ライセンス) <a class="arrow" href="#cha-5_footnote-ref-8">↑</a></li>
    <li id="cha-5_footnote-9">これまでと同様に、Gemfileで指定した各gemのバージョンは<a href="http://gemfiles-4th-ed.railstutorial.org/" target="_blank" rel="noopener">gemfiles-4th-ed.railstutorial.org</a>と一致している必要があります。もしうまく次に進めない場合はチェックしてみてください。 <a class="arrow" href="#cha-5_footnote-ref-9">↑</a></li>
    <li id="cha-5_footnote-10">Asset PipelineではLessを使うこともできます。詳しくは<a href="http://rubygems.org/gems/less-rails-bootstrap" target="_blank" rel="noopener"><code class="tt">less-rails-bootstrap</code> gem</a>を参照してください。 <a class="arrow" href="#cha-5_footnote-ref-10">↑</a></li>
    <li id="cha-5_footnote-11">もしこのステップが摩訶不思議に思えたら、次のように考えてみましょう。「私はただ<a href="https://github.com/twbs/bootstrap-sass#bootstrap-for-sass---" target="_blank" rel="noopener">bootstrap-sassのREADMEファイル</a>に従っているのだ」と。 <a class="arrow" href="#cha-5_footnote-ref-11">↑</a></li>
    <li id="cha-5_footnote-12">多くのRails開発者は、異なるビューの間で共通して使うパーシャル用のディレクトリとして、<code>shared</code>ディレクトリがよく使われます。著者は、複数のビューで共有するユーティリティパーシャルについては<code>shared</code>フォルダに保存し、文字どおり全ページ (サイトレイアウトの一部として) 共通のパーシャルについては<code>layouts</code>ディレクトリへ保存することを好んでいます (<code>shared</code>ディレクトリは<a href="/chapters/sign_up?version=5.1#cha-sign_up" class="hyperref">第<span class="ref">7</span>章</a>で作成します)。著者はこのように分割保存するのが論理的であると考えますが、<code>shared</code>フォルダにすべて保存しても問題なく動作します。 <a class="arrow" href="#cha-5_footnote-ref-12">↑</a></li>
    <li id="cha-5_footnote-13"><code>footer</code>タグと<code>.footer</code>クラスを両方使っていることに疑問に思う方がいるかもしれません。その理由は、footerタグとする方が読み手にとって意味が明確であるのと、.footerクラスはBootstrapで使うためです。<code>footer</code>を<code>div</code>に置き換えても動作は変わりません。 <a class="arrow" href="#cha-5_footnote-ref-13">↑</a></li>
    <li id="cha-5_footnote-14">このチュートリアル構成は、Michael Erasmusによる素晴らしいブログ記事「5分でわかるRails 3のAsset Pipeline (英語)」をもとにしています。詳細についてはRailsガイドの「<a href="http://railsguides.jp/asset_pipeline.html" target="_blank" rel="noopener">アセットパイプライン</a>」の項を参照してください。 <a class="arrow" href="#cha-5_footnote-ref-14">↑</a></li>
    <li id="cha-5_footnote-15">Sassはもう１つの全く新しい文法もサポートしています。この文法は冗長性が少ない (カッコが少ない) 新しい言語と言えるのですが、ただ既存のプロジェクトには若干不便であり、既にCSSに慣れ親しんだ人にとっては学習が面倒でもあります。 <a class="arrow" href="#cha-5_footnote-ref-15">↑</a></li>
    <li id="cha-5_footnote-16">何人かの開発者は「1つのテストに複数のアサーションを入れるべきではない」と強く主張するでしょう。この演習は不必要に複雑で、もし各テストの直前に共通のセットアップ用タスクがあれば、たしかに不要な負荷がかかることでしょう。しかし、よく書かれたテストは一貫したストーリーのようになり、人間にとって理解しやすいです。ストーリーを独立した場面ごとに分割されてしまうと、物語調ではなくなってしまいます。このことから、複数のアサーションを1つのテストにまとめるようにして、(minitestを通して) Rubyにどのセリフで間違ったのかを話させるようにしています。 <a class="arrow" href="#cha-5_footnote-ref-16">↑</a></li>
  </ol>
</div>

            <div class="navigation">
  <a class="prev_page" href="rails_flavored_ruby?version=5.1#cha-rails_flavored_ruby">«前の章</a>
    <a class="next_page" href="modeling_users?version=5.1#cha-modeling_users">次の章»</a>
</div>

          </div>
          <div id="book_bottom"></div>
          <div id="last-thoughts" class="announce">
  Railsチュートリアルは，Ruby/Rails のアジャイル開発を得意とする <a href="http://yasslab.jp/ja/">YassLab</a> によって運営・保守されております.<br />
  継続的に良いコンテンツを提供する為に，<a href="http://tatsu-zine.com/books/railstutorial">電子書籍</a>や<a href="/seminars#record">解説動画</a>のご購入を検討して頂けると幸いです m(_ _)m<br />
  スポンサーシップや商用利用などに関するご相談がありましたら，<a href="/contact">お問い合わせ</a>ページよりお気軽にご連絡ください :)
</div>

        </div>

        <div id="container-bottom"></div>
      </div>
    </div>
    <div id="footer">
  <!--<a href="https://mixpanel.com/f/partner"><img src="//cdn.mxpnl.com/site_media/images/partner/badge_light.png" alt="Mobile Analytics" /></a>-->
</div>

<div class="menu">
  <div class='links'>
    <div class='box' style="padding-left: 60px;">
      <span>
	<a href="/">ホーム</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/help">ヘルプ</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/contact">お問い合わせ</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/seminars">解説セミナー</a>
      </span>
      <span class='division'>|</span>
      <span>
	<a href="/#screencast">解説動画 (質問対応付き)</a>
      </span>
      <span class='division'>|</span>
      <span style="padding-top:8px">
	<a href="http://b.hatena.ne.jp/entry/railstutorial.jp/" class="hatena-bookmark-button"
	   data-hatena-bookmark-title="Rails チュートリアル" data-hatena-bookmark-layout="simple-balloon"
	   data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加">
	  <img src="https://b.st-hatena.com/images/entry-button/button-only@2x.png"
	       alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" />
	</a><script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
      </span>
      <span class='division'>|</span>
      <div class="fb-like" data-href="https://railstutorial.jp/" data-send="false"
	   data-layout="button_count" data-show-faces="false" data-size="small"
	   data-font="arial" style="margin-top: -5px;"></div>
    </div>
  </div>
</div>


<br />
<br />
<br />


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=144878509039953&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  </div>

</body>

</html>
